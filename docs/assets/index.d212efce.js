var zs=Object.defineProperty;var S0=Object.getOwnPropertySymbols;var Xs=Object.prototype.hasOwnProperty,Ws=Object.prototype.propertyIsEnumerable;var I0=(l,i,s)=>i in l?zs(l,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[i]=s,k0=(l,i)=>{for(var s in i||(i={}))Xs.call(i,s)&&I0(l,s,i[s]);if(S0)for(var s of S0(i))Ws.call(i,s)&&I0(l,s,i[s]);return l};var Hs=(l,i)=>()=>(i||l((i={exports:{}}).exports,i),i.exports);import{C as Ys,E as cr,u as dr,p as Zs,l as Et,m as Js,R as fr,r as mr,d as qs,a as $s,b as b0,O as D0,G as Ks,c as Qs}from"./vendor.546a0e46.js";var Ia=Hs((Qi,Fr)=>{const en=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))o(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const C of y.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&o(C)}).observe(document,{childList:!0,subtree:!0});function s(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerpolicy&&(y.referrerPolicy=p.referrerpolicy),p.crossorigin==="use-credentials"?y.credentials="include":p.crossorigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function o(p){if(p.ep)return;p.ep=!0;const y=s(p);fetch(p.href,y)}};en();window.Live2DCubismCore=null;(function(l){var i=function(){function D(){}return D.getVersion=function(){return k.ccall("csmGetVersion","number",[],[])},D.getLatestMocVersion=function(){return k.ccall("csmGetLatestMocVersion","number",[],[])},D.getMocVersion=function(m){return k.ccall("csmGetMocVersion","number",["number"],[m])},D.getSizeofModel=function(m){return k.ccall("csmGetSizeofModel","number",["number"],[m])},D.reviveMocInPlace=function(m,N){return k.ccall("csmReviveMocInPlace","number",["number","number"],[m,N])},D.initializeModelInPlace=function(m,N,q){return k.ccall("csmInitializeModelInPlace","number",["number","number","number"],[m,N,q])},D.getParameterCount=function(m){return k.ccall("csmGetParameterCount","number",["number"],[m])},D.getParameterIds=function(m){return k.ccall("csmGetParameterIds","number",["number"],[m])},D.getParameterMinimumValues=function(m){return k.ccall("csmGetParameterMinimumValues","number",["number"],[m])},D.getParameterMaximumValues=function(m){return k.ccall("csmGetParameterMaximumValues","number",["number"],[m])},D.getParameterDefaultValues=function(m){return k.ccall("csmGetParameterDefaultValues","number",["number"],[m])},D.getParameterValues=function(m){return k.ccall("csmGetParameterValues","number",["number"],[m])},D.getParameterKeyCounts=function(m){return k.ccall("csmGetParameterKeyCounts","number",["number"],[m])},D.getParameterKeyValues=function(m){return k.ccall("csmGetParameterKeyValues","number",["number"],[m])},D.getPartCount=function(m){return k.ccall("csmGetPartCount","number",["number"],[m])},D.getPartIds=function(m){return k.ccall("csmGetPartIds","number",["number"],[m])},D.getPartOpacities=function(m){return k.ccall("csmGetPartOpacities","number",["number"],[m])},D.getPartParentPartIndices=function(m){return k.ccall("csmGetPartParentPartIndices","number",["number"],[m])},D.getDrawableCount=function(m){return k.ccall("csmGetDrawableCount","number",["number"],[m])},D.getDrawableIds=function(m){return k.ccall("csmGetDrawableIds","number",["number"],[m])},D.getDrawableConstantFlags=function(m){return k.ccall("csmGetDrawableConstantFlags","number",["number"],[m])},D.getDrawableDynamicFlags=function(m){return k.ccall("csmGetDrawableDynamicFlags","number",["number"],[m])},D.getDrawableTextureIndices=function(m){return k.ccall("csmGetDrawableTextureIndices","number",["number"],[m])},D.getDrawableDrawOrders=function(m){return k.ccall("csmGetDrawableDrawOrders","number",["number"],[m])},D.getDrawableRenderOrders=function(m){return k.ccall("csmGetDrawableRenderOrders","number",["number"],[m])},D.getDrawableOpacities=function(m){return k.ccall("csmGetDrawableOpacities","number",["number"],[m])},D.getDrawableMaskCounts=function(m){return k.ccall("csmGetDrawableMaskCounts","number",["number"],[m])},D.getDrawableMasks=function(m){return k.ccall("csmGetDrawableMasks","number",["number"],[m])},D.getDrawableVertexCounts=function(m){return k.ccall("csmGetDrawableVertexCounts","number",["number"],[m])},D.getDrawableVertexPositions=function(m){return k.ccall("csmGetDrawableVertexPositions","number",["number"],[m])},D.getDrawableVertexUvs=function(m){return k.ccall("csmGetDrawableVertexUvs","number",["number"],[m])},D.getDrawableIndexCounts=function(m){return k.ccall("csmGetDrawableIndexCounts","number",["number"],[m])},D.getDrawableIndices=function(m){return k.ccall("csmGetDrawableIndices","number",["number"],[m])},D.mallocMoc=function(m){return k.ccall("csmMallocMoc","number",["number"],[m])},D.mallocModelAndInitialize=function(m){return k.ccall("csmMallocModelAndInitialize","number",["number"],[m])},D.malloc=function(m){return k.ccall("csmMalloc","number",["number"],[m])},D.setLogFunction=function(m){k.ccall("csmSetLogFunction",null,["number"],[m])},D.updateModel=function(m){k.ccall("csmUpdateModel",null,["number"],[m])},D.readCanvasInfo=function(m,N,q,J){k.ccall("csmReadCanvasInfo",null,["number","number","number","number"],[m,N,q,J])},D.resetDrawableDynamicFlags=function(m){k.ccall("csmResetDrawableDynamicFlags",null,["number"],[m])},D.free=function(m){k.ccall("csmFree",null,["number"],[m])},D}(),s=function(){function D(){}return D.csmGetVersion=function(){return i.getVersion()},D.csmGetLatestMocVersion=function(){return i.getLatestMocVersion()},D.csmGetMocVersion=function(m){return i.getMocVersion(m._ptr)},D}();l.Version=s,s=function(){function D(){}return D.csmSetLogFunction=function(m){D.logFunction=m,m=k.addFunction(D.wrapLogFunction,"vi"),i.setLogFunction(m)},D.csmGetLogFunction=function(){return D.logFunction},D.wrapLogFunction=function(m){m=k.UTF8ToString(m),D.logFunction(m)},D}(),l.Logging=s,s=function(){function D(m){var N=i.mallocMoc(m.byteLength);N&&(new Uint8Array(k.HEAPU8.buffer,N,m.byteLength).set(new Uint8Array(m)),this._ptr=i.reviveMocInPlace(N,m.byteLength),this._ptr||i.free(N))}return D.fromArrayBuffer=function(m){return m?(m=new D(m),m._ptr?m:null):null},D.prototype._release=function(){i.free(this._ptr),this._ptr=0},D}(),l.Moc=s,s=function(){function D(m){this._ptr=i.mallocModelAndInitialize(m._ptr),this._ptr&&(this.parameters=new p(this._ptr),this.parts=new y(this._ptr),this.drawables=new C(this._ptr),this.canvasinfo=new o(this._ptr))}return D.fromMoc=function(m){return m=new D(m),m._ptr?m:null},D.prototype.update=function(){i.updateModel(this._ptr)},D.prototype.release=function(){i.free(this._ptr),this._ptr=0},D}(),l.Model=s;var o=function(D){var m,N,q,J,Q,re,$;D&&(Q=(m=new Float32Array(2)).length*m.BYTES_PER_ELEMENT,J=i.malloc(Q),(N=new Uint8Array(k.HEAPU8.buffer,J,Q)).set(new Uint8Array(m.buffer)),re=(q=new Float32Array(2)).length*q.BYTES_PER_ELEMENT,$=i.malloc(re),(J=new Uint8Array(k.HEAPU8.buffer,$,re)).set(new Uint8Array(q.buffer)),$=(Q=new Float32Array(1)).length*Q.BYTES_PER_ELEMENT,re=i.malloc($),($=new Uint8Array(k.HEAPU8.buffer,re,$)).set(new Uint8Array(Q.buffer)),i.readCanvasInfo(D,N.byteOffset,J.byteOffset,$.byteOffset),m=new Float32Array(N.buffer,N.byteOffset,N.length),q=new Float32Array(J.buffer,J.byteOffset,J.length),Q=new Float32Array($.buffer,$.byteOffset,$.length),this.CanvasWidth=m[0],this.CanvasHeight=m[1],this.CanvasOriginX=q[0],this.CanvasOriginY=q[1],this.PixelsPerUnit=Q[0],i.free(N.byteOffset),i.free(J.byteOffset),i.free($.byteOffset))};l.CanvasInfo=o;var p=function(D){var m,N;this.count=i.getParameterCount(D),m=i.getParameterCount(D),this.ids=new Array(m);for(var q=new Uint32Array(k.HEAPU32.buffer,i.getParameterIds(D),m),J=0;J<q.length;J++)this.ids[J]=k.UTF8ToString(q[J]);m=i.getParameterCount(D),this.minimumValues=new Float32Array(k.HEAPF32.buffer,i.getParameterMinimumValues(D),m),m=i.getParameterCount(D),this.maximumValues=new Float32Array(k.HEAPF32.buffer,i.getParameterMaximumValues(D),m),m=i.getParameterCount(D),this.defaultValues=new Float32Array(k.HEAPF32.buffer,i.getParameterDefaultValues(D),m),m=i.getParameterCount(D),this.values=new Float32Array(k.HEAPF32.buffer,i.getParameterValues(D),m),m=i.getParameterCount(D),this.keyCounts=new Int32Array(k.HEAP32.buffer,i.getParameterKeyCounts(D),m),m=i.getParameterCount(D),N=new Int32Array(k.HEAP32.buffer,i.getParameterKeyCounts(D),m),this.keyValues=new Array(m);for(var Q=new Uint32Array(k.HEAPU32.buffer,i.getParameterKeyValues(D),m),J=0;J<Q.length;J++)this.keyValues[J]=new Float32Array(k.HEAPF32.buffer,Q[J],N[J])};l.Parameters=p;var y=function(D){var m;this.count=i.getPartCount(D),m=i.getPartCount(D),this.ids=new Array(m);for(var N=new Uint32Array(k.HEAPU32.buffer,i.getPartIds(D),m),q=0;q<N.length;q++)this.ids[q]=k.UTF8ToString(N[q]);m=i.getPartCount(D),this.opacities=new Float32Array(k.HEAPF32.buffer,i.getPartOpacities(D),m),m=i.getPartCount(D),this.parentIndices=new Int32Array(k.HEAP32.buffer,i.getPartParentPartIndices(D),m)};l.Parts=y;var C=function(){function D(m){this._modelPtr=m;var N,q=null;this.count=i.getDrawableCount(m),N=i.getDrawableCount(m),this.ids=new Array(N);for(var J=new Uint32Array(k.HEAPU32.buffer,i.getDrawableIds(m),N),Q=0;Q<J.length;Q++)this.ids[Q]=k.UTF8ToString(J[Q]);N=i.getDrawableCount(m),this.constantFlags=new Uint8Array(k.HEAPU8.buffer,i.getDrawableConstantFlags(m),N),N=i.getDrawableCount(m),this.dynamicFlags=new Uint8Array(k.HEAPU8.buffer,i.getDrawableDynamicFlags(m),N),N=i.getDrawableCount(m),this.textureIndices=new Int32Array(k.HEAP32.buffer,i.getDrawableTextureIndices(m),N),N=i.getDrawableCount(m),this.drawOrders=new Int32Array(k.HEAP32.buffer,i.getDrawableDrawOrders(m),N),N=i.getDrawableCount(m),this.renderOrders=new Int32Array(k.HEAP32.buffer,i.getDrawableRenderOrders(m),N),N=i.getDrawableCount(m),this.opacities=new Float32Array(k.HEAPF32.buffer,i.getDrawableOpacities(m),N),N=i.getDrawableCount(m),this.maskCounts=new Int32Array(k.HEAP32.buffer,i.getDrawableMaskCounts(m),N),N=i.getDrawableCount(m),this.vertexCounts=new Int32Array(k.HEAP32.buffer,i.getDrawableVertexCounts(m),N),N=i.getDrawableCount(m),this.indexCounts=new Int32Array(k.HEAP32.buffer,i.getDrawableIndexCounts(m),N),N=i.getDrawableCount(m),q=new Int32Array(k.HEAP32.buffer,i.getDrawableMaskCounts(m),N),this.masks=new Array(N);for(var re=new Uint32Array(k.HEAPU32.buffer,i.getDrawableMasks(m),N),Q=0;Q<re.length;Q++)this.masks[Q]=new Int32Array(k.HEAP32.buffer,re[Q],q[Q]);N=i.getDrawableCount(m),q=new Int32Array(k.HEAP32.buffer,i.getDrawableVertexCounts(m),N),this.vertexPositions=new Array(N);for(var $=new Uint32Array(k.HEAPU32.buffer,i.getDrawableVertexPositions(m),N),Q=0;Q<$.length;Q++)this.vertexPositions[Q]=new Float32Array(k.HEAPF32.buffer,$[Q],2*q[Q]);N=i.getDrawableCount(m),q=new Int32Array(k.HEAP32.buffer,i.getDrawableVertexCounts(m),N),this.vertexUvs=new Array(N);for(var de=new Uint32Array(k.HEAPU32.buffer,i.getDrawableVertexUvs(m),N),Q=0;Q<de.length;Q++)this.vertexUvs[Q]=new Float32Array(k.HEAPF32.buffer,de[Q],2*q[Q]);N=i.getDrawableCount(m),q=new Int32Array(k.HEAP32.buffer,i.getDrawableIndexCounts(m),N),this.indices=new Array(N);for(var j=new Uint32Array(k.HEAPU32.buffer,i.getDrawableIndices(m),N),Q=0;Q<j.length;Q++)this.indices[Q]=new Uint16Array(k.HEAPU16.buffer,j[Q],q[Q])}return D.prototype.resetDynamicFlags=function(){i.resetDrawableDynamicFlags(this._modelPtr)},D}();l.Drawables=C,s=function(){function D(){}return D.hasBlendAdditiveBit=function(m){return(1&m)==1},D.hasBlendMultiplicativeBit=function(m){return(2&m)==2},D.hasIsDoubleSidedBit=function(m){return(4&m)==4},D.hasIsInvertedMaskBit=function(m){return(8&m)==8},D.hasIsVisibleBit=function(m){return(1&m)==1},D.hasVisibilityDidChangeBit=function(m){return(2&m)==2},D.hasOpacityDidChangeBit=function(m){return(4&m)==4},D.hasDrawOrderDidChangeBit=function(m){return(8&m)==8},D.hasRenderOrderDidChangeBit=function(m){return(16&m)==16},D.hasVertexPositionsDidChangeBit=function(m){return(32&m)==32},D}(),l.Utils=s;var b,R=(b=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0,function(D){var m;D=D||{};var N,q={};for(N in m=m||(D!==void 0?D:{}))m.hasOwnProperty(N)&&(q[N]=m[N]);var J,Q,re,$,de,j=!1,be=!1,it=typeof window=="object",j=typeof importScripts=="function",be=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&!it&&!j,je=!it&&!be&&!j,dt="";be?(dt=__dirname+"/",$=function(T,O){var Z=Bt(T);return Z||(Q=Q||require("fs"),T=(re=re||require("path")).normalize(T),Z=Q.readFileSync(T)),O?Z:Z.toString()},de=function(T){return(T=$(T,!0)).buffer||(T=new Uint8Array(T)),Ei(T.buffer),T},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(T){throw T}),process.on("unhandledRejection",pi),m.inspect=function(){return"[Emscripten Module object]"}):je?(typeof read!="undefined"&&($=function(T){var O=Bt(T);return O?Zr(O):read(T)}),de=function(T){var O;return(O=Bt(T))?O:typeof readbuffer=="function"?new Uint8Array(readbuffer(T)):(Ei(typeof(O=read(T,"binary"))=="object"),O)},typeof print!="undefined"&&(typeof console=="undefined"&&(console={}),console.log=print,console.warn=console.error=typeof printErr!="undefined"?printErr:print)):(it||j)&&(j?dt=self.location.href:document.currentScript&&(dt=document.currentScript.src),b&&(dt=b),dt=dt.indexOf("blob:")!==0?dt.substr(0,dt.lastIndexOf("/")+1):"",$=function(T){try{var O=new XMLHttpRequest;return O.open("GET",T,!1),O.send(null),O.responseText}catch(Z){if(T=Bt(T))return Zr(T);throw Z}},j&&(de=function(T){try{var O=new XMLHttpRequest;return O.open("GET",T,!1),O.responseType="arraybuffer",O.send(null),new Uint8Array(O.response)}catch(Z){if(T=Bt(T))return T;throw Z}}),J=function(T){var O=Mt,Z=Bi,B=new XMLHttpRequest;B.open("GET",O,!0),B.responseType="arraybuffer",B.onload=function(){var Le;B.status==200||B.status==0&&B.response?Z(B.response):(Le=Bt(O))?Z(Le.buffer):T()},B.onerror=T,B.send(null)});var Ti=m.print||console.log.bind(console),zt=m.printErr||console.warn.bind(console);for(N in q)q.hasOwnProperty(N)&&(m[N]=q[N]);q=null;var Lt=Array(1),Lr=0,Rr=!1;function Ei(T,O){T||pi("Assertion failed: "+O)}var Fi,Li,Rt,mi,Br=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):void 0;function Or(T,O,Z){var B=O+Z;for(Z=O;T[Z]&&!(B<=Z);)++Z;if(16<Z-O&&T.subarray&&Br)return Br.decode(T.subarray(O,Z));for(B="";O<Z;){var Le,e,ze=T[O++];128&ze?(Le=63&T[O++],(224&ze)==192?B+=String.fromCharCode((31&ze)<<6|Le):(e=63&T[O++],(ze=(240&ze)==224?(15&ze)<<12|Le<<6|e:(7&ze)<<18|Le<<12|e<<6|63&T[O++])<65536?B+=String.fromCharCode(ze):(ze-=65536,B+=String.fromCharCode(55296|ze>>10,56320|1023&ze)))):B+=String.fromCharCode(ze)}return B}function Vr(T,O){return T?Or(Rt,T,O):""}function Ur(T){return 0<T%16777216&&(T+=16777216-T%16777216),T}function Gr(T){Fi=T,m.HEAP8=Li=new Int8Array(T),m.HEAP16=new Int16Array(T),m.HEAP32=mi=new Int32Array(T),m.HEAPU8=Rt=new Uint8Array(T),m.HEAPU16=new Uint16Array(T),m.HEAPU32=new Uint32Array(T),m.HEAPF32=new Float32Array(T),m.HEAPF64=new Float64Array(T)}function Ri(T){for(;0<T.length;){var O,Z=T.shift();typeof Z=="function"?Z():typeof(O=Z.C)=="number"?Z.w===void 0?m.dynCall_v(O):m.dynCall_vi(O,Z.w):O(Z.w===void 0?null:Z.w)}}typeof TextDecoder!="undefined"&&new TextDecoder("utf-16le"),j=m.TOTAL_MEMORY||16777216,j=(Fi=m.buffer?m.buffer:new ArrayBuffer(j)).byteLength,Gr(Fi),mi[1008]=5247120;var Nr=[],ds=[],fs=[],jr=[];Math.imul&&Math.imul(4294967295,5)===-5||(Math.imul=function(T,O){var Z=65535&T,B=65535&O;return Z*B+((T>>>16)*B+Z*(O>>>16)<<16)|0}),Math.clz32||(Math.clz32=function(T){var O=32,Z=T>>16;return Z&&(O-=16,T=Z),(Z=T>>8)&&(O-=8,T=Z),(Z=T>>4)&&(O-=4,T=Z),(Z=T>>2)&&(O-=2,T=Z),T>>1?O-2:O-T}),Math.trunc||(Math.trunc=function(T){return T<0?Math.ceil(T):Math.floor(T)});var Xt=0,gi=null;function pi(T){throw m.onAbort&&m.onAbort(T),Ti(T),zt(T),Rr=!0,"abort("+T+"). Build with -s ASSERTIONS=1 for more info."}m.preloadedImages={},m.preloadedAudios={};var Mt=null,_i="data:application/octet-stream;base64,";function zr(T){return T.replace(/\b__Z[\w\d_]+/g,function(O){return O==O?O:O+" ["+O+"]"})}function Xr(){var T=Error();if(!T.stack){try{throw Error(0)}catch(O){T=O}if(!T.stack)return"(no stack trace available)"}return T.stack.toString()}var er=[null,[],[]];function tr(T,O){var Z=er[T];O===0||O===10?((T===1?Ti:zt)(Or(Z,0)),Z.length=0):Z.push(O)}function Wr(T,O,Z,B){try{for(var Le=0,e=0;e<Z;e++){for(var ze=mi[O+8*e>>2],ct=mi[O+(8*e+4)>>2],S=0;S<ct;S++)tr(T,Rt[ze+S]);Le+=ct}return mi[B>>2]=Le,0}catch(Fe){return typeof FS!="undefined"&&Fe instanceof FS.A||pi(Fe),Fe.B}}function Hr(){return Li.length}function Yr(T){try{var O=new ArrayBuffer(T);if(O.byteLength==T)return new Int8Array(O).set(Li),ps(O),Gr(O),1}catch{}}var ms=!(Mt="data:application/octet-stream;base64,AAAAAAAAAAARAAoAERERAAAAAAUAAAAAAAAJAAAAAAsAAAAAAAAAABEADwoREREDCgcAARMJCwsAAAkGCwAACwAGEQAAABEREQAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAARAAoKERERAAoAAAIACQsAAAAJAAsAAAsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAMAAAAAAkMAAAAAAAMAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAA0AAAAEDQAAAAAJDgAAAAAADgAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAPAAAAAA8AAAAACRAAAAAAABAAABAAABIAAAASEhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAABISEgAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAoAAAAACgAAAAAJCwAAAAAACwAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAwAAAAACQwAAAAAAAwAAAwAADAxMjM0NTY3ODlBQkNERUYFAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAGgJAAAABAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAK/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABbQ1NNXSBbRV1Jbml0aWFsaXplRGVmb3JtZXJzKCk6IFVua25vd24gRGVmb3JtZXIgVHlwZS4KAExpdmUyRCBDdWJpc20gU0RLIENvcmUgVmVyc2lvbiAlZC4lZC4lZABNT0MzAFtDU01dIFtFXWNzbVJldml2ZU1vY0luUGxhY2UgaXMgZmFpbGVkLiBDb3JydXB0ZWQgIG1vYzMgZmlsZS4KAFtDU01dIFtFXWNzbVJldml2ZU1vY0luUGxhY2UgaXMgZmFpbGVkLiBUaGUgQ29yZSB1bnN1cHBvcnQgbGF0ZXIgdGhhbiBtb2MzIHZlcjpbJWRdLiBUaGlzIG1vYzMgdmVyIGlzIFslZF0uCgBbQ1NNXSBbRV1jc21HZXRNb2NWZXJzaW9uIGlzIGZhaWxlZC4gQ29ycnVwdGVkIG1vYzMgZmlsZS4KAFtDU01dIFtFXSVzOiAlcwoAY3NtR2V0TW9jVmVyc2lvbgAiYWRkcmVzcyIgaXMgbnVsbC4AY3NtUmV2aXZlTW9jSW5QbGFjZQAiYWRkcmVzcyIgYWxpZ25tZW50IGlzIGludmFsaWQuACJzaXplIiBpcyBpbnZhbGlkLgBjc21SZWFkQ2FudmFzSW5mbwAibW9kZWwiIGlzIGludmFsaWQuACJvdXRTaXplSW5QaXhlbHMiIGlzIG51bGwuACJvdXRPcmlnaW5JblBpeGVscyIgaXMgbnVsbC4AIm91dFBpeGVsc1BlclVuaXQiIGlzIG51bGwuAGNzbUdldFNpemVvZk1vZGVsACJtb2MiIGlzIGludmFsaWQuAGNzbUluaXRpYWxpemVNb2RlbEluUGxhY2UAInNpemUiIGlzIGludmFsaWQAY3NtVXBkYXRlTW9kZWwAY3NtR2V0UGFyYW1ldGVyQ291bnQAY3NtR2V0UGFyYW1ldGVySWRzAGNzbUdldFBhcmFtZXRlck1pbmltdW1WYWx1ZXMAY3NtR2V0UGFyYW1ldGVyTWF4aW11bVZhbHVlcwBjc21HZXRQYXJhbWV0ZXJEZWZhdWx0VmFsdWVzAGNzbUdldFBhcmFtZXRlclZhbHVlcwBjc21HZXRQYXJ0Q291bnQAY3NtR2V0UGFydElkcwBjc21HZXRQYXJ0T3BhY2l0aWVzAGNzbUdldFBhcnRQYXJlbnRQYXJ0SW5kaWNlcwBjc21HZXREcmF3YWJsZUNvdW50AGNzbUdldERyYXdhYmxlSWRzAGNzbUdldERyYXdhYmxlQ29uc3RhbnRGbGFncwBjc21HZXREcmF3YWJsZUR5bmFtaWNGbGFncwBjc21HZXREcmF3YWJsZVRleHR1cmVJbmRpY2VzAGNzbUdldERyYXdhYmxlRHJhd09yZGVycwBjc21HZXREcmF3YWJsZVJlbmRlck9yZGVycwBjc21HZXREcmF3YWJsZU9wYWNpdGllcwBjc21HZXREcmF3YWJsZU1hc2tDb3VudHMAY3NtR2V0RHJhd2FibGVNYXNrcwBjc21HZXREcmF3YWJsZVZlcnRleENvdW50cwBjc21HZXREcmF3YWJsZVZlcnRleFBvc2l0aW9ucwBjc21HZXREcmF3YWJsZVZlcnRleFV2cwBjc21HZXREcmF3YWJsZUluZGV4Q291bnRzAGNzbUdldERyYXdhYmxlSW5kaWNlcwBjc21SZXNldERyYXdhYmxlRHluYW1pY0ZsYWdzAGNzbUdldFBhcmFtZXRlcktleUNvdW50cwBjc21HZXRQYXJhbWV0ZXJLZXlWYWx1ZXMAW0NTTV0gW0VdV2FycERlZm9ybWVyOjpUcmFuc2Zvcm1UYXJnZXQoKSBlcnJvci4gWyVkXSBwMDE9KCUuNGYgLCAlLjRmKQoAW0NTTV0gW1ddUm90YXRpb25EZWZvcm1lcjogTm90IGZvdW5kIHRyYW5zZm9ybWVkIERpcmVjdGlvbi4KAFtDU01dIFtFXVVwZGF0ZURlZm9ybWVySGllcmFyY2h5KCk6IFVua25vd24gRGVmb3JtZXIgVHlwZS4KACVzCgAtKyAgIDBYMHgAKG51bGwpAC0wWCswWCAwWC0weCsweCAweABpbmYASU5GAG5hbgBOQU4ALg==");function Zr(T){for(var O=[],Z=0;Z<T.length;Z++){var B=T[Z];255<B&&(ms&&Ei(!1,"Character code "+B+" ("+String.fromCharCode(B)+")  at offset "+Z+" not in 0x00-0xFF."),B&=255),O.push(String.fromCharCode(B))}return O.join("")}var gs=typeof atob=="function"?atob:function(T){var O="",Z=0;T=T.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(T.charAt(Z++)),Le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(T.charAt(Z++)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(T.charAt(Z++)),ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(T.charAt(Z++)),B=B<<2|Le>>4,Le=(15&Le)<<4|e>>2,ct=(3&e)<<6|ze;O+=String.fromCharCode(B),e!==64&&(O+=String.fromCharCode(Le)),ze!==64&&(O+=String.fromCharCode(ct))}while(Z<T.length);return O};function Bt(T){if(String.prototype.startsWith?T.startsWith(_i):T.indexOf(_i)===0){if(T=T.slice(_i.length),typeof be=="boolean"&&be){try{var O=Buffer.from(T,"base64")}catch{O=new Buffer(T,"base64")}var Z=new Uint8Array(O.buffer,O.byteOffset,O.byteLength)}else try{for(var B=gs(T),Le=new Uint8Array(B.length),O=0;O<B.length;++O)Le[O]=B.charCodeAt(O);Z=Le}catch{throw Error("Converting base64 string to bytes failed.")}return Z}}j=function(T,O,Z){var B=new T.Int8Array(Z),Le=new T.Int16Array(Z),e=new T.Int32Array(Z),ze=new T.Uint8Array(Z),ct=new T.Uint16Array(Z),S=new T.Float32Array(Z),Fe=new T.Float64Array(Z),st=0|O.v,St=T.Math.floor,ft=T.Math.pow,It=T.Math.cos,si=T.Math.sin,lt=T.Math.atan2,et=T.Math.imul,Ht=T.Math.clz32,ni=O.a,tt=O.b,nt=O.c,ys=O.d,vs=O.e,ws=O.f,xs=O.g,Ms=O.h,Cs=O.i,Ps=O.j,Ss=O.k,Is=O.l,ks=O.m,x=4240;function he(t,r,n){t|=0,r|=0,n|=0;var g,h,c=x;x=x+272|0,t=c+16|0,h=c,(g=0|e[860])&&(e[h>>2]=n,o0(t,r,h),_0[1&g](t)),x=c}function qr(t,r,n){t|=0,n|=0;var g,h,c=0,a=0,d=0,u=0,f=0,A=0,_=0,v=0,I=0,w=0,E=0,P=0;if(e[(r|=0)>>2]=392,h=0|e[t>>2],0<(0|(f=0|e[h>>2]))){for(c=0|e[t+296>>2],a=0|e[t+16>>2],u=d=0;u=(1<<e[c+(e[a+(d<<2)>>2]<<2)>>2])+u|0,(0|(d=d+1|0))!=(0|f););c=u<<2}else c=0;if(d=f<<3,e[r+4>>2]=d,e[r+8>>2]=e[h>>2]<<2,e[r+12>>2]=e[h>>2]<<2,e[r+16>>2]=e[h>>2]<<2,e[r+20>>2]=e[h>>2]<<2,e[r+24>>2]=e[h>>2]<<2,e[r+28>>2]=e[h>>2]<<2,e[r+32>>2]=c,e[r+36>>2]=c,e[r+40>>2]=c,0<(0|(a=0|e[(g=8+h|0)>>2]))){for(u=0|e[t+88>>2],f=0|e[t+296>>2],A=0|e[t+76>>2],c=I=v=_=0;v=(0|v)<(0|(P=0|e[u+(_<<2)>>2]))?P:v,c=(15+(P<<3)&-16)+c|0,I=(1<<e[f+(e[A+(_<<2)>>2]<<2)>>2])+I|0,(0|(_=_+1|0))!=(0|a););u=v<<3,a=I<<2}else c=a=u=0;if(A=4+h|0,e[r+44>>2]=e[A>>2]<<5,e[r+48>>2]=24*(0|e[g>>2]),_=12+h|0,e[r+52>>2]=e[_>>2]<<5,e[r+56>>2]=e[A>>2]<<2,e[r+60>>2]=e[g>>2]<<2,e[r+64>>2]=e[_>>2]<<2,e[r+68>>2]=e[A>>2]<<2,e[r+72>>2]=e[A>>2]<<2,e[r+76>>2]=c,e[r+80>>2]=e[g>>2]<<2,e[r+84>>2]=e[g>>2]<<2,e[r+88>>2]=a,e[r+92>>2]=a,e[r+96>>2]=a,e[r+100>>2]=a,e[r+104>>2]=u,0<(0|(A=0|e[_>>2]))){for(c=0|e[t+296>>2],a=0|e[t+100>>2],f=u=0;f=(1<<e[c+(e[a+(u<<2)>>2]<<2)>>2])+f|0,(0|(u=u+1|0))!=(0|A););c=f<<2}else c=0;if(e[r+108>>2]=A<<2,e[r+112>>2]=e[_>>2]<<2,e[r+116>>2]=c,e[r+120>>2]=c,e[r+124>>2]=c,e[r+128>>2]=c,e[r+132>>2]=c,e[r+136>>2]=c,e[r+140>>2]=c,e[r+144>>2]=c,e[r+148>>2]=c,e[r+152>>2]=c,e[r+156>>2]=c,0<(0|(I=0|e[(g=16+h|0)>>2]))){for(a=0|e[t+172>>2],u=0|e[t+296>>2],f=0|e[t+136>>2],c=v=_=A=0;_=(0|_)<(0|(P=0|e[a+(A<<2)>>2]))?P:_,c=(15+(P<<3)&-16)+c|0,v=(1<<e[u+(e[f+(A<<2)>>2]<<2)>>2])+v|0,(0|(A=A+1|0))!=(0|I););u=_<<3,a=v<<2}else c=a=u=0;if(e[r+160>>2]=I<<4,e[r+164>>2]=e[g>>2]<<2,e[r+168>>2]=e[g>>2],e[r+172>>2]=e[g>>2]<<2,e[r+176>>2]=e[g>>2]<<2,e[r+180>>2]=e[g>>2]<<2,e[r+184>>2]=c,e[r+188>>2]=e[g>>2]<<2,e[r+192>>2]=e[g>>2]<<2,e[r+196>>2]=e[g>>2]<<2,e[r+200>>2]=e[g>>2]<<2,e[r+204>>2]=e[g>>2]<<2,e[r+208>>2]=e[g>>2]<<2,e[r+212>>2]=a,e[r+216>>2]=a,e[r+220>>2]=a,e[r+224>>2]=a,e[r+228>>2]=a,e[r+232>>2]=a,e[r+236>>2]=u,I=20+h|0,e[r+240>>2]=40*(0|e[I>>2]),e[r+244>>2]=e[I>>2]<<2,e[r+248>>2]=28*(0|e[52+h>>2]),0<(0|(f=0|e[48+h>>2]))){for(c=0|e[t+296>>2],u=a=0;u=(1<<e[c+(a<<2)>>2])+u|0,(0|(a=a+1|0))!=(0|f););c=u<<2}else c=0;if(e[r+252>>2]=36*f,e[r+256>>2]=c,e[r+260>>2]=c,c=72+h|0,e[r+264>>2]=28*(0|e[c>>2]),0<(0|(c=0|e[c>>2]))){for(a=0|e[t+328>>2],u=0|e[t+336>>2],f=0|e[t+340>>2],v=_=A=0;_=(0|_)<(0|(P=0|e[a+(A<<2)>>2]))?P:_,v=(0|(P=(0|e[u+(A<<2)>>2])-(0|e[f+(A<<2)>>2])|0))<(0|v)?v:P+1|0,(0|(A=A+1|0))!=(0|c););a=_<<2,c=v<<2}else c=a=0;if(e[r+268>>2]=e[76+h>>2]<<4,e[r+272>>2]=c,e[r+276>>2]=a,e[r+280>>2]=c,0<(0|(A=0|e[(_=80+h|0)>>2]))){for(c=0|e[t+296>>2],a=0|e[t+364>>2],f=u=0;f=(1<<e[c+(e[a+(u<<2)>>2]<<2)>>2])+f|0,(0|(u=u+1|0))!=(0|A););c=f<<2}else c=0;if(e[r+284>>2]=24*A,e[r+288>>2]=e[_>>2]<<2,e[r+292>>2]=e[_>>2]<<2,e[r+296>>2]=c,e[r+300>>2]=c,e[r+304>>2]=c,0<(0|(v=0|e[I>>2]))){A=0|e[t+224>>2],_=t+228|0,u=t+304|0,c=f=0;do{if((0|(a=0|e[A+(f<<2)>>2]))!=-1&&(P=0|e[(0|e[_>>2])+(f<<2)>>2],E=(w=(0|e[u>>2])+(a<<2)|0)+(P<<2)|0,(0|P)!=0))for(a=w;c=(0|e[a>>2])+c|0,(0|(a=a+4|0))!=(0|E););f=f+1|0}while((0|f)!=(0|v))}else c=0;for(a=v<<2,e[r+308>>2]=a,e[r+312>>2]=a,e[r+316>>2]=c<<2,e[r>>2]=0,c=400,a=1;c=(d+15&-16)+(e[r+(a<<2)>>2]=c)|0,(0|(a=a+1|0))!=80;)d=0|e[r+(a<<2)>>2];e[n>>2]=c}function bs(t,r,n){r|=0,n|=0;var g,h,c,a,d,u,f,A,_,v=0,I=0,w=0,E=0,P=0,F=0,M=0,V=0,L=0,U=0,H=0,ne=0,se=0,z=0,K=0,X=0,Y=0,te=0,oe=0,Ve=0,He=0,Ue=0,Se=0,Ge=0,Re=0,ie=0,Ee=x;if(x=x+336|0,g=Ee+320|0,v=(M=Ee)+324|0,z=704+(t|=0)|0,Ct(0|M,0,320),qr(z,M,v),n>>>0<(v=0|e[v>>2])>>>0)return x=Ee,(Re=0)|Re;if(Ct(0|r,0,0|v),_=r+(0|e[M>>2])|0,e[(K=8+_|0)>>2]=r+(0|e[M+4>>2]),e[36+_>>2]=r+(0|e[M+8>>2]),e[44+_>>2]=r+(0|e[M+12>>2]),e[48+_>>2]=r+(0|e[M+16>>2]),e[(X=52+_|0)>>2]=r+(0|e[M+20>>2]),e[(Y=12+_|0)>>2]=r+(0|e[M+24>>2]),e[16+_>>2]=r+(0|e[M+28>>2]),e[20+_>>2]=r+(0|e[M+32>>2]),e[28+_>>2]=r+(0|e[M+36>>2]),e[32+_>>2]=r+(0|e[M+40>>2]),v=0|e[z>>2],e[(te=60+_|0)>>2]=r+(0|e[M+44>>2]),I=r+(0|e[M+48>>2])|0,e[(h=68+_|0)>>2]=I,e[(oe=76+_|0)>>2]=r+(0|e[M+52>>2]),e[168+_>>2]=r+(0|e[M+56>>2]),e[172+_>>2]=r+(0|e[M+60>>2]),e[176+_>>2]=r+(0|e[M+64>>2]),e[192+_>>2]=r+(0|e[M+68>>2]),e[196+_>>2]=r+(0|e[M+72>>2]),0<(0|(v=0|e[v+8>>2])))for(n=0|e[t+792>>2],E=r+((w=0)|e[M+76>>2])|0;E=(e[I+(24*w|0)+20>>2]=E)+(15+(e[n+(w<<2)>>2]<<3)&-16)|0,(0|(w=w+1|0))!=(0|v););if(e[(c=80+_|0)>>2]=r+(0|e[M+80>>2]),e[84+_>>2]=r+(0|e[M+84>>2]),e[88+_>>2]=r+(0|e[M+88>>2]),e[96+_>>2]=r+(0|e[M+92>>2]),e[100+_>>2]=r+(0|e[M+96>>2]),e[104+_>>2]=r+(0|e[M+100>>2]),e[108+_>>2]=r+(0|e[M+104>>2]),e[(Ve=112+_|0)>>2]=r+(0|e[M+108>>2]),e[116+_>>2]=r+(0|e[M+112>>2]),e[120+_>>2]=r+(0|e[M+116>>2]),e[128+_>>2]=r+(0|e[M+120>>2]),e[132+_>>2]=r+(0|e[M+124>>2]),e[136+_>>2]=r+(0|e[M+128>>2]),e[140+_>>2]=r+(0|e[M+132>>2]),e[144+_>>2]=r+(0|e[M+136>>2]),e[148+_>>2]=r+(0|e[M+140>>2]),e[152+_>>2]=r+(0|e[M+144>>2]),e[156+_>>2]=r+(0|e[M+148>>2]),e[160+_>>2]=r+(0|e[M+152>>2]),e[164+_>>2]=r+(0|e[M+156>>2]),w=0|e[z>>2],e[(He=204+_|0)>>2]=r+(0|e[M+160>>2]),e[248+_>>2]=r+(0|e[M+164>>2]),e[260+_>>2]=r+(0|e[M+168>>2]),e[264+_>>2]=r+(0|e[M+172>>2]),e[268+_>>2]=r+(0|e[M+176>>2]),v=r+(0|e[M+180>>2])|0,e[(E=272+_|0)>>2]=v,0<(0|(w=0|e[w+16>>2]))&&(P=r+(0|e[M+184>>2])|0,F=t+876|0,e[v>>2]=P,(0|w)!=1))for(v=0,I=1,n=P;n=n+(15+(e[(0|e[F>>2])+(v<<2)>>2]<<3)&-16)|0,e[(0|e[E>>2])+(I<<2)>>2]=n,!((0|w)<=(0|(v=I+1|0)));)Ge=I,I=v,v=Ge;if(e[276+_>>2]=r+(0|e[M+188>>2]),e[280+_>>2]=r+(0|e[M+192>>2]),e[284+_>>2]=r+(0|e[M+196>>2]),e[288+_>>2]=r+(0|e[M+200>>2]),e[(d=208+_|0)>>2]=r+(0|e[M+204>>2]),e[212+_>>2]=r+(0|e[M+208>>2]),e[216+_>>2]=r+(0|e[M+212>>2]),e[224+_>>2]=r+(0|e[M+216>>2]),e[228+_>>2]=r+(0|e[M+220>>2]),e[232+_>>2]=r+(0|e[M+224>>2]),e[236+_>>2]=r+(0|e[M+228>>2]),e[240+_>>2]=r+(0|e[M+232>>2]),e[244+_>>2]=r+(0|e[M+236>>2]),se=0|e[M+244>>2],e[(H=296+_|0)>>2]=r+(0|e[M+240>>2]),e[(ne=300+_|0)>>2]=r+se,e[(se=308+_|0)>>2]=r+(0|e[M+248>>2]),v=0|e[M+256>>2],n=0|e[M+260>>2],w=0|e[z>>2],P=r+(0|e[M+252>>2])|0,e[(Se=316+_|0)>>2]=P,0<(0|(w=0|e[w+48>>2])))for(E=0|e[t+1e3>>2],I=r+v|(F=0),n=r+n|0;e[P+(36*F|0)+16>>2]=I,e[P+(36*F|0)+20>>2]=n,v=1<<e[E+(F<<2)>>2],(0|(F=F+1|0))!=(0|w);)I=I+(v<<2)|0,n=n+(v<<2)|0;if(v=0|e[z>>2],I=r+(0|e[M+264>>2])|0,e[(a=324+_|0)>>2]=I,0<(0|(v=0|e[v+72>>2])))for(n=0|e[t+1032>>2],E=r+((w=0)|e[M+268>>2])|0;E=(e[I+(28*w|0)+12>>2]=E)+(e[n+(w<<2)>>2]<<4)|0,(0|(w=w+1|0))!=(0|v););e[328+_>>2]=r+(0|e[M+272>>2]),e[332+_>>2]=r+(0|e[M+276>>2]),e[336+_>>2]=r+(0|e[M+280>>2]),e[(Ue=344+_|0)>>2]=r+(0|e[M+284>>2]),e[(u=348+_|0)>>2]=r+(0|e[M+288>>2]),e[352+_>>2]=r+(0|e[M+292>>2]),e[356+_>>2]=r+(0|e[M+296>>2]),e[364+_>>2]=r+(0|e[M+300>>2]),e[368+_>>2]=r+(0|e[M+304>>2]),I=0|e[M+312>>2],E=0|e[M+316>>2],e[(Ge=384+_|0)>>2]=r+(0|e[M+308>>2]),I=r+I|0,e[(A=388+_|0)>>2]=I,n=0|e[z>>2],v=0|e[n+20>>2];e:do if(0<(0|v))for(F=t+928|0,M=t+932|0,V=t+1004|0,U=t+1008|0,E=r+E|(w=0);;){if(n=0|e[(0|e[F>>2])+(w<<2)>>2],P=(v=0|e[(0|e[M>>2])+(w<<2)>>2])+n|0,((e[I+(w<<2)>>2]=0)|n)!=-1){if(0<(0|v))for(I=0|e[V>>2],v=E;(0|e[I+(n<<2)>>2])!=-1&&(v=v+(e[(0|e[U>>2])+(n<<2)>>2]<<2)|0),(0|(n=n+1|0))<(0|P););else v=E;e[(0|e[A>>2])+(w<<2)>>2]=E,E=v}if(w=w+1|0,n=0|e[z>>2],(0|(v=0|e[n+20>>2]))<=(0|w)){r=n;break e}I=0|e[A>>2]}else r=n;while(0);if(e[376+_>>2]=1,e[380+_>>2]=1&B[20+(0|e[t+708>>2])>>0],f=t+704|0,0<(0|(e[292+_>>2]=v))){for(n=0|e[H>>2],I=0|e[t+912>>2],w=0|e[t+908>>2],E=0|e[t+920>>2],U=0|e[t+916>>2],P=0|e[t+924>>2],F=0|e[t+928>>2],M=0|e[t+932>>2],V=v;H=I+((V=(z=V)+-1|0)<<2)|0,e[n+(40*V|0)>>2]=e[H>>2],ie=w+(V<<2)|0,e[n+(40*V|0)+4>>2]=e[ie>>2],S[n+(40*V|0)+8>>2]=+S[ie>>2]-+S[H>>2],e[n+(40*V|0)+12>>2]=e[E+(V<<2)>>2],e[n+(40*V|0)+32>>2]=e[U+(V<<2)>>2],L=+ft(.10000000149011612,+ +(0|e[P+(V<<2)>>2])),S[n+(40*V|0)+16>>2]=L,S[n+(40*V|0)+20>>2]=1.5*L,e[n+(40*V|0)+24>>2]=e[F+(V<<2)>>2],e[n+(40*V|0)+28>>2]=e[M+(V<<2)>>2],(e[n+(40*V|0)+36>>2]=1)<(0|z););for(n=0|e[ne>>2];e[n+((v=(ie=v)+-1|0)<<2)>>2]=e[U+(v<<2)>>2],1<(0|ie););}if(v=0|e[r+52>>2],0<(0|(e[304+_>>2]=v)))for(n=0|e[se>>2],I=0|e[t+1008>>2],w=0|e[t+1012>>2],E=0|e[t+1004>>2];e[n+(28*(v=(ie=v)+-1|0)|0)>>2]=e[I+(v<<2)>>2],e[n+(28*v|0)+4>>2]=w+(e[E+(v<<2)>>2]<<2),S[n+(28*v|0)+12>>2]=0,e[n+(28*v|0)+20>>2]=1,(e[n+(28*v|0)+24>>2]=1)<(0|ie););if(v=0|e[r+48>>2],0<(0|(e[312+_>>2]=v)))for(n=0|e[Se>>2],I=0|e[t+1e3>>2],w=0|e[t+992>>2],E=0|e[t+996>>2];z=0|e[I+((v=(ie=v)+-1|0)<<2)>>2],e[n+(36*v|0)>>2]=z,e[n+(36*v|0)+4>>2]=1<<z,e[n+(36*v|0)+12>>2]=w+(e[E+(v<<2)>>2]<<2),e[n+(36*v|0)+24>>2]=1,(e[n+(36*v|0)+28>>2]=1)<(0|ie););if(n=0|e[r>>2],e[4+_>>2]=n,M=0|e[t+720>>2],e[40+_>>2]=M,0<(0|n)){for(w=0|e[K>>2],E=0|e[t+740>>2],P=0|e[t+736>>2],F=0|e[t+732>>2],v=0|e[X>>2],I=n;e[w+((I=(ie=I)+-1|0)<<3)>>2]=e[E+(I<<2)>>2],e[w+(I<<3)+4>>2]=e[P+(I<<2)>>2],S[v+(I<<2)>>2]=(0|e[F+(I<<2)>>2])==0?0:1,1<(0|ie););for(w=0|e[Se>>2],I=0|e[Y>>2],v=0;Y=0|e[w+(36*(0|e[M+((n=(ie=n)+-1|0)<<2)>>2])|0)+4>>2],v=(e[I+(n<<2)>>2]=Y)+v|0,1<(0|ie););}else v=0;if(e[24+_>>2]=v,v=0|e[r+4>>2],e[56+_>>2]=v,e[180+_>>2]=e[t+752>>2],e[(U=184+_|0)>>2]=e[t+780>>2],e[(H=188+_|0)>>2]=e[t+804>>2],0<(0|v)){V=t+764|0,M=t+768|0,P=t+772|0,E=t+776|0,F=t+760|0;do switch(v=(w=v)+-1|0,n=0|e[te>>2],e[n+(v<<5)>>2]=e[(0|e[V>>2])+(v<<2)>>2],e[n+(v<<5)+4>>2]=e[(0|e[M>>2])+(v<<2)>>2],ie=0|e[(0|e[P>>2])+(v<<2)>>2],e[n+(v<<5)+8>>2]=ie,I=0|e[(0|e[E>>2])+(v<<2)>>2],e[n+(v<<5)+12>>2]=I,e[n+(v<<5)+28>>2]=e[(0|e[F>>2])+(v<<2)>>2],0|ie){case 0:e[n+(v<<5)+16>>2]=2,e[n+(v<<5)+20>>2]=2,e[n+(v<<5)+24>>2]=(0|e[h>>2])+(24*I|0);break;case 1:e[n+(v<<5)+16>>2]=3,e[n+(v<<5)+20>>2]=3,e[n+(v<<5)+24>>2]=(0|e[oe>>2])+(I<<5);break;default:he(0,784,g)}while(1<(0|w));te=0|e[f>>2]}else te=r;if(M=0|e[te+8>>2],v=(e[64+_>>2]=M)+-1|0,F=0<(0|M))if(I=0|e[h>>2],w=0|e[t+796>>2],E=0|e[t+800>>2],P=0|e[t+792>>2],1<(0|ze[t+4>>0]))for(n=0|e[t+1108>>2];e[I+(24*v|0)>>2]=e[w+(v<<2)>>2],e[I+(24*v|0)+4>>2]=e[E+(v<<2)>>2],e[I+(24*v|0)+12>>2]=e[P+(v<<2)>>2],e[I+(24*v|0)+8>>2]=e[n+(v<<2)>>2],0<(0|v);)v=v+-1|0;else for(;e[I+(24*v|0)>>2]=e[w+(v<<2)>>2],e[I+(24*v|0)+4>>2]=e[E+(v<<2)>>2],e[I+(24*v|0)+12>>2]=e[P+(v<<2)>>2],(e[I+(24*v|0)+8>>2]=0)<(0|v);)v=v+-1|0;if(n=0|e[te+12>>2],0<(0|(e[(P=72+_|0)>>2]=n)))for(v=0|e[oe>>2],I=0|e[t+816>>2],w=n;e[v+((w=(ie=w)+-1|0)<<5)>>2]=e[I+(w<<2)>>2],1<(0|ie););if(F){for(E=0|e[Se>>2],w=0|e[U>>2],I=0|e[c>>2],n=M,v=0;oe=0|e[E+(36*(0|e[w+((n=(ie=n)+-1|0)<<2)>>2])|0)+4>>2],v=(e[I+(n<<2)>>2]=oe)+v|0,1<(0|ie););n=0|e[P>>2]}else v=0;if(e[92+_>>2]=v,0<(0|n))for(E=0|e[Se>>2],w=0|e[H>>2],I=0|e[Ve>>2],v=0;Ve=0|e[E+(36*(0|e[w+((n=(ie=n)+-1|0)<<2)>>2])|0)+4>>2],v=(e[I+(n<<2)>>2]=Ve)+v|0,1<(0|ie););else v=0;if(e[124+_>>2]=v,n=0|e[te+16>>2],e[200+_>>2]=n,M=0|e[t+840>>2],e[252+_>>2]=M,0<(0|n)){for(v=0|e[He>>2],I=0|e[t+860>>2],w=0|e[t+864>>2],E=0|e[t+876>>2],P=0|e[t+856>>2],F=n;e[v+((F=(ie=F)+-1|0)<<4)>>2]=e[I+(F<<2)>>2],e[v+(F<<4)+4>>2]=e[w+(F<<2)>>2],e[v+(F<<4)+12>>2]=e[E+(F<<2)>>2],e[v+(F<<4)+8>>2]=e[P+(F<<2)>>2],1<(0|ie););for(w=0|e[Se>>2],I=0|e[d>>2],v=0;He=0|e[w+(36*(0|e[M+((n=(ie=n)+-1|0)<<2)>>2])|0)+4>>2],v=(e[I+(n<<2)>>2]=He)+v|0,1<(0|ie););}else v=0;if(e[220+_>>2]=v,Y=0|e[te+72>>2],0<(0|(e[320+_>>2]=Y))){v=0|e[a>>2],n=0|e[t+1032>>2],I=0|e[t+1036>>2],w=0|e[t+1040>>2],E=0|e[t+1044>>2],P=0|e[t+1028>>2],ne=t+1052|0,z=t+1048|0,se=t+1056|0,K=0;do{if(F=0|e[n+(K<<2)>>2],e[v+(28*K|0)+4>>2]=F,e[v+(28*K|0)>>2]=e[I+(K<<2)>>2],ie=0|e[w+(K<<2)>>2],e[v+(28*K|0)+16>>2]=ie,M=0|e[E+(K<<2)>>2],e[v+(28*K|0)+20>>2]=M,e[v+(28*K|0)+24>>2]=ie+1-M,M=(e[v+(28*K|0)+8>>2]=0)|e[P+(K<<2)>>2],0<(0|F))for(V=0|e[v+(28*K|0)+12>>2],U=0|e[ne>>2],H=0|e[z>>2],r=0|e[se>>2],X=0;ie=X+M|0,e[V+(X<<4)+4>>2]=e[U+(ie<<2)>>2],e[V+(X<<4)>>2]=e[H+(ie<<2)>>2],e[V+(X<<4)+8>>2]=e[r+(ie<<2)>>2],(0|(X=X+1|(e[V+(X<<4)+12>>2]=0)))!=(0|F););K=K+1|0}while((0|K)!=(0|Y))}if(v=0|e[te+80>>2],e[(V=340+_|0)>>2]=v,U=0|e[t+1068>>2],e[372+_>>2]=U,0<(0|v)){for(n=0|e[Ue>>2],I=0|e[t+1080>>2],w=0|e[t+1084>>2],E=0|e[t+1092>>2],P=0|e[t+1096>>2],F=0|e[t+1088>>2],M=0|e[t+1100>>2];e[n+(24*(v=(ie=v)+-1|0)|0)>>2]=e[I+(v<<2)>>2],e[n+(24*v|0)+4>>2]=e[w+(v<<2)>>2],e[n+(24*v|0)+8>>2]=e[E+(v<<2)>>2],Ue=0|e[F+(v<<2)>>2],e[n+(24*v|0)+12>>2]=P+(Ue<<2),e[n+(24*v|0)+16>>2]=M+(Ue<<1),1<(0|ie););if(0<(0|(v=0|e[V>>2])))for(w=0|e[Se>>2],I=0|e[u>>2],n=v,v=0;Se=0|e[w+(36*(0|e[U+((n=(ie=n)+-1|0)<<2)>>2])|0)+4>>2],v=(e[I+(n<<2)>>2]=Se)+v|0,1<(0|ie););else v=0}else v=0;if(e[360+_>>2]=v,0<(0|e[te+20>>2])){se=t+928|0,z=t+932|0,K=t+1004|0,X=t+1008|0,ne=t+1012|0,v=te,r=0;do{if(I=0|e[(0|e[se>>2])+(r<<2)>>2],U=(n=0|e[(0|e[z>>2])+(r<<2)>>2])+I|0,H=0|e[(0|e[A>>2])+(r<<2)>>2],(0|I)==-1)e[(0|e[Ge>>2])+(r<<2)>>2]=0;else{if(0<(0|n)){M=0|e[K>>2],V=0|e[X>>2],v=0;do{if(n=0|e[M+(I<<2)>>2],F=(ie=0|e[V+(I<<2)>>2])+n|0,(0|n)!=-1&0<(0|ie)){P=0|e[ne>>2];do{L=+S[P+(n<<2)>>2],w=H+(v<<2)|0;e:do if(v)for(E=H;;){if(+S[E>>2]==L)break e;if((0|(E=E+4|0))==(0|w)){Re=96;break}}else Re=96;while(0);(0|Re)==96&&(Re=0,S[w>>2]=L,v=v+1|0),n=n+1|0}while((0|n)<(0|F))}I=I+1|0}while((0|I)<(0|U))}else v=0;(function(De,ve){De|=0;var Ie,fe,ae,me,Xe=0,ce=0,Ce=0,Me=0,_e=0,we=0;x=(me=x)+208|0,Ce=(ve|=0)<<2,e[(_e=ae=(fe=me)+192|0)>>2]=1,e[_e+4>>2]=0;e:do if(0|Ce){for(e[fe+4>>2]=4,Xe=ve=e[fe>>2]=4,ce=2;ve=ve+4+Xe|0,(e[fe+(ce<<2)>>2]=ve)>>>0<Ce>>>0;)_e=Xe,Xe=ve,ce=ce+1|0,ve=_e;if(De>>>0<(Me=De+Ce+-4|0)>>>0){Ie=Me,_e=4+ae|0,Xe=De,ce=ve=1;do{do{if((3&ve|0)!=3){if((0|e[fe+((Ce=ce+-1|0)<<2)>>2])>>>0<(Ie-Xe|0)>>>0?nr(Xe,ce,fe):Vi(Xe,ve,0|e[_e>>2],ce,0,fe),(0|ce)==1){Ui(ae,1),ce=0;break}Ui(ae,Ce),ce=1;break}nr(Xe,ce,fe),Oi(ae,2),ce=ce+2|0}while(0);ve=1|e[ae>>2],e[ae>>2]=ve,Xe=Xe+4|0}while(Xe>>>0<Me>>>0);Ce=0|e[(Me=_e)>>2]}else Me=4+ae|0,Ce=0,Xe=De,ce=ve=1;for(Vi(Xe,ve,Ce,ce,0,fe),Ce=4+ae|0;;){if((0|ce)==1&(0|ve)==1){if(!(0|e[Ce>>2]))break e;we=21}else(0|ce)<2?we=21:(Ui(ae,2),De=ce+-2|0,e[ae>>2]=7^e[ae>>2],Oi(ae,1),Vi(Xe+(0-(0|e[fe+(De<<2)>>2]))+-4|0,0|e[ae>>2],0|e[Me>>2],ce+-1|0,1,fe),Ui(ae,1),ve=1|e[ae>>2],Vi(Xe=Xe+-4|0,e[ae>>2]=ve,0|e[Me>>2],De,1,fe),ce=De);(0|we)==21&&(Oi(ae,De=(we=0)|l0(ae)),ve=0|e[ae>>2],Xe=Xe+-4|0,ce=De+ce|0)}}while(0);x=me})(H,v),e[(0|e[Ge>>2])+(r<<2)>>2]=v,v=0|e[f>>2]}r=r+1|0}while((0|r)<(0|e[v+20>>2]))}return e[_>>2]=t,Qr(_),x=Ee,0|_}function Yt(t,r){r|=0;var n,g;return 0|((g=+S[(t|=0)>>2])<(n=+S[r>>2])?-1:n<g&1)}function Ds(t){t|=0;var r,n,g,h=0,c=0,a=0,d=0,u=0,f=0,A=0,_=0,v=0,I=0,w=0,E=x;if(x=x+32|0,c=E+24|0,e[(w=E)>>2]=4,e[w+4>>2]=1,function(P,F){F|=0;var M;x=(P=x)+272|0,M=P+16|0,e[P>>2]=F,o0(M,840,P),function(V){V|=0;var L;x=(L=x)+16|0,e[L>>2]=V,function(U,H){H|=0,x=(U=x)+16|0,e[U>>2]=H,e0(496,2328,U),x=U}(0,L),x=L}(M),x=P}(e[w+8>>2]=0,w),0|a0(t))return he(0,885,E+16|0),x=E,(w=0)|w;if(3<(255&(h=0|B[(A=t+4|0)>>0])))return e[c>>2]=3,e[c+4>>2]=255&h,he(0,948,c),x=E,(w=0)|w;for(c=t+64|0,(f=(0|B[(h=t+5|0)>>0])!=0)&&(Zt(A,1),W(c,4,160),B[h>>0]=0),d=102,u=a=t+704|0,h=c;d=d+-1|0,e[u>>2]=t+(0|e[h>>2]),d;)u=u+4|0,h=h+4|0;if(f&&(w=0|B[A>>0],W(0|e[a>>2],4,32),Zt(0|e[(I=t+708|0)>>2],4),Zt(4+(0|e[I>>2])|0,4),Zt(8+(0|e[I>>2])|0,4),Zt(12+(0|e[I>>2])|0,4),Zt(16+(0|e[I>>2])|0,4),Zt(20+(0|e[I>>2])|0,1),W(0|e[t+720>>2],4,0|e[e[a>>2]>>2]),W(0|e[t+724>>2],4,0|e[e[a>>2]>>2]),W(0|e[t+728>>2],4,0|e[e[a>>2]>>2]),W(0|e[t+732>>2],4,0|e[e[a>>2]>>2]),W(0|e[t+736>>2],4,0|e[e[a>>2]>>2]),W(0|e[t+740>>2],4,0|e[e[a>>2]>>2]),W(0|e[t+752>>2],4,0|e[4+(0|e[a>>2])>>2]),W(0|e[t+756>>2],4,0|e[4+(0|e[a>>2])>>2]),W(0|e[t+760>>2],4,0|e[4+(0|e[a>>2])>>2]),W(0|e[t+764>>2],4,0|e[4+(0|e[a>>2])>>2]),W(0|e[t+768>>2],4,0|e[4+(0|e[a>>2])>>2]),W(0|e[t+772>>2],4,0|e[4+(0|e[a>>2])>>2]),W(0|e[t+776>>2],4,0|e[4+(0|e[a>>2])>>2]),W(0|e[t+780>>2],4,0|e[8+(0|e[a>>2])>>2]),W(0|e[t+784>>2],4,0|e[8+(0|e[a>>2])>>2]),W(0|e[t+788>>2],4,0|e[8+(0|e[a>>2])>>2]),W(0|e[t+792>>2],4,0|e[8+(0|e[a>>2])>>2]),W(0|e[t+796>>2],4,0|e[8+(0|e[a>>2])>>2]),W(0|e[t+800>>2],4,0|e[8+(0|e[a>>2])>>2]),W(0|e[t+804>>2],4,0|e[12+(0|e[a>>2])>>2]),W(0|e[t+808>>2],4,0|e[12+(0|e[a>>2])>>2]),W(0|e[t+812>>2],4,0|e[12+(0|e[a>>2])>>2]),W(0|e[t+816>>2],4,0|e[12+(0|e[a>>2])>>2]),W(0|e[t+840>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+844>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+848>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+852>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+856>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+860>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+864>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+868>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+872>>2],1,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+876>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+880>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+884>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+888>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+892>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+896>>2],4,0|e[16+(0|e[a>>2])>>2]),W(0|e[t+908>>2],4,0|e[20+(0|e[a>>2])>>2]),W(0|e[t+912>>2],4,0|e[20+(0|e[a>>2])>>2]),W(0|e[t+916>>2],4,0|e[20+(0|e[a>>2])>>2]),W(0|e[t+920>>2],4,0|e[20+(0|e[a>>2])>>2]),W(0|e[t+924>>2],4,0|e[20+(0|e[a>>2])>>2]),W(0|e[t+928>>2],4,0|e[20+(0|e[a>>2])>>2]),W(0|e[t+932>>2],4,0|e[20+(0|e[a>>2])>>2]),W(0|e[t+936>>2],4,0|e[24+(0|e[a>>2])>>2]),W(0|e[t+940>>2],4,0|e[28+(0|e[a>>2])>>2]),W(0|e[t+944>>2],4,0|e[28+(0|e[a>>2])>>2]),W(0|e[t+948>>2],4,0|e[32+(0|e[a>>2])>>2]),W(0|e[t+952>>2],4,0|e[32+(0|e[a>>2])>>2]),W(0|e[t+956>>2],4,0|e[32+(0|e[a>>2])>>2]),W(0|e[t+960>>2],4,0|e[32+(0|e[a>>2])>>2]),W(0|e[t+964>>2],4,0|e[32+(0|e[a>>2])>>2]),W(0|e[t+968>>2],4,0|e[32+(0|e[a>>2])>>2]),W(0|e[t+972>>2],4,0|e[32+(0|e[a>>2])>>2]),W(0|e[t+976>>2],4,0|e[36+(0|e[a>>2])>>2]),W(0|e[t+980>>2],4,0|e[36+(0|e[a>>2])>>2]),W(0|e[t+984>>2],4,0|e[36+(0|e[a>>2])>>2]),W(0|e[t+988>>2],4,0|e[40+(0|e[a>>2])>>2]),W(0|e[t+992>>2],4,0|e[44+(0|e[a>>2])>>2]),W(0|e[t+996>>2],4,0|e[48+(0|e[a>>2])>>2]),W(0|e[t+1e3>>2],4,0|e[48+(0|e[a>>2])>>2]),W(0|e[t+1004>>2],4,0|e[52+(0|e[a>>2])>>2]),W(0|e[t+1008>>2],4,0|e[52+(0|e[a>>2])>>2]),W(0|e[t+1012>>2],4,0|e[56+(0|e[a>>2])>>2]),W(0|e[t+1016>>2],4,0|e[60+(0|e[a>>2])>>2]),W(0|e[t+1020>>2],2,0|e[64+(0|e[a>>2])>>2]),W(0|e[t+1024>>2],4,0|e[68+(0|e[a>>2])>>2]),W(0|e[t+1028>>2],4,0|e[72+(0|e[a>>2])>>2]),W(0|e[t+1032>>2],4,0|e[72+(0|e[a>>2])>>2]),W(0|e[t+1036>>2],4,0|e[72+(0|e[a>>2])>>2]),W(0|e[t+1040>>2],4,0|e[72+(0|e[a>>2])>>2]),W(0|e[t+1044>>2],4,0|e[72+(0|e[a>>2])>>2]),W(0|e[t+1048>>2],4,0|e[76+(0|e[a>>2])>>2]),W(0|e[t+1052>>2],4,0|e[76+(0|e[a>>2])>>2]),W(0|e[t+1056>>2],4,0|e[76+(0|e[a>>2])>>2]),W(0|e[t+1068>>2],4,0|e[80+(0|e[a>>2])>>2]),W(0|e[t+1072>>2],4,0|e[80+(0|e[a>>2])>>2]),W(0|e[t+1076>>2],4,0|e[80+(0|e[a>>2])>>2]),W(0|e[t+1080>>2],4,0|e[80+(0|e[a>>2])>>2]),W(0|e[t+1084>>2],4,0|e[80+(0|e[a>>2])>>2]),W(0|e[t+1088>>2],4,0|e[80+(0|e[a>>2])>>2]),W(0|e[t+1092>>2],4,0|e[80+(0|e[a>>2])>>2]),W(0|e[t+1096>>2],4,0|e[84+(0|e[a>>2])>>2]),W(0|e[t+1100>>2],2,0|e[84+(0|e[a>>2])>>2]),W(0|e[t+1104>>2],4,0|e[88+(0|e[a>>2])>>2]),1<(255&w))&&W(0|e[t+1108>>2],4,0|e[8+(0|e[a>>2])>>2]),h=0|e[(w=a)>>2],0<(0|e[h>>2]))for(c=t+716|0,a=t+712|0,d=0;e[(0|e[a>>2])+(d<<2)>>2]=(0|e[c>>2])+(d<<6),d=d+1|0,h=0|e[w>>2],(0|d)<(0|e[h>>2]););if(0<(0|e[h+4>>2]))for(c=t+748|0,a=t+744|0,d=0;e[(0|e[a>>2])+(d<<2)>>2]=(0|e[c>>2])+(d<<6),d=d+1|0,h=0|e[w>>2],(0|d)<(0|e[h+4>>2]););if(0<(0|e[h+16>>2]))for(u=t+836|0,f=t+820|0,v=t+1016|0,n=t+880|0,g=t+824|0,A=t+1020|0,_=t+884|0,r=t+828|0,c=t+1024|0,a=t+892|0,d=t+832|0,I=0;e[(0|e[f>>2])+(I<<2)>>2]=(0|e[u>>2])+(I<<6),e[(0|e[g>>2])+(I<<2)>>2]=(0|e[v>>2])+(e[(0|e[n>>2])+(I<<2)>>2]<<2),e[(0|e[r>>2])+(I<<2)>>2]=(0|e[A>>2])+(e[(0|e[_>>2])+(I<<2)>>2]<<1),e[(0|e[d>>2])+(I<<2)>>2]=(0|e[c>>2])+(e[(0|e[a>>2])+(I<<2)>>2]<<2),I=I+1|0,h=0|e[w>>2],(0|I)<(0|e[h+16>>2]););if(0<(0|e[h+20>>2]))for(c=t+904|0,a=t+900|0,d=0;e[(0|e[a>>2])+(d<<2)>>2]=(0|e[c>>2])+(d<<6),d=d+1|0,h=0|e[w>>2],(0|d)<(0|e[h+20>>2]););if(0<(0|e[h+80>>2]))for(c=t+1064|0,a=t+1060|0,d=0;e[(0|e[a>>2])+(d<<2)>>2]=(0|e[c>>2])+(d<<6),d=d+1|0,h=0|e[w>>2],(0|d)<(0|e[h+80>>2]););if(1&B[20+(0|e[t+708>>2])>>0]||(0|(_=0|e[h+16>>2]))<=0)return x=E,0|t;h=0|e[t+1020>>2],c=0|e[t+884>>2],a=0|e[t+888>>2],u=0;do{if(d=h+(e[c+(u<<2)>>2]<<1)|0,A=(w=0|e[a+(u<<2)>>2])-1|0,1<(0|w))for(f=0;I=0|Le[(v=d+(f<<1)|0)>>1],w=d+(f+2<<1)|0,Le[v>>1]=0|Le[w>>1],Le[w>>1]=I,(0|(f=f+3|0))<(0|A););u=u+1|0}while((0|u)!=(0|_));c=0|e[t+1016>>2],a=0|e[t+880>>2],d=0|e[t+876>>2],f=0;do{if(u=(h=c+(e[a+(f<<2)>>2]<<2)|0)+((w=0|e[d+(f<<2)>>2])<<1<<2)|0,0<(0|w))for(h=h+4|0;S[h>>2]=1-+S[h>>2],(h=h+8|0)>>>0<u>>>0;);f=f+1|0}while((0|f)!=(0|_));return x=E,0|t}function Ts(t){var r=x;return x=x+16|0,0|a0(t|=0)?(he(0,1057,r),x=r,(t=0)|t):(t=0|ze[t+4>>0],x=r,0|t)}function $r(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|function(g){g|=0;var h,c,a=x;return x=x+336|0,h=(c=a)+320|0,Ct(0|c,0,320),qr(704+g|0,c,h),x=a,0|e[h>>2]}(t),x=n,0|r):(e[r>>2]=1362,e[r+4>>2]=1380,he(0,1116,r),x=n,(r=0)|r)}function Kr(t,r,n){r|=0,n|=0;var g,h,c=0,a=0,d=x;return x=x+32|0,a=d+24|0,h=d+16|0,c=d+8|0,g=d,(t|=0)?r?((c=r)+15&-16|0)!=(0|c)?(e[h>>2]=1398,e[4+h>>2]=1189,he(0,1116,h),x=d,(a=0)|a):(r=0|bs(t,r,n))?(x=d,0|(a=r)):(e[a>>2]=1398,e[a+4>>2]=1424,he(0,1116,a),x=d,(a=0)|a):(e[c>>2]=1398,e[c+4>>2]=1150,he(0,1116,c),x=d,(a=0)|a):(e[g>>2]=1398,e[g+4>>2]=1380,he(0,1116,g),x=d,(a=0)|a)}function Es(t,r,n,g){if(n=+n,g=+g,(r=+lt(+(r=+r),+(t=+t))-+lt(+g,+n))<-3.1415927410125732)for(;(r+=6.2831854820251465)<-3.1415927410125732;);if(!(3.1415927410125732<r))return+r;for(;3.1415927410125732<(r+=-6.2831854820251465););return+r}function Zt(t,r){var n;if(!((r=(t|=0)+(r|=0)-1|0)>>>0<=t>>>0))for(;n=0|B[t>>0],B[t>>0]=0|B[r>>0],t=t+1|0,B[r>>0]=n,t>>>0<(r=r+-1|0)>>>0;);}function W(t,r,n){t|=0,r|=0;var g,h=0,c=0;if(n|=0)do if(n=n+-1|0,(c=t)>>>0<(h=(t=t+r|0)-1|0)>>>0)for(;g=0|B[c>>0],B[c>>0]=0|B[h>>0],c=c+1|0,B[h>>0]=g,c>>>0<(h=h+-1|0)>>>0;);while((0|n)!=0)}function Fs(t){var r,n,g,h,c,a,d,u,f,A,_,v,I,w,E,P,F=0,M=0,V=(F=0|e[344+(t|=0)>>2])+(24*(P=0|e[t+340>>2])|0)|0;if(!((0|P)<=0)){P=0|e[t+272>>2];do{if(t=0|e[F+8>>2],n=0|e[P+(e[F>>2]<<2)>>2],g=0|e[P+(e[F+4>>2]<<2)>>2],h=0|e[F+12>>2],c=0|e[F+16>>2],r=+S[F+20>>2],0<(0|t))for(M=0;a=1|M,w=+S[h+(M<<2)>>2],f=+S[h+(a<<2)>>2],I=(0|ct[c+(M<<1)>>1])<<1&65534,v=+S[(E=n+(I<<2)|0)>>2],u=+S[(I=n+((1|I)<<2)|0)>>2],a=(0|ct[c+(a<<1)>>1])<<1&65534,_=+S[(A=g+(a<<2)|0)>>2],d=+S[(a=g+((1|a)<<2)|0)>>2],S[E>>2]=v+w*(_-v)*r,S[I>>2]=u+w*(d-u)*r,S[A>>2]=_+f*(v-_)*r,S[a>>2]=d+f*(u-d)*r,(0|(M=M+2|0))<(0|t););F=F+24|0}while(F>>>0<V>>>0)}}function Qr(t){var r,n,g,h,c,a=0,d=0,u=0,f=0,A=0,_=0,v=0,I=0,w=0,E=0,P=0,F=0,M=0,V=0,L=0,U=0,H=0,ne=0,se=0,z=0,K=0,X=0,Y=0,te=0,oe=0,Ve=0,He=0,Ue=0,Se=0,Ge=0,Re=0,ie=0,Ee=0,De=0,ve=0,Ie=0,fe=0,ae=0,me=0,Xe=0,ce=0,Ce=0,Me=0,_e=0,we=0,$t=0,y0=0,ye=0,v0=0,w0=0,x0=0,hr=0,M0=0,C0=0,wi=0,xi=0,Kt=0,ge=0,Qt=x;if(x=x+16|0,Se=Qt,0|e[(Kt=256+(t|=0)|0)>>2]&&(_e=e[t+200>>2]<<2,Dt(0|e[t+280>>2],0|e[t+264>>2],0|_e),Dt(0|e[t+284>>2],0|e[t+268>>2],0|_e),Dt(0|e[t+288>>2],0|e[t+276>>2],0|_e)),_e=0|e[t+292>>2],F=(_=0|e[t+296>>2])+(40*_e|0)|0,0<(0|_e)){for(u=_,A=0|e[t+300>>2];M=+S[A>>2],M=(f=(0|e[u+12>>2])==0)?(fe=+S[u>>2],ae=+S[u+4>>2],M<fe?fe:ae<M?ae:M):(ae=+S[u+8>>2],(fe=+S[u>>2])+ae*((M=(M-fe)/ae)-(0|~~+St(+M)))),a=u+36|0,+S[(d=u+32|0)>>2]!=M?(e[a>>2]=1,S[d>>2]=M):e[a>>2]=0,f&&(S[A>>2]=M),!(F>>>0<=(u=u+40|0)>>>0);)A=A+4|0;E=0|e[t+308>>2],P=(0|e[t+376>>2])==0;do{g=+S[_+32>>2],fe=+S[_+16>>2],ae=+S[_+20>>2],w=(a=E+(28*(0|e[_+24>>2])|0)|0)+(28*(_e=0|e[_+28>>2])|0)|0;e:do if(0<(0|_e)){if(!P)for(;;){f=0|e[a>>2];do if(1<=(0|f)){if(u=0|e[a+4>>2],M=(K=+S[u>>2])-fe,(0|f)==1){f=!(g<fe+K)|!(M<g),M=d=0,ye=52;break}if(g<M){u=a+16|0,A=1,M=d=0,ye=54;break}if(g<fe+K)M=d=f=0,ye=52;else{for(d=1;!(g<fe+(M=+S[u+(d<<2)>>2]));){if(!((0|(d=d+1|0))<(0|f))){ye=51;break}K=M}if((0|ye)==51){u=a+16|0,d=f+-(A=1)|0,M=0,ye=54;break}M=M-fe<g?f=0:(d=d+-1|0,(M-=K)<ae?f=0:(f=0,(g-K)/M)),ye=52}}else M=d=f=0,ye=52;while(0);if((0|ye)==52&&(f|(ye=0)==(0|e[(u=a+16|0)>>2])?(A=1&f,ye=54):(e[a+24>>2]=1,e[a+20>>2]=1,I=a+8|0,v=a+12|0,f=0)),(0|ye)==54&&(_e=(K=+S[(v=a+12|(ye=0))>>2])!=M,f=1&((0|e[(I=a+8|0)>>2])!=(0|d)|_e&(M==0|K==0)),e[a+24>>2]=1&_e,e[a+20>>2]=f,f=A),S[v>>2]=M,e[I>>2]=d,e[u>>2]=f,w>>>0<=(a=a+28|0)>>>0)break e}if(!(0|e[_+36>>2])){for(;;)if(e[a+24>>2]=0,w>>>(e[a+20>>2]=0)<=(a=a+28|0)>>>0)break e}do{f=0|e[a>>2];do if(1<=(0|f)){if(u=0|e[a+4>>2],M=(K=+S[u>>2])-fe,(0|f)==1){f=!(g<fe+K)|!(M<g),M=d=0,ye=35;break}if(g<M){u=a+16|0,A=1,M=d=0,ye=37;break}if(g<fe+K)M=d=f=0,ye=35;else{for(d=1;!(g<fe+(M=+S[u+(d<<2)>>2]));){if(!((0|(d=d+1|0))<(0|f))){ye=32;break}K=M}if((0|ye)==32){u=a+16|0,d=f+-(A=1)|0,M=0,ye=37;break}M=M-fe<g?f=0:(d=d+-1|0,(M-=K)<ae?f=0:(f=0,(g-K)/M)),ye=35}}else M=d=f=0,ye=35;while(0);(0|ye)==35&&(f|(ye=0)==(0|e[(u=a+16|0)>>2])?(A=1&f,ye=37):(e[a+24>>2]=1,e[a+20>>2]=1,I=a+8|0,v=a+12|0,f=0)),(0|ye)==37&&(_e=(K=+S[(v=a+12|(ye=0))>>2])!=M,f=1&((0|e[(I=a+8|0)>>2])!=(0|d)|_e&(M==0|K==0)),e[a+24>>2]=1&_e,e[a+20>>2]=f,f=A),S[v>>2]=M,e[I>>2]=d,e[u>>2]=f,a=a+28|0}while(a>>>0<w>>>0)}while(0);_=_+40|0}while(_>>>0<F>>>0)}if(U=(a=0|e[(_e=t+316|0)>>2])+(36*(Me=0|e[t+312>>2])|0)|0,0<(0|Me)){L=t+308|0,H=(0|e[t+376>>2])==0;do{F=0|e[L>>2],V=(_=0|e[a+12>>2])+((I=0|e[a>>2])<<2)|0;e:do if(0<(0|I))for(v=_,f=u=d=0;;){if(A=0|e[v>>2],0|e[F+(28*A|0)+16>>2]){f=1,d=u=0;break e}if(f=f||0|e[F+(28*A|0)+24>>2],u=u||0|e[F+(28*A|0)+20>>2],d=d+(+S[F+(28*A|0)+12>>2]!=0&1)|0,V>>>0<=(v=v+4|0)>>>0){v=d,d=u,ye=67;break}}else f=d=v=0,ye=67;while(0);e:do if((0|ye)==67)if(u=H?d:1,(ye=0)!=((d=H?f:1)|u|0)&&(X=1<<v,e[a+8>>2]=X,ne=0|e[a+16>>2],se=0|e[a+20>>2],z=ne+(X<<2)|0,(0|v)!=31)){for(Ct(0|ne,0,((f=ne+4|0)>>>0<z>>>0?z:f)+~ne+4&-4|0),f=se+(X<<2)|0,A=se;S[A>>2]=1,(A=A+4|0)>>>0<f>>>0;);if(1<=(0|I)){if(!v)for(I=1;;){if(A=0|e[_>>2],M=+S[F+(28*A|0)+12>>2],v=0|et(0|e[F+(28*A|0)+8>>2],I),M==0)for(f=0;e[(Me=ne+(f<<2)|0)>>2]=(0|e[Me>>2])+v,(0|(f=f+1|0))!=(0|X););else e[ne>>2]=(0|e[ne>>2])+v,S[se>>2]=(1-M)*+S[se>>2];if(_=_+4|0,I=0|et(0|e[F+(28*A|0)>>2],I),V>>>0<=_>>>0){f=0;break e}}P=f=1;do{if(E=0|e[_>>2],M=+S[(I=F+(28*E|0)+12|0)>>2],A=0|e[F+(28*E|0)+8>>2],w=0|et(A,P),M==0)for(A=0;e[(Me=ne+(A<<2)|0)>>2]=(0|e[Me>>2])+w,(0|(A=A+1|0))!=(0|X););else{for(v=0|et(A+1|0,P),e[ne>>2]=(0|e[ne>>2])+w,S[se>>2]=(1-M)*+S[se>>2],A=1;ae=+S[I>>2],Ce=(A&f|0)!=0,e[(Me=ne+(A<<2)|0)>>2]=(Ce?v:w)+(0|e[Me>>2]),S[(Me=se+(A<<2)|0)>>2]=(Ce?ae:1-ae)*+S[Me>>2],(0|(A=A+1|0))!=(0|X););f<<=1}_=_+4|0,P=0|et(0|e[F+(28*E|0)>>2],P)}while(_>>>0<V>>>0);f=0}else f=0}else f=0;while(0);e[a+28>>2]=d,e[a+24>>2]=u,e[a+32>>2]=f,a=a+36|0}while(a>>>0<U>>>0)}if(u=0|e[(Ce=t+4|0)>>2],d=(a=0|e[(Me=t+52|0)>>2])+(u<<2)|0,0<(0|u)){for(;ae=+S[a>>2],S[a>>2]=ae<0?0:1<ae?1:ae,(a=a+4|0)>>>0<d>>>0;);for(u=(_=0|e[(H=t+8|0)>>2])+(u<<3)|0,L=0|e[_e>>2],f=a=0|e[(U=t+36|0)>>2],A=v=0|e[t+40>>2];;){do if(0|e[_+4>>2]){if((0|(ce=0|e[_>>2]))!=-1&&(0|e[a+(ce<<2)>>2])==0){d=0;break}d=(0|e[L+(36*(0|e[A>>2])|0)+32>>2])==0}else d=0;while(0);if(e[f>>2]=1&d,u>>>0<=(_=_+8|0)>>>0)break;f=f+4|0,A=A+4|0}if(w=0|e[Ce>>2],a=0|e[t>>2],E=0|e[a+724>>2],0<(0|w))for(P=t+16|0,F=t+28|0,V=t+20|0,I=a+936|0,_=A=0;;){if(f=0|e[v>>2],((0|e[(a=L+(36*f|0)+24|0)>>2])!=0||0|e[L+(36*f|0)+28>>2])&&(ye=102),(0|ye)==102&&(Ve=L+(36*f|(ye=0))+8|0,e[(0|e[P>>2])+(A<<2)>>2]=e[Ve>>2],0|e[a>>2])&&(Y=0|e[E+(A<<2)>>2],He=(te=0|e[L+(36*f|0)+16>>2])+((ce=0|e[Ve>>2])<<2)|0,0<(0|ce)))for(a=0|e[I>>2],d=(0|e[F>>2])+(_<<2)|0,u=te;e[d>>2]=e[a+((0|e[u>>2])+Y<<2)>>2],!(He>>>0<=(u=u+4|0)>>>0);)d=d+4|0;if(0|e[L+(36*f|0)+28>>2]&&(Ue=(oe=0|e[L+(36*f|0)+20>>2])+((ce=0|e[L+(36*f|0)+8>>2])<<2)|0,0<(0|ce)))for(a=(0|e[V>>2])+(_<<2)|0,d=oe;e[a>>2]=e[d>>2],!(Ue>>>0<=(d=d+4|0)>>>0);)a=a+4|0;if((0|(A=A+1|0))==(0|w)){ce=U,Xe=H,me=t;break}v=v+4|0,_=(0|e[L+(36*f|0)+4>>2])+_|0}else ce=U,Xe=H,me=t}else ce=t+36|0,Xe=t+8|0,me=t;if(function(G){var We,Ye,Je,Oe=0,qe=0,ke=0,ue=0,ee=0,le=0,pe=0,xe=0|e[4+(G|=0)>>2],pe=0|e[G+36>>2];if(0<(0|(Oe=0|e[G+24>>2])))for(qe=0|e[G+28>>2],ke=0|e[G+20>>2],ue=0|e[G+32>>2],ee=0;S[ue+(ee<<2)>>2]=+S[qe+(ee<<2)>>2]*+S[ke+(ee<<2)>>2],(0|(ee=ee+1|0))!=(0|Oe););if(!((0|xe)<=0))for(We=0|e[G+12>>2],Je=G+16|0,Ye=G+44|0,G=G+32|0,ee=ue=0;;){if(0|e[pe>>2]){if(qe=(ke=0|e[(0|e[Je>>2])+(ee<<2)>>2])+ue|0,0<(0|ke))for(Oe=0|e[G>>2],le=0,ke=ue;le+=+S[Oe+(ke<<2)>>2],(0|(ke=ke+1|0))<(0|qe););else le=0;e[(0|e[Ye>>2])+(ee<<2)>>2]=~~(le+.0010000000474974513)}if((0|(Oe=ee+1|0))==(0|xe))break;pe=pe+4|0,ue=(0|e[We+(ee<<2)>>2])+ue|0,ee=Oe}}(t),I=(a=0|e[(c=t+60|0)>>2])+((Ie=0|e[t+56>>2])<<5)|0,u=0|e[_e>>2],f=0|e[ce>>2],A=0|e[(h=t+168|0)>>2],_=0|e[t+172>>2],v=0|e[t+176>>2],0<(0|Ie)){for(w=A,E=0|e[t+180>>2];;){do if(0|e[a+28>>2]){if((0|(Ie=0|e[a>>2]))!=-1&&(0|e[f+(Ie<<2)>>2])==0){d=0;break}if((0|(Ie=0|e[a+4>>2]))!=-1&&(0|e[A+(Ie<<2)>>2])==0){d=0;break}d=(0|e[u+(36*(0|e[E>>2])|0)+32>>2])==0}else d=0;while(0);switch(d&=1,e[w>>2]=d,0|e[a+8>>2]){case 0:e[_+(e[a+12>>2]<<2)>>2]=d;break;case 1:e[v+(e[a+12>>2]<<2)>>2]=d;break;default:he(0,2268,Se)}if(I>>>0<=(a=a+32|0)>>>0)break;w=w+4|0,E=E+4|0}u=0|e[_e>>2]}if(a=0|e[me>>2],E=0|e[a+784>>2],P=0|e[t+64>>2],F=0|e[a+988>>2],0<(0|P)){for(V=t+84|0,H=t+100|0,U=t+96|0,ne=t+88|0,L=a+944|0,_=a+940|0,v=0|e[t+184>>2],w=I=0;;){if(A=0|e[v>>2],((0|e[(a=u+(36*A|0)+24|0)>>2])!=0||0|e[u+(36*A|0)+28>>2])&&(ye=129),(0|ye)==129&&(Ee=u+(36*A|(ye=0))+8|0,e[(0|e[V>>2])+(I<<2)>>2]=e[Ee>>2],0|e[a>>2])&&(Ge=0|e[E+(I<<2)>>2],De=(Re=0|e[u+(36*A|0)+16>>2])+((Ie=0|e[Ee>>2])<<2)|0,0<(0|Ie)))for(a=Re,d=(0|e[U>>2])+(w<<2)|0,f=(0|e[H>>2])+(w<<2)|0;Ie=(0|e[a>>2])+Ge|0,e[f>>2]=F+(e[(0|e[L>>2])+(Ie<<2)>>2]<<2),e[d>>2]=e[(0|e[_>>2])+(Ie<<2)>>2],!(De>>>0<=(a=a+4|0)>>>0);)d=d+4|0,f=f+4|0;if(0|e[u+(36*A|0)+28>>2]&&(ve=(ie=0|e[u+(36*A|0)+20>>2])+((Ie=0|e[u+(36*A|0)+8>>2])<<2)|0,0<(0|Ie)))for(a=(0|e[ne>>2])+(w<<2)|0,d=ie;e[a>>2]=e[d>>2],!(ve>>>0<=(d=d+4|0)>>>0);)a=a+4|0;if((0|(I=I+1|0))==(0|P))break;v=v+4|0,w=(0|e[u+(36*A|0)+4>>2])+w|0}a=0|e[me>>2],u=0|e[_e>>2]}if(Y=0|e[a+808>>2],te=0|e[t+72>>2],oe=0|e[t+76>>2],0<(0|te))for(Ue=t+116|0,He=t+132|0,ie=t+136|0,De=t+140|0,n=t+144|0,Se=t+128|0,Ie=t+120|0,Ve=a+952|0,Re=a+956|0,Ee=a+960|0,r=a+964|0,Ge=a+948|0,ve=a+968|0,ne=a+972|0,se=0|e[t+188>>2],X=z=0;;){if(H=0|e[se>>2],((0|e[(a=u+(36*H|0)+24|0)>>2])!=0||0|e[u+(36*H|0)+28>>2])&&(ye=143),(0|ye)==143&&($t=u+(36*H|(ye=0))+8|0,e[(0|e[Ue>>2])+(z<<2)>>2]=e[$t>>2],0|e[a>>2])){if(a=0|e[Y+(z<<2)>>2],w=(d=0|e[u+(36*H|0)+16>>2])+((U=0|e[$t>>2])<<2)|0,0<(0|U))for(f=0|e[Ve>>2],A=0|e[Re>>2],_=0|e[Ee>>2],v=0|e[r>>2],I=0|e[Ge>>2],E=(0|e[He>>2])+(X<<2)|0,P=d,F=(0|e[Se>>2])+(X<<2)|0,V=(0|e[ie>>2])+(X<<2)|0,L=(0|e[De>>2])+(X<<2)|0,U=(0|e[n>>2])+(X<<2)|0;ge=(0|e[P>>2])+a|0,e[E>>2]=e[f+(ge<<2)>>2],e[V>>2]=e[A+(ge<<2)>>2],e[L>>2]=e[_+(ge<<2)>>2],e[U>>2]=e[v+(ge<<2)>>2],e[F>>2]=e[I+(ge<<2)>>2],!(w>>>0<=(P=P+4|0)>>>0);)E=E+4|0,F=F+4|0,V=V+4|0,L=L+4|0,U=U+4|0;ge=(0|e[d>>2])+a|0,e[oe+(z<<5)+24>>2]=e[(0|e[ve>>2])+(ge<<2)>>2],e[oe+(z<<5)+28>>2]=e[(0|e[ne>>2])+(ge<<2)>>2]}if(0|e[u+(36*H|0)+28>>2]&&(y0=(we=0|e[u+(36*H|0)+20>>2])+((ge=0|e[u+(36*H|0)+8>>2])<<2)|0,0<(0|ge)))for(a=(0|e[Ie>>2])+(X<<2)|0,d=we;e[a>>2]=e[d>>2],!(y0>>>0<=(d=d+4|0)>>>0);)a=a+4|0;if((0|(z=z+1|0))==(0|te))break;se=se+4|0,X=(0|e[u+(36*H|0)+4>>2])+X|0}if(function(G){var We,Ye,Je,Oe,qe,ke,ue,ee,le,pe=0,xe=0,Te=0,mt=0,Pe=0,Ze=0,Be=0,ut=0,ot=0,Ke=0,Tt=0,vt=0|e[68+(G|=0)>>2],pt=0|e[G+64>>2],Be=0|e[G+172>>2];if(0<(0|(pe=0|e[G+92>>2])))for(xe=0|e[G+96>>2],Te=0|e[G+88>>2],mt=0|e[G+104>>2],Pe=0;S[mt+(Pe<<2)>>2]=+S[xe+(Pe<<2)>>2]*+S[Te+(Pe<<2)>>2],(0|(Pe=Pe+1|0))!=(0|pe););if(!((0|pt)<=0))for(qe=0|e[G+80>>2],ke=G+84|0,ue=G+104|0,ee=G+100|0,le=G+88|0,Oe=G+108|0,Ke=ot=0;;){if(0|e[Be>>2]){if(Je=(Te=0|e[(0|e[ke>>2])+(ot<<2)>>2])+Ke|0,Te=0<(0|Te))for(pe=0|e[ue>>2],xe=Ke,Ze=0;Ze+=+S[pe+(xe<<2)>>2],(0|(xe=xe+1|0))<(0|Je););else Ze=0;if(S[vt+(24*ot|0)+16>>2]=Ze,Ye=(ut=0|e[vt+(24*ot|0)+12>>2])<<1,0<(0|ut)&&(Ct(0|e[(Tt=vt+(24*ot|0)+20|0)>>2],0,(1<(0|Ye)?Ye:1)<<2|0),Te)){mt=0|e[ee>>2],Pe=0|e[le>>2],G=0|e[Oe>>2],We=0|e[Tt>>2],ut=Ke;do{for(pe=0|e[mt+(ut<<2)>>2],xe=Pe+(ut<<2)|0,Te=0;S[G+(Te<<2)>>2]=+S[pe+(Te<<2)>>2]*+S[xe>>2],(0|(Te=Te+1|0))<(0|Ye););for(pe=0;S[(Te=We+(pe<<2)|0)>>2]=+S[G+(pe<<2)>>2]+ +S[Te>>2],(0|(pe=pe+1|0))<(0|Ye););ut=ut+1|0}while((0|ut)<(0|Je))}}if(Ke=(0|e[qe+(ot<<2)>>2])+Ke|0,(0|(ot=ot+1|0))==(0|pt))break;Be=Be+4|0}}(t),function(G){var We,Ye,Je,Oe,qe,ke,ue=0,ee=0,le=0,pe=0,xe=0,Te=0,mt=0,Pe=0|e[76+(G|=0)>>2],Ze=0|e[G+72>>2],mt=0|e[G+176>>2];if(0<(0|(xe=0|e[G+124>>2]))){for(ue=0|e[G+128>>2],Te=0|e[G+120>>2],ee=0|e[G+148>>2],le=0;S[ee+(le<<2)>>2]=+S[ue+(le<<2)>>2]*+S[Te+(le<<2)>>2],(0|(le=le+1|0))!=(0|xe););for(ue=0|e[G+132>>2],ee=0|e[G+152>>2],le=0;S[ee+(le<<2)>>2]=+S[ue+(le<<2)>>2]*+S[Te+(le<<2)>>2],(0|(le=le+1|0))!=(0|xe););for(ue=0|e[G+136>>2],ee=0|e[G+156>>2],le=0;S[ee+(le<<2)>>2]=+S[ue+(le<<2)>>2]*+S[Te+(le<<2)>>2],(0|(le=le+1|0))!=(0|xe););for(ue=0|e[G+140>>2],ee=0|e[G+160>>2],le=0;S[ee+(le<<2)>>2]=+S[ue+(le<<2)>>2]*+S[Te+(le<<2)>>2],(0|(le=le+1|0))!=(0|xe););for(ue=0|e[G+144>>2],ee=0|e[G+164>>2],le=0;S[ee+(le<<2)>>2]=+S[ue+(le<<2)>>2]*+S[Te+(le<<2)>>2],(0|(le=le+1|0))!=(0|xe););}if(!((0|Ze)<=0))for(We=0|e[G+112>>2],Je=G+116|0,Oe=G+148|0,Ye=G+152|0,qe=G+156|0,ke=G+160|0,G=G+164|0,Te=xe=0;;){if(0|e[mt>>2]){if(le=(ee=0|e[(0|e[Je>>2])+(xe<<2)>>2])+Te|0,0<(0|ee)){for(ue=0|e[Oe>>2],ee=Te,pe=0;pe+=+S[ue+(ee<<2)>>2],(0|(ee=ee+1|0))<(0|le););for(S[Pe+(xe<<5)+4>>2]=pe,ue=0|e[Ye>>2],pe=0,ee=Te;pe+=+S[ue+(ee<<2)>>2],(0|(ee=ee+1|0))<(0|le););for(S[Pe+(xe<<5)+20>>2]=pe,ue=0|e[qe>>2],ee=Te,pe=0;pe+=+S[ue+(ee<<2)>>2],(0|(ee=ee+1|0))<(0|le););for(S[Pe+(xe<<5)+12>>2]=pe,ue=0|e[ke>>2],ee=Te,pe=0;pe+=+S[ue+(ee<<2)>>2],(0|(ee=ee+1|0))<(0|le););for(S[Pe+(xe<<5)+16>>2]=pe,ue=0|e[G>>2],ee=Te,pe=0;pe+=+S[ue+(ee<<2)>>2],(0|(ee=ee+1|0))<(0|le););}else S[Pe+(xe<<5)+4>>2]=0,S[Pe+(xe<<5)+20>>2]=0,S[Pe+(xe<<5)+12>>2]=0,pe=S[Pe+(xe<<5)+16>>2]=0;S[Pe+(xe<<5)+8>>2]=pe}if(Te=(0|e[We+(xe<<2)>>2])+Te|0,(0|(xe=xe+1|0))==(0|Ze))break;mt=mt+4|0}}(t),v=(a=0|e[(Y=t+204|0)>>2])+((ge=0|e[(te=t+200|0)>>2])<<4)|0,X=0|e[_e>>2],u=0|e[ce>>2],f=0|e[h>>2],0<(0|ge)){for(I=0|e[t+252>>2],A=0|e[t+248>>2],_=I;;){do if(0|e[a+8>>2]){if((0|(ge=0|e[a>>2]))!=-1&&(0|e[u+(ge<<2)>>2])==0){d=0;break}if((0|(ge=0|e[a+4>>2]))!=-1&&(0|e[f+(ge<<2)>>2])==0){d=0;break}d=(0|e[X+(36*(0|e[_>>2])|0)+32>>2])==0}else d=0;while(0);if(e[A>>2]=1&d,v>>>0<=(a=a+16|0)>>>0)break;A=A+4|0,_=_+4|0}if(z=0|e[te>>2],a=0|e[me>>2],E=0|e[a+844>>2],P=0|e[a+988>>2],0<(0|z))for(F=t+212|0,ne=t+232|0,U=t+224|0,V=t+228|0,se=t+216|0,L=a+984|0,H=a+976|0,w=a+980|0,v=_=0;;){if(A=0|e[I>>2],((0|e[(a=X+(36*A|0)+24|0)>>2])!=0||0|e[X+(36*A|0)+28>>2])&&(ye=166),(0|ye)==166&&(hr=X+(36*A|(ye=0))+8|0,e[(0|e[F>>2])+(_<<2)>>2]=e[hr>>2],0|e[a>>2])&&(v0=0|e[E+(_<<2)>>2],M0=(w0=0|e[X+(36*A|0)+16>>2])+((ge=0|e[hr>>2])<<2)|0,0<(0|ge)))for(a=(0|e[V>>2])+(v<<2)|0,d=w0,u=(0|e[U>>2])+(v<<2)|0,f=(0|e[ne>>2])+(v<<2)|0;ge=(0|e[d>>2])+v0|0,e[f>>2]=P+(e[(0|e[L>>2])+(ge<<2)>>2]<<2),e[u>>2]=e[(0|e[H>>2])+(ge<<2)>>2],e[a>>2]=e[(0|e[w>>2])+(ge<<2)>>2],!(M0>>>0<=(d=d+4|0)>>>0);)a=a+4|0,u=u+4|0,f=f+4|0;if(0|e[X+(36*A|0)+28>>2]&&(C0=(x0=0|e[X+(36*A|0)+20>>2])+((ge=0|e[X+(36*A|0)+8>>2])<<2)|0,0<(0|ge)))for(a=(0|e[se>>2])+(v<<2)|0,d=x0;e[a>>2]=e[d>>2],!(C0>>>0<=(d=d+4|0)>>>0);)a=a+4|0;if((0|(_=_+1|0))==(0|z))break;I=I+4|0,v=(0|e[X+(36*A|0)+4>>2])+v|0}}if(function(G){var We,Ye,Je,Oe,qe,ke,ue,ee,le,pe,xe,Te,mt,Pe=0,Ze=0,Be=0,ut=0,ot=0,Ke=0,Tt=0,vt=0,pt=0,ei=0,js=0|e[204+(G|=0)>>2],P0=0|e[G+200>>2],Tt=0|e[G+248>>2];if(0<(0|(ut=0|e[G+220>>2]))){for(Pe=0|e[G+224>>2],ot=0|e[G+216>>2],Ze=0|e[G+236>>2],Be=0;S[Ze+(Be<<2)>>2]=+S[Pe+(Be<<2)>>2]*+S[ot+(Be<<2)>>2],(0|(Be=Be+1|0))!=(0|ut););for(Pe=0|e[G+228>>2],Ze=0|e[G+240>>2],Be=0;S[Ze+(Be<<2)>>2]=+S[Pe+(Be<<2)>>2]*+S[ot+(Be<<2)>>2],(0|(Be=Be+1|0))!=(0|ut););}if(!((0|P0)<=0))for(qe=0|e[G+208>>2],le=G+212|0,ue=G+276|0,xe=G+236|0,ke=G+268|0,ee=G+272|0,pe=G+240|0,Te=G+232|0,mt=G+216|0,Oe=G+244|0,ei=pt=0;;){if(0|e[Tt>>2]){if(Je=(Be=0|e[(0|e[le>>2])+(pt<<2)>>2])+ei|0,Be=0<(0|Be)){for(Pe=0|e[xe>>2],Ze=ei,Ke=0;Ke+=+S[Pe+(Ze<<2)>>2],(0|(Ze=Ze+1|0))<(0|Je););for(S[(0|e[ue>>2])+(pt<<2)>>2]=Ke,Pe=0|e[pe>>2],Ke=0,Ze=ei;Ke+=+S[Pe+(Ze<<2)>>2],(0|(Ze=Ze+1|0))<(0|Je););}else Ke=S[(0|e[ue>>2])+(pt<<2)>>2]=0;if(e[(0|e[ke>>2])+(pt<<2)>>2]=~~(Ke+.0010000000474974513),Ye=(vt=0|e[js+(pt<<4)+12>>2])<<1,We=0|e[(0|e[ee>>2])+(pt<<2)>>2],0<(0|vt)&&(Ct(0|We,0,(1<(0|Ye)?Ye:1)<<2|0),Be)){ut=0|e[Te>>2],ot=0|e[mt>>2],G=0|e[Oe>>2],vt=ei;do{for(Pe=0|e[ut+(vt<<2)>>2],Ze=ot+(vt<<2)|0,Be=0;S[G+(Be<<2)>>2]=+S[Pe+(Be<<2)>>2]*+S[Ze>>2],(0|(Be=Be+1|0))<(0|Ye););for(Pe=0;S[(Be=We+(Pe<<2)|0)>>2]=+S[G+(Pe<<2)>>2]+ +S[Be>>2],(0|(Pe=Pe+1|0))<(0|Ye););vt=vt+1|0}while((0|vt)<(0|Je))}}if(ei=(0|e[qe+(pt<<2)>>2])+ei|0,(0|(pt=pt+1|0))==(0|P0))break;Tt=Tt+4|0}}(t),function(G){var We,Ye,Je,Oe,qe,ke,ue=0,ee=0,le=0,pe=0,xe=0,Te=0,mt=0,Pe=0,Ze=0,Be=0,ut=0,ot=0,ue=0|e[(G|=0)>>2],Ke=0|e[G+316>>2],Tt=0|e[ue+1072>>2];if(!((0|(ke=0|e[G+340>>2]))<=0))for(Je=G+352|0,Oe=G+364|0,qe=G+356|0,Ye=ue+1104|0,le=0|e[G+372>>2],xe=pe=0;;){if(We=0|e[le>>2],((0|e[(ue=Ke+(36*We|0)+24|0)>>2])!=0||0|e[Ke+(36*We|0)+28>>2])&&(ot=6),(0|ot)==6&&(Ze=Ke+(36*We|(ot=0))+8|0,e[(0|e[Je>>2])+(pe<<2)>>2]=e[Ze>>2],0|e[ue>>2])&&(Te=0|e[Tt+(pe<<2)>>2],Be=(mt=0|e[Ke+(36*We|0)+16>>2])+((ee=0|e[Ze>>2])<<2)|0,0<(0|ee)))for(ue=0|e[Ye>>2],G=(0|e[Oe>>2])+(xe<<2)|0,ee=mt;e[G>>2]=e[ue+((0|e[ee>>2])+Te<<2)>>2],!(Be>>>0<=(ee=ee+4|0)>>>0);)G=G+4|0;if(0|e[Ke+(36*We|0)+28>>2]&&(ut=(Pe=0|e[Ke+(36*We|0)+20>>2])+((ee=0|e[Ke+(36*We|0)+8>>2])<<2)|0,0<(0|ee)))for(ue=(0|e[qe>>2])+(xe<<2)|0,G=Pe;e[ue>>2]=e[G>>2],!(ut>>>0<=(G=G+4|0)>>>0);)ue=ue+4|0;if((0|(pe=pe+1|0))==(0|ke))break;le=le+4|0,xe=(0|e[Ke+(36*We|0)+4>>2])+xe|0}}(t),function(G){var We,Ye,Je,Oe=0,qe=0,ke=0,ue=0,ee=0,le=0,pe=0|e[340+(G|=0)>>2];if(0<(0|(Oe=0|e[G+360>>2])))for(qe=0|e[G+364>>2],ke=0|e[G+356>>2],ue=0|e[G+368>>2],ee=0;S[ue+(ee<<2)>>2]=+S[qe+(ee<<2)>>2]*+S[ke+(ee<<2)>>2],(0|(ee=ee+1|0))!=(0|Oe););if(!((0|pe)<=0)){We=0|e[G+352>>2],Ye=0|e[G+344>>2],Je=0|e[G+348>>2],ue=G+368|0,G=ee=0;do{if(qe=(ke=0|e[We+(ee<<2)>>2])+G|0,0<(0|ke))for(Oe=0|e[ue>>2],ke=G,le=0;le+=+S[Oe+(ke<<2)>>2],(0|(ke=ke+1|0))<(0|qe););else le=0;S[Ye+(24*ee|0)+20>>2]=le,G=(0|e[Je+(ee<<2)>>2])+G|0,ee=ee+1|0}while((0|ee)!=(0|pe))}}(t),f=(a=0|e[Xe>>2])+((ge=0|e[Ce>>2])<<3)|0,E=0|e[(_=t+48|0)>>2],0<(0|ge))for(A=0|e[ce>>2],u=E,d=0|e[Me>>2];0|e[A>>2]&&(wi=+S[d>>2],S[u>>2]=wi,(0|(xi=0|e[a>>2]))!=-1)&&(S[u>>2]=wi*+S[E+(xi<<2)>>2]),!(f>>>0<=(a=a+8|0)>>>0);)A=A+4|0,u=u+4|0,d=d+4|0;if(0<(0|(f=0|e[(A=t+56|0)>>2]))){for(a=0|e[h>>2],d=0|e[c>>2],u=0;0|e[a>>2]&&A0[3&e[d+16>>2]](d,u,A),(0|(u=u+1|0))!=(0|f);)a=a+4|0,d=d+32|0;E=0|e[_>>2]}if(w=(a=0|e[Y>>2])+((ge=0|e[te>>2])<<4)|0,I=0|e[t+192>>2],A=0|e[c>>2],0<(0|ge))for(v=0|e[(_=t+248|0)>>2],u=0|e[t+276>>2],f=0|e[t+272>>2];0|e[v>>2]&&((0|(d=0|e[a>>2]))!=-1&&(S[u>>2]=+S[E+(d<<2)>>2]*+S[u>>2]),(0|(d=0|e[a+4>>2]))!=-1&&(S[u>>2]=+S[I+(d<<2)>>2]*+S[u>>2],ge=0|e[f>>2],qt[3&e[A+(d<<5)+20>>2]](0|e[A+(d<<5)+24>>2],ge,ge,0|e[a+12>>2]))),!(w>>>0<=(a=a+16|0)>>>0);)v=v+4|0,u=u+4|0,f=f+4|0;else _=t+248|0;if(Fs(t),function(G){var We,Ye,Je=0,Oe=0,qe=0,ke=0,ue=0;if(!(0|e[380+(G|=0)>>2]||(We=(Je=0|e[G+204>>2])+((ke=0|e[G+200>>2])<<4)|0,(0|ke)<=0)))for(ke=0|e[G+248>>2],G=0|e[G+272>>2];;){if(0|e[ke>>2]&&(qe=0|e[G>>2],ue=(Oe=0|e[Je+12>>2])<<1,0<(0|Oe)))for(Oe=1;S[(Ye=qe+(Oe<<2)|0)>>2]=-+S[Ye>>2],(0|(Oe=Oe+2|0))<(0|ue););if(We>>>0<=(Je=Je+16|0)>>>0)break;ke=ke+4|0,G=G+4|0}}(t),z=0|e[t+320>>2],P=(X=0|e[t+324>>2])+(28*z|0)|0,u=0|e[(Y=t+268|0)>>2],E=0|e[t+44>>2],a=0|e[ce>>2],d=0|e[_>>2],0<(0|z)){I=X;do{if(0<(0|(f=0|e[I+4>>2])))for(A=0|e[I+12>>2],v=I+20|0,w=0;ge=0|e[A+(w<<4)+4>>2],xi=(0|e[A+(w<<4)>>2])==1,e[A+(w<<4)+12>>2]=e[((0|e[(xi?a:d)+(ge<<2)>>2])==0?v:(xi?E:u)+(ge<<2)|0)>>2],(0|(w=w+1|0))!=(0|f););I=I+28|0}while(I>>>0<P>>>0);V=0|e[t+264>>2],L=t+328|0,H=t+332|0,U=t+336|0,se=0;do{if(0<(0|e[(ne=X+(28*se|0)+24|0)>>2])){for(a=0|e[L>>2],A=0;e[a+(A<<2)>>2]=-1,(0|(A=A+1|0))<(0|(f=0|e[ne>>2])););if(0<(0|f))for(a=0|e[U>>2],f=0;e[a+(f<<2)>>2]=-1,(0|(f=f+1|0))<(0|e[ne>>2]););}if(0<(0|e[(F=X+(28*se|0)+4|0)>>2])){for(P=0|e[H>>2],f=0;e[P+(f<<2)>>2]=-1,(0|(f=f+1|0))<(0|(a=0|e[F>>2])););if(0<(0|a))for(A=0|e[X+(28*se|0)+12>>2],I=X+(28*se|0)+20|0,v=0|e[U>>2],E=0;f=(0|e[A+(E<<4)+12>>2])-(0|e[I>>2])|0,a=(0|(a=0|e[(w=v+(f<<2)|0)>>2]))==-1?(0|e[L>>2])+(f<<2)|0:P+(a<<2)|0,e[a>>2]=E,(0|(E=(e[w>>2]=E)+1|0))<(0|e[F>>2]););}if(0<(0|(a=0|e[ne>>2]))){E=0|e[L>>2],P=X+(28*se|0)+12|0,f=(w=0)|e[X+(28*se|0)+8>>2];do{if((0|(A=0|e[E+(w<<2)>>2]))!=-1){for(v=0|e[P>>2],I=0|e[H>>2];f=(a=(0|e[v+(A<<4)>>2])==1?(a=0|e[v+(A<<4)+8>>2],e[X+(28*a|0)+8>>2]=f,0|e[X+(28*a|0)>>2]):(e[V+(e[v+(A<<4)+4>>2]<<2)>>2]=f,1))+f|0,!((0|(A=0|e[I+((ge=A)<<2)>>2]))<=(0|ge)|(0|A)==-1););a=0|e[ne>>2]}w=w+1|0}while((0|w)<(0|a))}se=se+1|0}while((0|se)!=(0|z))}if(P=0|e[te>>2],0|e[(F=t+376|0)>>2]){if(((e[Kt>>2]=0)|P)<=0)return e[F>>2]=0,x=Qt,0;for(A=t+260|0,f=t+276|0,u=0;a=(0|e[d+(u<<2)>>2])!=0&&+S[(0|e[f>>2])+(u<<2)>>2]!=0?63:62,B[(0|e[A>>2])+u>>0]=a,(0|(a=u+1|0))!=(0|P);)d=0|e[_>>2],u=a;return e[F>>2]=0,x=Qt,0}if(0|e[Kt>>2]){if(((e[Kt>>2]=0)|P)<=0)return e[F>>2]=0,x=Qt,0;for(v=t+260|0,A=t+276|0,w=t+288|0,I=t+284|0,E=t+264|0,f=t+280|0,a=0;Kt=(0|e[d+(a<<2)>>2])==0,t=(wi=+S[(0|e[A>>2])+(a<<2)>>2])!=0&(1^Kt)&1,ge=(0|e[v>>2])+a|0,t=(1&B[ge>>0])==t<<24>>24?t:2|t,t=wi!=+S[(0|e[w>>2])+(a<<2)>>2]?4|t:t,t=(0|e[u+(a<<2)>>2])==(0|e[(0|e[I>>2])+(a<<2)>>2])?t:8|t,t=(0|e[(0|e[E>>2])+(a<<2)>>2])==(0|e[(0|e[f>>2])+(a<<2)>>2])?t:16|t,B[ge>>0]=Kt?t:32|t,(0|(a=a+1|0))!=(0|P);)d=0|e[_>>2],u=0|e[Y>>2];return e[F>>2]=0,x=Qt,0}if((0|P)<=0)return e[F>>2]=0,x=Qt,0;for(f=t+260|0,u=t+276|0,a=0;(0|e[d+(a<<2)>>2])!=0&&+S[(0|e[u>>2])+(a<<2)>>2]!=0?(ge=(0|e[f>>2])+a|0,B[ge>>0]=1|B[ge>>0]):(ge=(0|e[f>>2])+a|0,B[ge>>0]=-2&B[ge>>0]),(0|(a=a+1|0))!=(0|P);)d=0|e[_>>2];e[F>>2]=0,x=Qt}function e0(t,r,n){Rs(t|=0,r|=0,n|=0)}function Ls(t,r,n,g,h,c){t|=0,r=+r,n|=0,g|=0,h|=0,c|=0;var a,d,u=0,f=0,A=0,_=0,v=0,I=0,w=0,E=0,P=0,F=0,M=0,V=0,L=0,U=0,H=0,ne=0,se=0,z=0,K=0,X=0,Y=x;x=x+560|0,_=Y+32|0,z=12+(A=(K=X=Y)+540|0)|(e[(M=Y+536|0)>>2]=0),s0(r),d=(0|(u=0|nt()))<0?(s0(r=-r),u=0|nt(),se=1,2349):(se=(2049&h|0)!=0&1,(2048&h|0)==0?(1&h|0)==0?2350:2355:2352);do if(!0&(2146435072&u|0)==2146435072)X=(32&c|0)!=0,at(t,32,n,u=se+3|0,-65537&h),rt(t,d,se),rt(t,r!=r|!1?X?2376:2380:X?2368:2372,3),at(t,32,n,u,8192^h);else{if((u=(E=2*+n0(r,M))!=0)&&(e[M>>2]=(0|e[M>>2])-1),(0|(L=32|c))==97){P=(0|(I=32&c))==0?d:9+d|0,w=2|se,u=12-g|0;do{if(!(11<g>>>0|(0|u)==0)){for(r=8;r*=16,(0|(u=u+-1|0))!=0;);if((0|B[P>>0])==45){r=-(r+(-E-r));break}r=E+r-r;break}r=E}while(0);for((0|(u=0|ai(u=(0|(f=0|e[M>>2]))<0?0-f|0:f,((0|u)<0)<<31>>31,z)))==(0|z)&&(B[(u=A+11|0)>>0]=48),B[u+-1>>0]=43+(f>>31&2),B[(v=u+-2|0)>>0]=c+15,f=(0|g)<1,A=(8&h|0)==0,u=X;se=~~r,_=u+1|0,B[u>>0]=I|ze[480+se>>0],r=16*(r-(0|se)),(_-K|0)!=1||A&f&r==0||(B[_>>0]=46,_=u+2|0),r!=0;)u=_;at(t,32,n,z=(u=(0|g)!=0&&(-2-K+_|0)<(0|g)?g+2+(f=z)-(A=v)|0:(f=z)-K-(A=v)+_|0)+w|0,h),rt(t,P,w),at(t,48,n,z,65536^h),rt(t,X,K=_-K|0),at(t,48,u-(K+(X=f-A|0))|0,0,0),rt(t,v,X),at(t,32,n,z,8192^h),u=z;break}for(f=(0|g)<0?6:g,r=u?(A=(0|e[M>>2])-28|0,e[M>>2]=A,268435456*E):(A=0|e[M>>2],E),_=a=(0|A)<0?_:_+288|0;H=~~r>>>0,e[_>>2]=H,_=_+4|0,(r=1e9*(r-(H>>>0)))!=0;);if(H=a,0<(0|A)){u=a;do{if(I=(0|A)<29?A:29,u>>>0<=(A=_+-4|0)>>>0){for(v=0;F=0|vi(0|(F=0|m0(0|e[A>>2],0,0|I)),0|nt(),0|v,0),U=0|vi(0|F,0|(V=0|nt()),0|(U=0|lr(0|(v=0|ur(0|F,0|V,1e9,0)),0|nt(),-1e9,-1)),0|nt()),nt(),e[A>>2]=U,u>>>0<=(A=A+-4|0)>>>0;);v&&(e[(u=u+-4|0)>>2]=v)}e:do if(u>>>0<_>>>0)for(;;){if(0|e[(A=_+-4|0)>>2])break e;if(!(u>>>0<A>>>0)){_=A;break}_=A}while(0);A=(0|e[M>>2])-I|0,e[M>>2]=A}while(0<(0|A))}else u=a;if((0|A)<0){g=1+((f+25|0)/9|0)|0,F=(0|L)==102;do{if(P=(0|(P=0-A|0))<9?P:9,u>>>0<_>>>0){for(I=(1<<P)-1|0,v=P?1e9>>>P:1e9,w=0,A=u;U=0|e[A>>2],e[A>>2]=(P?U>>>P:U)+w,w=0|et(U&I,v),(A=A+4|0)>>>0<_>>>0;);u=(0|e[u>>2])==0?u+4|0:u,w&&(e[_>>2]=w,_=_+4|0)}else u=(0|e[u>>2])==0?u+4|0:u;_=(0|g)<((U=_-(A=F?a:u)|0)>>2|0)?A+(g<<2)|0:_,A=(0|e[M>>2])+P|0,e[M>>2]=A}while((0|A)<0);F=_}else F=_;if(u>>>0<F>>>0){if(A=9*((A=H-u|0)>>2)|0,10<=(v=0|e[u>>2])>>>0)for(_=10;A=A+1|0,(_=10*_|0)>>>0<=v>>>0;);}else A=0;if((0|(_=f-((0|L)==102?0:A)+(((V=(0|f)!=0)&(M=(0|L)==103))<<31>>31)|0))<((9*((U=F-H|0)>>2)|0)-9|0)){if(g=a+4+((_=(0|(U=_+9216|0))/9|0)-1024<<2)|0,(0|(_=U+(0|et(_,-9))|0))<8)for(v=10;v=10*v|0,(0|_)<7;)_=_+1|0;else v=10;if((w=(g+4|0)==(0|F))&(0|(I=(I=0|e[g>>2])-(P=0|et(_=(I>>>0)/(v>>>0)|0,v))|0))==0)_=g;else if(E=(1&_|0)==0?9007199254740992:9007199254740994,r=I>>>0<(U=v>>>1)>>>0?.5:w&(0|I)==(0|U)?1:1.5,se&&(E=(U=(0|B[d>>0])==45)?-E:E,r=U?-r:r),e[g>>2]=P,E+r!=E){if(U=P+v|0,999999999<(e[g>>2]=U)>>>0)for(A=g;(_=A+-4|0)>>>(e[A>>2]=0)<u>>>0&&(e[(u=u+-4|0)>>2]=0),U=1+(0|e[_>>2])|0,999999999<(e[_>>2]=U)>>>0;)A=_;else _=g;if(A=9*((A=H-u|0)>>2)|0,10<=(I=0|e[u>>2])>>>0)for(v=10;A=A+1|0,(v=10*v|0)>>>0<=I>>>0;);}else _=g;U=u,u=(L=_+4|0)>>>0<F>>>0?L:F}else U=u,u=F;P=0-A|0;e:do if(U>>>0<u>>>0)for(;;){if(0|e[(_=u+-4|0)>>2]){F=1,L=u;break e}if(!(U>>>0<_>>>0)){F=0,L=_;break}u=_}else F=0,L=u;while(0);do if(M){if(v=(0|A)<(0|(u=f+(1&(1^V))|0))&-5<(0|A)?(f=u+-1-A|0,c+-1|0):(f=u+-1|0,c+-2|0),!(8&h)){if(F&&(0|(ne=0|e[L+-4>>2]))!=0)if((ne>>>0)%10|0)_=0;else for(u=10,_=0;_=_+1|0,!((ne>>>0)%((u=10*u|0)>>>0)|0););else _=9;if(u=(9*((u=L-H|0)>>2)|0)-9|0,(32|v)==102){f=(0|f)<(0|(c=0<(0|(c=u-_|0))?c:0))?f:c;break}f=(0|f)<(0|(c=0<(0|(c=u+A-_|0))?c:0))?f:c;break}}else v=c;while(0);if(I=(g=(0|f)!=0)?1:h>>>3&1,w=(32|v)==102)u=(V=0)<(0|A)?A:0;else{if(((_=z)-(u=0|ai(u=(0|A)<0?P:A,((0|u)<0)<<31>>31,z))|0)<2)for(;B[(u=u+-1|0)>>0]=48,(_-u|0)<2;);B[u+-1>>0]=43+(A>>31&2),B[(u=u+-2|0)>>0]=v,u=_-(V=u)|0}if(at(t,32,n,u=se+1+f+I+u|0,h),rt(t,d,se),at(t,48,n,u,65536^h),w){w=P=X+9|0,v=X+8|0,_=I=a>>>0<U>>>0?a:U;do{if(A=0|ai(0|e[_>>2],0,P),(0|_)==(0|I))(0|A)==(0|P)&&(B[v>>0]=48,A=v);else if(X>>>0<A>>>0)for(Ct(0|X,48,A-K|0);X>>>0<(A=A+-1|0)>>>0;);rt(t,A,w-A|0),_=_+4|0}while(_>>>0<=a>>>0);if((8&h|0)==0&(1^g)||rt(t,2384,1),_>>>0<L>>>0&0<(0|f))for(;;){if(X>>>0<(A=0|ai(0|e[_>>2],0,P))>>>0)for(Ct(0|X,48,A-K|0);X>>>0<(A=A+-1|0)>>>0;);if(rt(t,A,(0|f)<9?f:9),A=f+-9|0,!((_=_+4|0)>>>0<L>>>0&9<(0|f))){f=A;break}f=A}at(t,48,f+9|0,9,0)}else{if(U>>>0<(g=F?L:U+4|0)>>>0&-1<(0|f)){M=(8&h|0)==0,F=P=X+9|0,v=0-K|0,w=X+8|0,I=U;do{(0|(A=0|ai(0|e[I>>2],0,P)))==(0|P)&&(B[w>>0]=48,A=w);do if((0|I)==(0|U)){if(_=A+1|0,rt(t,A,1),M&(0|f)<1){A=_;break}rt(t,2384,1),A=_}else{if(A>>>0<=X>>>0)break;for(Ct(0|X,48,A+v|0);X>>>0<(A=A+-1|0)>>>0;);}while(0);rt(t,A,(0|(K=F-A|0))<(0|f)?K:f),f=f-K|0,I=I+4|0}while(I>>>0<g>>>0&-1<(0|f))}at(t,48,f+18|0,18,0),rt(t,V,z-V|0)}at(t,32,n,u,8192^h)}while(0);return x=Y,0|((0|u)<(0|n)?n:u)}function Rs(t,r,n){t|=0,r|=0,n|=0;var g,h,c,a,d,u,f,A,_=0,v=0,I=x;for(x=x+224|0,d=I+208|0,f=I+80|0,v=40+(_=A=(u=I)+160|0)|0;(0|(_=_+4|(e[_>>2]=0)))<(0|v););e[d>>2]=e[n>>2],0<=(0|sr(0,r,d,f,A))&&(a=32&(n=0|e[t>>2]),(0|B[t+74>>0])<1&&(e[t>>2]=-33&n),0|e[(v=t+48|0)>>2]?sr(t,r,d,f,A):(n=0|e[(_=t+44|0)>>2],e[_>>2]=u,e[(g=t+28|0)>>2]=u,e[(c=t+20|0)>>2]=u,e[v>>2]=80,e[(h=t+16|0)>>2]=u+80,sr(t,r,d,f,A),0|n&&(ji[3&e[t+36>>2]](t,0,0),e[_>>2]=n,e[v>>2]=0,e[h>>2]=0,e[g>>2]=0,e[c>>2]=0)),e[t>>2]=e[t>>2]|a),x=I}function sr(t,r,n,g,h){t|=0,r|=0,n|=0,g|=0,h|=0;var c,a,d,u,f,A,_,v,I,w=0,E=0,P=0,F=0,M=0,V=0,L=0,U=0,H=0,ne=0,se=0,z=0,K=0,X=x;x=x+64|0,A=X+40|0,I=(a=X)+48|0,_=X+60|0,e[(v=X+56|0)>>2]=r,f=(0|t)!=0,u=c=a+40|0,a=a+39|0,d=4+I|0,F=w=r=0;e:for(;;){do{do if(-1<(0|r)){if((2147483647-r|0)<(0|w)){e[861]=61,r=-1;break}r=w+r|0;break}while(0);if(L=0|e[v>>2],!((w=0|B[L>>0])<<24>>24)){z=91;break e}E=L;t:for(;;){switch(w<<24>>24){case 37:z=10;break t;case 0:w=E;break t}se=E+1|0,e[v>>2]=se,w=0|B[se>>0],E=se}t:do if((0|z)==10){z=0,w=P=E;do{if((0|B[P+1>>0])!=37)break t;w=w+1|0,P=P+2|0,e[v>>2]=P}while((0|B[P>>0])==37)}while(0);w=w-L|0,f&&rt(t,L,w)}while((0|w)!=0);if(P=0|e[v>>2],V=0|yi(w=0|B[P+1>>0])?(E=(V=(0|B[P+2>>0])==36)?3:1,H=V?w+-48|0:-1,V?1:F):(H=-(E=1),F),E=P+E|0,e[v>>2]=E,31<(P=((w=0|B[E>>0])<<24>>24)-32|0)>>>0|(1<<P&75913|0)==0)M=0;else for(w=0;;){if(F=1<<P|w,E=E+1|0,e[v>>2]=E,31<(P=((w=0|B[E>>0])<<24>>24)-32|0)>>>0|(1<<P&75913|0)==0){M=F;break}w=F}if(w<<24>>24==42){if((0|yi(w=0|B[(P=E+1|0)>>0]))!=0&&(0|B[E+2>>0])==36)e[h+(w+-48<<2)>>2]=10,F=1,w=E+3|0,E=0|e[g+((0|B[P>>0])-48<<3)>>2];else{if(0|V){r=-1;break}f?(F=3+(0|e[n>>2])&-4,E=0|e[F>>2],e[n>>2]=F+4,F=0,w=P):(w=P,E=F=0)}P=e[v>>2]=w,U=(ne=(0|E)<0)?8192|M:M,se=F,ne=ne?0-E|0:E}else{if((0|(w=0|t0(v)))<0){r=-1;break}P=0|e[v>>2],U=M,se=V,ne=w}do if((0|B[P>>0])==46){if((0|B[(w=P+1|0)>>0])!=42){e[v>>2]=w,M=0|t0(v),w=0|e[v>>2];break}if(0|yi(E=0|B[(w=P+2|0)>>0])&&(0|B[P+3>>0])==36){e[h+(E+-48<<2)>>2]=10,M=0|e[g+((0|B[w>>0])-48<<3)>>2],w=P+4|0,e[v>>2]=w;break}if(0|se){r=-1;break e}f?(V=3+(0|e[n>>2])&-4,E=0|e[V>>2],e[n>>2]=V+4):E=0,e[v>>2]=w,M=E}else w=P,M=-1;while(0);for(V=0;;){if(57<((0|B[w>>0])-65|0)>>>0){r=-1;break e}if(E=w+1|0,e[v>>2]=E,!(((F=255&(P=0|B[(0|B[w>>0])-65+(16+(58*V|0))>>0]))-1|0)>>>0<8))break;w=E,V=F}if(!(P<<24>>24)){r=-1;break}E=-1<(0|H);do if(P<<24>>24==19){if(E){r=-1;break e}z=52}else{if(E){e[h+(H<<2)>>2]=F,H=0|e[4+(F=g+(H<<3)|0)>>2],e[(z=A)>>2]=e[F>>2],e[z+4>>2]=H,z=52;break}if(!f){r=0;break e}i0(A,F,n),z=53}while(0);(0|z)==52&&(z=0,f?z=53:w=0);t:do if((0|z)==53){P=(z=0)!=(0|V)&(15&(P=0|B[w>>0])|0)==3?-33&P:P,w=-65537&U,H=(8192&U|0)==0?U:w;i:do switch(0|P){case 110:switch((255&V)<<24>>24){case 0:case 1:e[e[A>>2]>>2]=r,w=0;break t;case 2:w=0|e[A>>2],e[w>>2]=r,e[w+4>>2]=((0|r)<0)<<31>>31,w=0;break t;case 3:Le[e[A>>2]>>1]=r,w=0;break t;case 4:B[e[A>>2]>>0]=r,w=0;break t;case 6:e[e[A>>2]>>2]=r,w=0;break t;case 7:w=0|e[A>>2],e[w>>2]=r,e[w+4>>2]=((0|r)<0)<<31>>31,w=0;break t;default:w=0;break t}case 112:w=8|H,E=8<M>>>0?M:8,F=120,z=65;break;case 88:case 120:w=H,E=M,F=P,z=65;break;case 111:M=(8&(w=H)|0)==0|(0|(P=u-(V=0|function(Y,te,oe){if(oe|=0,!((0|(Y|=0))==0&(0|(te|=0))==0))for(;B[(oe=oe+-1|0)>>0]=7&Y|48,!((0|(Y=0|Ni(0|Y,0|te,3)))==0&(0|(te=0|nt()))==0););return 0|oe}(L=0|e[(U=A)>>2],U=0|e[U+4>>2],c))|0))<(0|M)?M:P+1|0,P=0,E=2332,z=71;break;case 105:case 100:if(w=0|e[(E=A)>>2],(0|(E=0|e[E+4>>2]))<0){w=0|Gi(0,0,0|w,0|E),E=0|nt(),e[(P=A)>>2]=w,e[P+4>>2]=E,P=1,F=2332,z=70;break i}P=(2049&H|0)!=0&1,F=(2048&H|0)==0?(1&H|0)==0?2332:2334:2333,z=70;break i;case 117:w=0|e[(E=A)>>2],E=0|e[E+4>>2],P=0,F=2332,z=70;break;case 99:B[a>>0]=e[A>>2],L=a,V=w,F=1,P=0,E=2332,w=u;break;case 115:L=U=(0|(U=0|e[A>>2]))==0?2342:U,V=w,F=(K=(0|(H=0|function(Y,te){Y|=0;var oe=0,Ve=0,oe=(0|(te|=0))!=0;r:do if(oe&(3&Y|0)!=0)for(;;){if(!(0|B[Y>>0]))break r;if(!((oe=(0|(te=te+-1|0))!=0)&(3&(Y=Y+1|0)|0)!=0)){Ve=5;break}}else Ve=5;while(0);r:do if((0|Ve)==5){do if(oe){if(!(0|B[Y>>0])){if(te)break r;break}s:do if(3<te>>>0)for(;;){if((-2139062144&(oe=0|e[Y>>2])^-2139062144)&oe+-16843009|0)break s;if(Y=Y+4|0,(te=te+-4|0)>>>0<=3){Ve=11;break}}else Ve=11;while(0);if((0|Ve)==11&&!te)break;for(;;){if(!(0|B[Y>>0]))break r;if(!(te=te+-1|0))break;Y=Y+1|0}}while(0);Y=0}while(0);return 0|Y}(U,M)))==0)?M:H-U|0,P=0,E=2332,w=K?U+M|0:H;break;case 67:e[I>>2]=e[A>>2],e[d>>2]=0,P=e[A>>2]=I,M=-1,z=78;break;case 83:if(M){P=0|e[A>>2],z=78;break i}at(t,32,ne,0,H),w=0,z=88;break i;case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:w=0|Ls(t,+Fe[A>>3],ne,M,H,P);break t;default:V=H,F=M,P=0,E=2332,w=u}while(0);i:do if((0|z)==65)V=0|Bs(L=0|e[(U=A)>>2],U=0|e[U+4>>2],c,32&F),M=E,P=(K=(8&w|0)==0|(0|L)==0&(0|U)==0)?0:2,E=K?2332:2332+(F>>>4)|0,z=71;else if((0|z)==70)V=0|ai(L=w,U=E,c),w=H,E=F,z=71;else if((0|z)==78){for(w=z=0,V=P;E=0|e[V>>2];){if((F=(0|(E=0|r0(_,E)))<0)|(M-w|0)>>>0<E>>>0){z=82;break}if(!((w=E+w|0)>>>0<M>>>0))break;V=V+4|0}if((0|z)==82&&(z=0,F)){r=-1;break e}if(at(t,32,ne,w,H),w)for(F=0;;){if(!(E=0|e[P>>2])){z=88;break i}if((0|w)<(0|(F=(E=0|r0(_,E))+F|0))){z=88;break i}if(rt(t,_,E),w>>>0<=F>>>0){z=88;break}P=P+4|0}else w=0,z=88}while(0);if((0|z)==71)K=(z=0)!=(0|M)|(F=(0|L)!=0|(0|U)!=0),F=u-V+(1&(1^F))|0,L=K?V:c,V=-1<(0|M)?-65537&w:w,F=K?(0|F)<(0|M)?M:F:0,w=u;else if((0|z)==88){z=0,at(t,32,ne,w,8192^H),w=(0|w)<(0|ne)?ne:w;break}at(t,32,w=(0|ne)<(0|(K=(U=(0|F)<(0|(H=w-L|0))?H:F)+P|0))?K:ne,K,V),rt(t,E,P),at(t,48,w,K,65536^V),at(t,48,U,H,0),rt(t,L,H),at(t,32,w,K,8192^V)}while(0);F=se}e:do if((0|z)==91&&!t)if(F){for(r=1;w=0|e[h+(r<<2)>>2];)if(i0(g+(r<<3)|0,w,n),10<=(r=r+1|0)>>>0){r=1;break e}for(w=0;;){if(r=r+1|0,0|w){r=-1;break e}if(10<=r>>>0){r=1;break e}w=0|e[h+(r<<2)>>2]}}else r=0;while(0);return x=X,0|r}function rt(t,r,n){r|=0,n|=0,32&e[(t|=0)>>2]||Vs(r,n,t)}function yi(t){return((t|=0)-48|0)>>>0<10|0}function t0(t){var r=0,n=0,g=0,n=0|e[(t|=0)>>2];if(0|yi((r=0|B[n>>0])<<24>>24))for(g=r,r=0;r=(10*r|0)-48+(g<<24>>24)|0,n=n+1|0,e[t>>2]=n,(0|yi((g=0|B[n>>0])<<24>>24))!=0;);else r=0;return 0|r}function i0(t,r,n){t|=0,r|=0,n|=0;var g,h=0,c=0;e:do if(r>>>0<=20)switch(0|r){case 9:h=3+(0|e[n>>2])&-4,r=0|e[h>>2],e[n>>2]=h+4,e[t>>2]=r;break e;case 10:h=3+(0|e[n>>2])&-4,r=0|e[h>>2],e[n>>2]=h+4,e[(h=t)>>2]=r,e[h+4>>2]=((0|r)<0)<<31>>31;break e;case 11:h=3+(0|e[n>>2])&-4,r=0|e[h>>2],e[n>>2]=h+4,e[(h=t)>>2]=r,e[h+4>>2]=0;break e;case 12:h=7+(0|e[n>>2])&-8,c=0|e[(r=h)>>2],r=0|e[r+4>>2],e[n>>2]=h+8,e[(h=t)>>2]=c,e[h+4>>2]=r;break e;case 13:c=3+(0|e[n>>2])&-4,h=0|e[c>>2],e[n>>2]=c+4,h=(65535&h)<<16>>16,e[(c=t)>>2]=h,e[c+4>>2]=((0|h)<0)<<31>>31;break e;case 14:c=3+(0|e[n>>2])&-4,h=0|e[c>>2],e[n>>2]=c+4,e[(c=t)>>2]=65535&h,e[c+4>>2]=0;break e;case 15:c=3+(0|e[n>>2])&-4,h=0|e[c>>2],e[n>>2]=c+4,h=(255&h)<<24>>24,e[(c=t)>>2]=h,e[c+4>>2]=((0|h)<0)<<31>>31;break e;case 16:c=3+(0|e[n>>2])&-4,h=0|e[c>>2],e[n>>2]=c+4,e[(c=t)>>2]=255&h,e[c+4>>2]=0;break e;case 17:c=7+(0|e[n>>2])&-8,g=+Fe[c>>3],e[n>>2]=c+8,Fe[t>>3]=g;break e;case 18:(function(a,d){a|=0;var u=7+(0|e[(d|=0)>>2])&-8,f=+Fe[u>>3];e[d>>2]=8+u,Fe[a>>3]=f})(t,n);break e;default:break e}while(0)}function Bs(t,r,n,g){if(n|=0,g|=0,!((0|(t|=0))==0&(0|(r|=0))==0))for(;B[(n=n+-1|0)>>0]=0|ze[480+(15&t)>>0]|g,!((0|(t=0|Ni(0|t,0|r,4)))==0&(0|(r=0|nt()))==0););return 0|n}function ai(t,r,n){n|=0;var g,h=0,c=0;if(0<(r|=0)>>>0|(0|r)==0&4294967295<(t|=0)>>>0)for(;c=0|vi(0|(g=t),0|(h=r),0|(c=0|lr(0|(t=0|ur(0|t,0|r,10,0)),0|(r=0|nt()),-10,-1)),0|nt()),nt(),B[(n=n+-1|0)>>0]=255&c|48,9<h>>>0|(0|h)==9&4294967295<g>>>0;);if(t)for(;h=255&((c=t)+(0|et(t=(t>>>0)/10|0,-10))|48),B[(n=n+-1|0)>>0]=h,10<=c>>>0;);return 0|n}function at(t,r,n,g,h){t|=0,r|=0;var c,a=x;if(x=x+256|0,c=a,(0|(g|=0))<(0|(n|=0))&(73728&(h|=0)|0)==0){if(Ct(0|c,r<<24>>24|0,0|((h=n-g|0)>>>0<256?h:256)),255<h>>>0){for(g=h;rt(t,c,256),255<(g=g+-256|0)>>>0;);h&=255}rt(t,c,h)}x=a}function r0(t,r){return r|=0,0|((t|=0)?0|Os(t,r):0)}function Os(t,r){t|=0,r|=0;do{if(t){if(r>>>0<128){B[t>>0]=r,t=1;break}if(!(0|e[872])){if((-128&r|0)==57216){B[t>>0]=r,t=1;break}e[861]=25,t=-1;break}if(r>>>0<2048){B[t>>0]=r>>>6|192,B[t+1>>0]=63&r|128,t=2;break}if(r>>>0<55296|(-8192&r|0)==57344){B[t>>0]=r>>>12|224,B[t+1>>0]=r>>>6&63|128,B[t+2>>0]=63&r|128,t=3;break}if((r+-65536|0)>>>0<1048576){B[t>>0]=r>>>18|240,B[t+1>>0]=r>>>12&63|128,B[t+2>>0]=r>>>6&63|128,B[t+3>>0]=63&r|128,t=4;break}e[861]=25,t=-1;break}t=1}while(0);return 0|t}function Vs(t,r,n){t|=0,r|=0;var g,h=0,c=0,a=0,d=0;(h=0|e[(c=16+(n|=0)|0)>>2])?a=5:0|function(u){var f=0,A=0|B[(f=74+(u|=0)|0)>>0];return B[f>>0]=255+A|A,0|(f=8&(f=0|e[u>>2])?(e[u>>2]=32|f,-1):(e[8+u>>2]=0,f=(e[4+u>>2]=0)|e[44+u>>2],e[28+u>>2]=f,e[20+u>>2]=f,e[16+u>>2]=f+(0|e[48+u>>2]),0))}(n)?h=0:(h=0|e[c>>2],a=5);e:do if((0|a)==5){if((h-(c=d=0|e[(g=n+20|0)>>2])|0)>>>0<r>>>0){h=0|ji[3&e[n+36>>2]](n,t,r);break}t:do if((0|B[n+75>>0])<0|(0|r)==0)a=c,n=0,c=r,h=t;else{for(d=r;(0|B[t+(h=d+-1|0)>>0])!=10;){if(!h){a=c,n=0,c=r,h=t;break t}d=h}if((h=0|ji[3&e[n+36>>2]](n,t,d))>>>0<d>>>0)break e;a=0|e[g>>2],c=r-(n=d)|0,h=t+d|0}while(0);Dt(0|a,0|h,0|c),e[g>>2]=(0|e[g>>2])+c,h=n+c|0}while(0);return 0|h}function s0(t){return t=+t,Fe[st>>3]=t,t=0|e[st>>2],tt(0|e[st+4>>2]),0|t}function n0(t,r){t=+t,r|=0;var n,g,h=0;switch(Fe[st>>3]=t,g=0|Ni(0|(h=0|e[st>>2]),0|(n=0|e[st+4>>2]),52),nt(),2047&g){case 0:h=t!=0?(t=+n0(18446744073709552e3*t,r),(0|e[r>>2])-64|0):0,e[r>>2]=h;break;case 2047:break;default:e[r>>2]=(2047&g)-1022,e[st>>2]=h,e[st+4>>2]=-2146435073&n|1071644672,t=+Fe[st>>3]}return+t}function a0(t){var r,n=0,g=0,h=0,n=0|B[(t|=0)>>0];e:do if(n<<24>>24)for(g=t,h=4,t=880;;){if(h=h+-1|0,!(n<<24>>24==(r=0|B[t>>0])<<24>>24&(0|h)!=0&r<<24>>24!=0))break e;if(t=t+1|0,!((n=0|B[(g=g+1|0)>>0])<<24>>24)){n=0;break}}else n=0,t=880;while(0);return(255&n)-(0|ze[t>>0])|0}function o0(t,r,n){t|=0,r|=0,n|=0;var g,h,c,a=0,d=x;x=x+144|0,Dt(0|(h=d),640,144),a=(a=-2-t|0)>>>0<256?a:256,e[h+48>>2]=a,e[(g=h+20|0)>>2]=t,c=(e[h+44>>2]=t)+a|0,e[(t=h+16|0)>>2]=c,e[h+28>>2]=c,e0(h,r,n),0|a&&(c=0|e[g>>2],B[c+(((0|c)==(0|e[t>>2]))<<31>>31)>>0]=0),x=d}function nr(t,r,n){t|=0,r|=0,n|=0;var g,h,c,a=0,d=0,u=x;x=x+240|0,e[(c=u)>>2]=t;e:do if(1<(0|r))for(d=a=t,t=1;;){if(-1<(0|Yt(a,g=(d=d+-4|0)+(0-(0|e[n+((h=r+-2|0)<<2)>>2]))|0))&&-1<(0|Yt(a,d))||(a=c+(t<<2)|0,t=t+1|0,(0|(r=-1<(0|Yt(g,d))?(d=e[a>>2]=g,r+-1|0):(e[a>>2]=d,h)))<=1))break e;a=0|e[c>>2]}else t=1;while(0);h0(c,t),x=u}function Oi(t,r){var n=0,g=0,h=4+(t|=0)|0;31<(r|=0)>>>0?(n=0|e[h>>2],e[t>>2]=n,r=r+-32|(g=e[h>>2]=0)):(n=0|e[t>>2],g=0|e[h>>2]),e[t>>2]=g<<32-r|(r?n>>>r:n),e[h>>2]=r?g>>>r:g}function Vi(t,r,n,g,h,c){t|=0,r|=0,n|=0,g|=0,h|=0,c|=0;var a,d,u,f=0,A=0,_=x;x=x+240|0,e[(d=(u=_)+232|0)>>2]=r,e[(a=4+d|0)>>2]=n,e[u>>2]=t;e:do if((0|r)!=1|(0|n)!=0&&1<=(0|Yt(f=t+(0-(0|e[c+(g<<2)>>2]))|0,t)))for(r=f,A=1,f=(0|h)==0;;){if(f&1<(0|g)){if(-1<(0|Yt(f=t+-4|0,r))){r=t,f=A,n=10;break e}if(-1<(0|Yt(f+(0-(0|e[c+(g+-2<<2)>>2]))|0,r))){r=t,f=A,n=10;break e}}if(n=A+1|0,e[u+(A<<2)>>2]=r,Oi(d,h=0|l0(d)),g=h+g|0,!((0|e[d>>2])!=1|(0|e[a>>2])!=0)){f=n,n=10;break e}if((0|Yt(f=r+(0-(0|e[c+(g<<2)>>2]))|0,0|e[u>>2]))<1){f=n,n=10;break}t=r,r=f,A=n,f=1}else n=9;while(0);(0|n)==9&&(0|h)==0&&(r=t,f=1,n=10),(0|n)==10&&(h0(u,f),nr(r,g,c)),x=_}function Ui(t,r){var n,g=0,h=0,c=4+(t|=0)|0;31<(r|=0)>>>0?(g=0|e[t>>2],e[c>>2]=g,r=r+-32|(h=e[t>>2]=0)):(g=0|e[c>>2],h=0|e[t>>2]),n=32-r|0,e[c>>2]=(n?h>>>n:h)|g<<r,e[t>>2]=h<<r}function l0(t){var r;return(r=0|u0((0|e[(t|=0)>>2])-1|0))?0|r:0|((0|(t=0|u0(0|e[t+4>>2])))==0?0:t+32|0)}function u0(t){var r=0;if(t|=0)if(1&t)r=0;else for(r=0;r=r+1|0,!(2&t);)t>>>=1;else r=32;return 0|r}function h0(t,r){t|=0;var n,g=0,h=x;if(x=x+256|0,g=h,2<=(0|(r|=0)))for(Dt(0|(e[t+(r<<2)>>2]=g),0|e[t>>2],4),g=0;n=t+(g<<2)|0,g=g+1|0,Dt(0|e[n>>2],0|e[t+(g<<2)>>2],4),e[n>>2]=4+(0|e[n>>2]),(0|g)!=(0|r););x=h}function ar(t){t|=0;var r=0,n=0,g=0,h=0,c=0,a=0,d=0,u=0,f=0,A=0,_=0,v=0,I=0,w=0,E=0,P=0,F=0,M=0,V=0,L=0,U=x;x=x+16|0,v=U;do if(t>>>0<245){if(t=(f=t>>>0<11?16:t+11&-8)>>>3,_=0|e[878],3&(n=t?_>>>t:_)|0)return t=0|e[(r=8+(h=3552+((g=(1&n^1)+t|0)<<1<<2)|0)|0)>>2],(0|(n=0|e[(c=t+8|0)>>2]))==(0|h)?e[878]=_&~(1<<g):(e[n+12>>2]=h,e[r>>2]=n),L=g<<3,e[t+4>>2]=3|L,e[(L=t+L+4|0)>>2]=1|e[L>>2],x=U,0|c;if((A=0|e[880])>>>0<f>>>0){if(0|n)return c=0|e[(r=8+(n=3552+((g=((t=(g=(d=(g=((g=n<<t&((g=2<<t)|0-g))&0-g)-1|0)>>>12&16)?g>>>d:g)>>>5&8)|d|(c=(g=t?g>>>t:g)>>>2&4)|(r=(g=c?g>>>c:g)>>>1&2)|(n=(g=r?g>>>r:g)>>>1&1))+(n?g>>>n:g)|0)<<1<<2)|0)|0)>>2],(0|(t=0|e[(d=c+8|0)>>2]))==(0|n)?(t=_&~(1<<g),e[878]=t):(e[t+12>>2]=n,e[r>>2]=t,t=_),a=(L=g<<3)-f|0,e[c+4>>2]=3|f,e[4+(h=c+f|0)>>2]=1|a,e[c+L>>2]=a,0|A&&(g=0|e[883],n=3552+((r=A>>>3)<<1<<2)|0,t=t&(r=1<<r)?0|e[(r=t=n+8|0)>>2]:(e[878]=t|r,r=n+8|0,n),e[r>>2]=g,e[t+12>>2]=g,e[g+8>>2]=t,e[g+12>>2]=n),e[880]=a,e[883]=h,x=U,0|d;if(c=0|e[879]){for(u=0|e[3816+(((g=(u=(h=(u=(c&0-c)-1|0)>>>12&16)?u>>>h:u)>>>5&8)|h|(a=(u=g?u>>>g:u)>>>2&4)|(n=(u=a?u>>>a:u)>>>1&2)|(d=(u=n?u>>>n:u)>>>1&1))+(d?u>>>d:u)<<2)>>2],d=(-8&e[u+4>>2])-f|0,n=u;(t=0|e[n+16>>2])||(t=0|e[n+20>>2]);)d=(a=(n=(-8&e[t+4>>2])-f|0)>>>0<d>>>0)?n:d,n=t,u=a?t:u;if(u>>>0<(a=u+f|0)>>>0){h=0|e[u+24>>2],r=0|e[u+12>>2];do if((0|r)==(0|u)){if(!(r=0|e[(t=u+20|0)>>2])&&!(r=0|e[(t=u+16|0)>>2])){n=0;break}for(;;)if(n=0|e[(g=r+20|0)>>2])r=n,t=g;else{if(!(n=0|e[(g=r+16|0)>>2]))break;r=n,t=g}e[t>>2]=0,n=r}else n=0|e[u+8>>2],e[n+12>>2]=r,e[r+8>>2]=n,n=r;while(0);do if(0|h){if(r=0|e[u+28>>2],(0|u)==(0|e[(t=3816+(r<<2)|0)>>2])){if(!(e[t>>2]=n)){e[879]=c&~(1<<r);break}}else if(!(e[((0|e[(L=h+16|0)>>2])==(0|u)?L:h+20|0)>>2]=n))break;e[n+24>>2]=h,0|(r=0|e[u+16>>2])&&(e[n+16>>2]=r,e[r+24>>2]=n),0|(r=0|e[u+20>>2])&&(e[n+20>>2]=r,e[r+24>>2]=n)}while(0);return d>>>0<16?(L=d+f|0,e[u+4>>2]=3|L,e[(L=u+L+4|0)>>2]=1|e[L>>2]):(e[u+4>>2]=3|f,e[a+4>>2]=1|d,e[a+d>>2]=d,0|A&&(g=0|e[883],n=3552+((r=A>>>3)<<1<<2)|0,t=(r=1<<r)&_?0|e[(r=t=n+8|0)>>2]:(e[878]=r|_,r=n+8|0,n),e[r>>2]=g,e[t+12>>2]=g,e[g+8>>2]=t,e[g+12>>2]=n),e[880]=d,e[883]=a),x=U,u+8|0}_=f}else _=f}else _=f}else if(t>>>0<=4294967231)if(f=-8&(t=t+11|0),g=0|e[879]){n=0-f|0,u=(t>>>=8)?16777215<f>>>0?31:1&((P=7+(u=14-((d=(d=520192+(u=t<<(_=(_=t+1048320|0)>>>16&8))|0)>>>16&4)|_|(P=(P=245760+(u<<=d)|0)>>>16&2))+((u<<=P)>>>15)|0)|0)?f>>>P:f)|u<<1:0,t=0|e[3816+(u<<2)>>2];e:do if(t)for(a=f<<(((h=0)|u)==31?0:25-(u>>>1)|0),d=t,t=0;;){if((c=(-8&e[d+4>>2])-f|0)>>>0<n>>>0){if(!c){n=0,t=h=d,P=65;break e}n=c,t=d}if(h=(0|(P=0|e[d+20>>2]))==0|(0|P)==(0|(d=0|e[d+16+(a>>>31<<2)>>2]))?h:P,!d){P=61;break}a<<=1}else t=h=0,P=61;while(0);if((0|P)==61){if((0|h)==0&(0|t)==0){if(!(t=((t=2<<u)|0-t)&g)){_=f;break}h=0|e[3816+(((a=(h=(d=(h=(t&0-t)-1|0)>>>12&16)?h>>>d:h)>>>5&8)|d|(u=(h=a?h>>>a:h)>>>2&4)|(_=(h=u?h>>>u:h)>>>1&2)|(t=(h=_?h>>>_:h)>>>1&1))+(t?h>>>t:h)<<2)>>2],t=0}h?P=65:(d=n,c=t)}if((0|P)==65)for(;;){if(n=(c=(_=(-8&e[h+4>>2])-f|0)>>>0<n>>>0)?_:n,c=c?h:t,!(t=(t=0|e[h+16>>2])||0|e[h+20>>2])){d=n;break}h=t,t=c}if((0|c)!=0&&d>>>0<((0|e[880])-f|0)>>>0&&c>>>0<(A=c+f|0)>>>0){a=0|e[c+24>>2],r=0|e[c+12>>2];do if((0|r)==(0|c)){if(!(r=0|e[(t=c+20|0)>>2])&&!(r=0|e[(t=c+16|0)>>2])){r=0;break}for(;;)if(n=0|e[(h=r+20|0)>>2])r=n,t=h;else{if(!(n=0|e[(h=r+16|0)>>2]))break;r=n,t=h}e[t>>2]=0}else L=0|e[c+8>>2],e[L+12>>2]=r,e[r+8>>2]=L;while(0);do if(a){if(t=0|e[c+28>>2],(0|c)==(0|e[(n=3816+(t<<2)|0)>>2])){if(!(e[n>>2]=r)){g&=~(1<<t),e[879]=g;break}}else if(!(e[((0|e[(L=a+16|0)>>2])==(0|c)?L:a+20|0)>>2]=r))break;e[r+24>>2]=a,0|(t=0|e[c+16>>2])&&(e[r+16>>2]=t,e[t+24>>2]=r),(t=0|e[c+20>>2])&&(e[r+20>>2]=t,e[t+24>>2]=r)}while(0);e:do if(d>>>0<16)L=d+f|0,e[c+4>>2]=3|L,e[(L=c+L+4|0)>>2]=1|e[L>>2];else{if(e[c+4>>2]=3|f,e[A+4>>2]=1|d,r=(e[A+d>>2]=d)>>>3,d>>>0<256){n=3552+(r<<1<<2)|0,t=(t=0|e[878])&(r=1<<r)?0|e[(r=t=n+8|0)>>2]:(e[878]=t|r,r=n+8|0,n),e[r>>2]=A,e[t+12>>2]=A,e[A+8>>2]=t,e[A+12>>2]=n;break}if(r=3816+((n=(r=d>>>8)?16777215<d>>>0?31:1&((L=7+(n=14-((M=(M=520192+(n=r<<(V=(V=r+1048320|0)>>>16&8))|0)>>>16&4)|V|(L=(L=245760+(n<<=M)|0)>>>16&2))+((n<<=L)>>>15)|0)|0)?d>>>L:d)|n<<1:0)<<2)|0,e[A+28>>2]=n,e[4+(t=A+16|0)>>2]=0,e[t>>2]=0,!(g&(t=1<<n))){e[879]=g|t,e[r>>2]=A,e[A+24>>2]=r,e[A+12>>2]=A,e[A+8>>2]=A;break}r=0|e[r>>2];t:do if((-8&e[r+4>>2]|0)!=(0|d)){for(g=d<<((0|n)==31?0:25-(n>>>1)|0);t=0|e[(n=r+16+(g>>>31<<2)|0)>>2];){if((-8&e[t+4>>2]|0)==(0|d)){r=t;break t}g<<=1,r=t}e[n>>2]=A,e[A+24>>2]=r,e[A+12>>2]=A,e[A+8>>2]=A;break e}while(0);L=0|e[(V=r+8|0)>>2],e[L+12>>2]=A,e[V>>2]=A,e[A+8>>2]=L,e[A+12>>2]=r,e[A+24>>2]=0}while(0);return x=U,c+8|0}_=f}else _=f;else _=-1;while(0);if(_>>>0<=(n=0|e[880])>>>0)return t=n-_|0,r=0|e[883],15<t>>>0?(L=r+_|0,e[883]=L,e[880]=t,e[L+4>>2]=1|t,e[r+n>>2]=t,e[r+4>>2]=3|_):(e[880]=0,e[883]=0,e[r+4>>2]=3|n,e[(L=r+n+4|0)>>2]=1|e[L>>2]),x=U,r+8|0;if(_>>>0<(a=0|e[881])>>>0)return M=a-_|0,e[881]=M,V=(L=0|e[884])+_|0,e[884]=V,e[V+4>>2]=1|M,e[L+4>>2]=3|_,x=U,L+8|0;if(d=_+48|0,(f=(c=(t=0|e[996]?0|e[998]:(e[998]=4096,e[997]=4096,e[999]=-1,e[1e3]=-1,e[1001]=0,e[989]=0,e[996]=-16&v^1431655768,4096))+(u=_+47|0)|0)&(g=0-t|0))>>>0<=_>>>0||0|(t=0|e[988])&&(v=(A=0|e[986])+f|0)>>>0<=A>>>0|t>>>0<v>>>0)return x=U,(L=0)|L;e:do if(4&e[989])r=0,P=143;else{n=0|e[884];t:do if(n){for(h=3960;!((t=0|e[h>>2])>>>0<=n>>>0&&(t+(0|e[(E=h+4|0)>>2])|0)>>>0>n>>>0);){if(!(t=0|e[h+8>>2])){P=128;break t}h=t}if((r=c-a&g)>>>0<2147483647)if((0|(t=0|Jt(r)))==((0|e[h>>2])+(0|e[E>>2])|0)){if((0|t)!=-1){a=t,c=r,P=145;break e}}else g=t,P=136;else r=0}else P=128;while(0);do if((0|P)==128)if((0|(n=0|Jt(0)))!=-1&&(r=n,w=(r=(((w=(I=0|e[997])-1|0)&r|0)==0?0:(w+r&0-I)-r|0)+f|0)+(I=0|e[986])|0,_>>>0<r>>>0&r>>>0<2147483647)){if(0|(E=0|e[988])&&w>>>0<=I>>>0|E>>>0<w>>>0){r=0;break}if((0|(t=0|Jt(r)))==(0|n)){a=n,c=r,P=145;break e}g=t,P=136}else r=0;while(0);do if((0|P)==136){if(n=0-r|0,!(r>>>0<d>>>0&r>>>0<2147483647&(0|g)!=-1)){if((0|g)==-1){r=0;break}a=g,c=r,P=145;break e}if(2147483647<=(t=u-r+(t=0|e[998])&0-t)>>>0){a=g,c=r,P=145;break e}if((0|Jt(t))==-1){Jt(n),r=0;break}a=g,c=t+r|0,P=145;break e}while(0);e[989]=4|e[989],P=143}while(0);if((0|P)==143&&f>>>0<2147483647&&!((0|(F=0|Jt(f)))==-1|1^(M=(_+40|0)>>>0<(V=(E=0|Jt(0))-F|0)>>>0)|F>>>0<E>>>0&(0|F)!=-1&(0|E)!=-1^1)&&(a=F,c=M?V:r,P=145),(0|P)==145){r=(0|e[986])+c|0,(e[986]=r)>>>0>(0|e[987])>>>0&&(e[987]=r),u=0|e[884];e:do if(u){for(h=3960;;){if((0|a)==((r=0|e[h>>2])+(t=0|e[(g=h+4|0)>>2])|0)){P=154;break}if(!(n=0|e[h+8>>2]))break;h=n}if((0|P)==154&&(8&e[h+12>>2]|0)==0&&u>>>0<a>>>0&r>>>0<=u>>>0){e[g>>2]=t+c,V=u+(M=(7&(M=u+8|0)|0)==0?0:0-M&7)|0,M=(L=(0|e[881])+c|0)-M|0,e[884]=V,e[881]=M,e[V+4>>2]=1|M,e[u+L+4>>2]=40,e[885]=e[1e3];break}for(a>>>0<(0|e[882])>>>0&&(e[882]=a),n=a+c|0,t=3960;;){if((0|e[t>>2])==(0|n)){P=162;break}if(!(r=0|e[t+8>>2]))break;t=r}if((0|P)==162&&(8&e[t+12>>2]|0)==0){e[t>>2]=a,e[(A=t+4|0)>>2]=(0|e[A>>2])+c,f=(A=a+((7&(A=a+8|0)|0)==0?0:0-A&7)|0)+_|0,d=(r=n+((7&(r=n+8|0)|0)==0?0:0-r&7)|0)-A-_|0,e[A+4>>2]=3|_;t:do if((0|u)==(0|r))L=(0|e[881])+d|0,e[881]=L,e[884]=f,e[f+4>>2]=1|L;else{if((0|e[883])==(0|r)){L=(0|e[880])+d|0,e[880]=L,e[883]=f,e[f+4>>2]=1|L,e[f+L>>2]=L;break}if((3&(t=0|e[r+4>>2])|0)==1){a=-8&t,g=t>>>3;i:do{if(t>>>0<256){if(t=0|e[r+8>>2],(0|(n=0|e[r+12>>2]))==(0|t)){e[878]=e[878]&~(1<<g);break}e[t+12>>2]=n,e[n+8>>2]=t;break}c=0|e[r+24>>2],t=0|e[r+12>>2];do if((0|t)==(0|r)){if(!(t=0|e[(n=4+(g=r+16|0)|0)>>2])){if(!(t=0|e[g>>2])){t=0;break}n=g}for(;;)if(g=0|e[(h=t+20|0)>>2])t=g,n=h;else{if(!(g=0|e[(h=t+16|0)>>2]))break;t=g,n=h}e[n>>2]=0}else L=0|e[r+8>>2],e[L+12>>2]=t,e[t+8>>2]=L;while(0);if(!c)break;g=3816+((n=0|e[r+28>>2])<<2)|0;do{if((0|e[g>>2])==(0|r)){if(0|(e[g>>2]=t))break;e[879]=e[879]&~(1<<n);break i}if(!(e[((0|e[(L=c+16|0)>>2])==(0|r)?L:c+20|0)>>2]=t))break i}while(0);if(e[t+24>>2]=c,0|(n=0|e[(g=r+16|0)>>2])&&(e[t+16>>2]=n,e[n+24>>2]=t),!(n=0|e[g+4>>2]))break;e[t+20>>2]=n,e[n+24>>2]=t}while(0);r=r+a|0,h=a+d|0}else h=d;if(e[(r=r+4|0)>>2]=-2&e[r>>2],e[f+4>>2]=1|h,r=(e[f+h>>2]=h)>>>3,h>>>0<256){n=3552+(r<<1<<2)|0,t=(t=0|e[878])&(r=1<<r)?0|e[(r=t=n+8|0)>>2]:(e[878]=t|r,r=n+8|0,n),e[r>>2]=f,e[t+12>>2]=f,e[f+8>>2]=t,e[f+12>>2]=n;break}r=h>>>8;do if(r){if(16777215<h>>>0){g=31;break}g=1&((L=7+(g=14-((M=(M=520192+(g=r<<(V=(V=r+1048320|0)>>>16&8))|0)>>>16&4)|V|(L=(L=245760+(g<<=M)|0)>>>16&2))+((g<<=L)>>>15)|0)|0)?h>>>L:h)|g<<1}else g=0;while(0);if(t=3816+(g<<2)|0,e[f+28>>2]=g,e[4+(r=f+16|0)>>2]=0,!((r=(e[r>>2]=0)|e[879])&(n=1<<g))){e[879]=r|n,e[t>>2]=f,e[f+24>>2]=t,e[f+12>>2]=f,e[f+8>>2]=f;break}r=0|e[t>>2];i:do if((-8&e[r+4>>2]|0)!=(0|h)){for(g=h<<((0|g)==31?0:25-(g>>>1)|0);t=0|e[(n=r+16+(g>>>31<<2)|0)>>2];){if((-8&e[t+4>>2]|0)==(0|h)){r=t;break i}g<<=1,r=t}e[n>>2]=f,e[f+24>>2]=r,e[f+12>>2]=f,e[f+8>>2]=f;break t}while(0);L=0|e[(V=r+8|0)>>2],e[L+12>>2]=f,e[V>>2]=f,e[f+8>>2]=L,e[f+12>>2]=r,e[f+24>>2]=0}while(0);return x=U,A+8|0}for(t=3960;!((r=0|e[t>>2])>>>0<=u>>>0&&u>>>0<(L=r+(0|e[t+4>>2])|0)>>>0);)t=0|e[t+8>>2];for(r=(t=(t=(h=L+-47|0)+((7&(t=h+8|0)|0)==0?0:0-t&7)|0)>>>0<(h=u+16|0)>>>0?u:t)+8|0,V=a+(M=(7&(M=a+8|0)|0)==0?0:0-M&7)|0,M=(n=c+-40|0)-M|0,e[884]=V,e[881]=M,e[V+4>>2]=1|M,e[a+n+4>>2]=40,e[885]=e[1e3],e[(n=t+4|0)>>2]=27,e[r>>2]=e[990],e[r+4>>2]=e[991],e[r+8>>2]=e[992],e[r+12>>2]=e[993],e[990]=a,e[991]=c,e[993]=0,e[992]=r,r=t+24|0;e[(r=(V=r)+4|0)>>2]=7,(V+8|0)>>>0<L>>>0;);if((0|t)!=(0|u)){if(c=t-u|0,e[n>>2]=-2&e[n>>2],e[u+4>>2]=1|c,r=(e[t>>2]=c)>>>3,c>>>0<256){n=3552+(r<<1<<2)|0,t=(t=0|e[878])&(r=1<<r)?0|e[(r=t=n+8|0)>>2]:(e[878]=t|r,r=n+8|0,n),e[r>>2]=u,e[t+12>>2]=u,e[u+8>>2]=t,e[u+12>>2]=n;break}if(n=3816+((g=(r=c>>>8)?16777215<c>>>0?31:1&((L=7+(g=14-((M=(M=520192+(g=r<<(V=(V=r+1048320|0)>>>16&8))|0)>>>16&4)|V|(L=(L=245760+(g<<=M)|0)>>>16&2))+((g<<=L)>>>15)|0)|0)?c>>>L:c)|g<<1:0)<<2)|0,e[u+28>>2]=g,e[u+20>>2]=0,!((r=(e[h>>2]=0)|e[879])&(t=1<<g))){e[879]=r|t,e[n>>2]=u,e[u+24>>2]=n,e[u+12>>2]=u,e[u+8>>2]=u;break}r=0|e[n>>2];t:do if((-8&e[r+4>>2]|0)!=(0|c)){for(g=c<<((0|g)==31?0:25-(g>>>1)|0);t=0|e[(n=r+16+(g>>>31<<2)|0)>>2];){if((-8&e[t+4>>2]|0)==(0|c)){r=t;break t}g<<=1,r=t}e[n>>2]=u,e[u+24>>2]=r,e[u+12>>2]=u,e[u+8>>2]=u;break e}while(0);L=0|e[(V=r+8|0)>>2],e[L+12>>2]=u,e[V>>2]=u,e[u+8>>2]=L,e[u+12>>2]=r,e[u+24>>2]=0}}else(0|(L=0|e[882]))==0|a>>>0<L>>>0&&(e[882]=a),e[990]=a,e[991]=c,e[993]=0,e[887]=e[996],e[886]=-1,e[891]=3552,e[890]=3552,e[893]=3560,e[892]=3560,e[895]=3568,e[894]=3568,e[897]=3576,e[896]=3576,e[899]=3584,e[898]=3584,e[901]=3592,e[900]=3592,e[903]=3600,e[902]=3600,e[905]=3608,e[904]=3608,e[907]=3616,e[906]=3616,e[909]=3624,e[908]=3624,e[911]=3632,e[910]=3632,e[913]=3640,e[912]=3640,e[915]=3648,e[914]=3648,e[917]=3656,e[916]=3656,e[919]=3664,e[918]=3664,e[921]=3672,e[920]=3672,e[923]=3680,e[922]=3680,e[925]=3688,e[924]=3688,e[927]=3696,e[926]=3696,e[929]=3704,e[928]=3704,e[931]=3712,e[930]=3712,e[933]=3720,e[932]=3720,e[935]=3728,e[934]=3728,e[937]=3736,e[936]=3736,e[939]=3744,e[938]=3744,e[941]=3752,e[940]=3752,e[943]=3760,e[942]=3760,e[945]=3768,e[944]=3768,e[947]=3776,e[946]=3776,e[949]=3784,e[948]=3784,e[951]=3792,e[950]=3792,e[953]=3800,e[952]=3800,V=a+(M=(7&(M=a+8|0)|0)==0?0:0-M&7)|0,M=(L=c+-40|0)-M|0,e[884]=V,e[881]=M,e[V+4>>2]=1|M,e[a+L+4>>2]=40,e[885]=e[1e3];while(0);if(_>>>0<(r=0|e[881])>>>0)return M=r-_|0,e[881]=M,V=(L=0|e[884])+_|0,e[884]=V,e[V+4>>2]=1|M,e[L+4>>2]=3|_,x=U,L+8|0}return e[861]=48,x=U,(L=0)|L}function or(t){var r=0,n=0,g=0,h=0,c=0,a=0,d=0,u=0,f=0;if(t|=0){n=t+-8|0,g=0|e[882],f=n+(r=-8&(t=0|e[t+-4>>2]))|0;do if(1&t)u=d=n;else{if(h=0|e[n>>2],!(3&t)||(a=h+r|0,(c=n+(0-h)|0)>>>0<g>>>0))return;if((0|e[883])==(0|c)){if((3&(t=0|e[(r=f+4|0)>>2])|0)==3)return e[880]=a,e[r>>2]=-2&t,e[c+4>>2]=1|a,void(e[c+a>>2]=a);u=d=c,r=a;break}if(n=h>>>3,h>>>0<256){if(t=0|e[c+8>>2],(0|(r=0|e[c+12>>2]))==(0|t)){e[878]=e[878]&~(1<<n),u=d=c,r=a;break}e[t+12>>2]=r,e[r+8>>2]=t,u=d=c,r=a;break}h=0|e[c+24>>2],t=0|e[c+12>>2];do if((0|t)==(0|c)){if(!(t=0|e[(r=4+(n=c+16|0)|0)>>2])){if(!(t=0|e[n>>2])){n=0;break}r=n}for(;;)if(n=0|e[(g=t+20|0)>>2])t=n,r=g;else{if(!(n=0|e[(g=t+16|0)>>2]))break;t=n,r=g}e[r>>2]=0,n=t}else n=0|e[c+8>>2],e[n+12>>2]=t,e[t+8>>2]=n,n=t;while(0);if(h){if(t=0|e[c+28>>2],(0|e[(r=3816+(t<<2)|0)>>2])==(0|c)){if(!(e[r>>2]=n)){e[879]=e[879]&~(1<<t),u=d=c,r=a;break}}else if(!(e[((0|e[(u=h+16|0)>>2])==(0|c)?u:h+20|0)>>2]=n)){u=d=c,r=a;break}e[n+24>>2]=h,0|(t=0|e[(r=c+16|0)>>2])&&(e[n+16>>2]=t,e[t+24>>2]=n),(t=0|e[r+4>>2])&&(e[n+20>>2]=t,e[t+24>>2]=n),u=d=c,r=a}else u=d=c,r=a}while(0);if(!(f>>>0<=d>>>0)&&1&(n=0|e[(t=f+4|0)>>2])){if(2&n)e[t>>2]=-2&n,e[u+4>>2]=1|r,h=e[d+r>>2]=r;else{if((0|e[884])==(0|f))return f=(0|e[881])+r|0,e[881]=f,e[884]=u,e[u+4>>2]=1|f,(0|u)!=(0|e[883])?void 0:(e[883]=0,void(e[880]=0));if((0|e[883])==(0|f))return f=(0|e[880])+r|0,e[880]=f,e[883]=d,e[u+4>>2]=1|f,void(e[d+f>>2]=f);h=(-8&n)+r|0,g=n>>>3;do{if(n>>>0<256){if(r=0|e[f+8>>2],(0|(t=0|e[f+12>>2]))==(0|r)){e[878]=e[878]&~(1<<g);break}e[r+12>>2]=t,e[t+8>>2]=r;break}c=0|e[f+24>>2],t=0|e[f+12>>2];do if((0|t)==(0|f)){if(!(t=0|e[(r=4+(n=f+16|0)|0)>>2])){if(!(t=0|e[n>>2])){n=0;break}r=n}for(;;)if(n=0|e[(g=t+20|0)>>2])t=n,r=g;else{if(!(n=0|e[(g=t+16|0)>>2]))break;t=n,r=g}e[r>>2]=0,n=t}else n=0|e[f+8>>2],e[n+12>>2]=t,e[t+8>>2]=n,n=t;while(0);if(0|c){if(t=0|e[f+28>>2],(0|e[(r=3816+(t<<2)|0)>>2])==(0|f)){if(!(e[r>>2]=n)){e[879]=e[879]&~(1<<t);break}}else if(!(e[((0|e[(a=c+16|0)>>2])==(0|f)?a:c+20|0)>>2]=n))break;e[n+24>>2]=c,0|(t=0|e[(r=f+16|0)>>2])&&(e[n+16>>2]=t,e[t+24>>2]=n),0|(t=0|e[r+4>>2])&&(e[n+20>>2]=t,e[t+24>>2]=n)}}while(0);if(e[u+4>>2]=1|h,e[d+h>>2]=h,(0|u)==(0|e[883]))return void(e[880]=h)}if(t=h>>>3,h>>>0<256)return n=3552+(t<<1<<2)|0,r=(r=0|e[878])&(t=1<<t)?0|e[(t=r=n+8|0)>>2]:(e[878]=r|t,t=n+8|0,n),e[t>>2]=u,e[r+12>>2]=u,e[u+8>>2]=r,void(e[u+12>>2]=n);r=3816+((g=(t=h>>>8)?16777215<h>>>0?31:1&((f=7+(g=14-((a=(a=520192+(g=t<<(d=(d=t+1048320|0)>>>16&8))|0)>>>16&4)|d|(f=(f=245760+(g<<=a)|0)>>>16&2))+((g<<=f)>>>15)|0)|0)?h>>>f:h)|g<<1:0)<<2)|0,e[u+28>>2]=g,e[u+20>>2]=0,t=(e[u+16>>2]=0)|e[879],n=1<<g;e:do if(t&n){t=0|e[r>>2];t:do if((-8&e[t+4>>2]|0)!=(0|h)){for(g=h<<((0|g)==31?0:25-(g>>>1)|0);r=0|e[(n=t+16+(g>>>31<<2)|0)>>2];){if((-8&e[r+4>>2]|0)==(0|h)){t=r;break t}g<<=1,t=r}e[n>>2]=u,e[u+24>>2]=t,e[u+12>>2]=u,e[u+8>>2]=u;break e}while(0);f=0|e[(d=t+8|0)>>2],e[f+12>>2]=u,e[d>>2]=u,e[u+8>>2]=f,e[u+12>>2]=t,e[u+24>>2]=0}else e[879]=t|n,e[r>>2]=u,e[u+24>>2]=r,e[u+12>>2]=u,e[u+8>>2]=u;while(0);if(f=(0|e[886])-1|0,!(0|(e[886]=f))){for(t=3968;t=0|e[t>>2];)t=t+8|0;e[886]=-1}}}}function c0(t,r){var n=0,g=0,h=0,c=0,a=0,d=0,u=0,u=(t|=0)+(r|=0)|0,n=0|e[t+4>>2];do if(1&n)d=t,t=r;else{if(g=0|e[t>>2],!(3&n))return;if(c=t+(0-g)|0,a=g+r|0,(0|e[883])==(0|c)){if((3&(n=0|e[(t=u+4|0)>>2])|0)==3)return e[880]=a,e[t>>2]=-2&n,e[c+4>>2]=1|a,e[u>>2]=a,0;d=c,t=a;break}if(r=g>>>3,g>>>0<256){if(n=0|e[c+8>>2],(0|(t=0|e[c+12>>2]))==(0|n)){e[878]=e[878]&~(1<<r),d=c,t=a;break}e[n+12>>2]=t,e[t+8>>2]=n,d=c,t=a;break}h=0|e[c+24>>2],n=0|e[c+12>>2];do if((0|n)==(0|c)){if(!(n=0|e[(t=4+(r=c+16|0)|0)>>2])){if(!(n=0|e[r>>2])){r=0;break}t=r}for(;;)if(r=0|e[(g=n+20|0)>>2])n=r,t=g;else{if(!(r=0|e[(g=n+16|0)>>2]))break;n=r,t=g}e[t>>2]=0,r=n}else r=0|e[c+8>>2],e[r+12>>2]=n,e[n+8>>2]=r,r=n;while(0);if(h){if(n=0|e[c+28>>2],(0|e[(t=3816+(n<<2)|0)>>2])==(0|c)){if(!(e[t>>2]=r)){e[879]=e[879]&~(1<<n),d=c,t=a;break}}else if(!(e[((0|e[(d=h+16|0)>>2])==(0|c)?d:h+20|0)>>2]=r)){d=c,t=a;break}e[r+24>>2]=h,0|(n=0|e[(t=c+16|0)>>2])&&(e[r+16>>2]=n,e[n+24>>2]=r),(n=0|e[t+4>>2])&&(e[r+20>>2]=n,e[n+24>>2]=r),d=c,t=a}else d=c,t=a}while(0);if(2&(r=0|e[(n=u+4|0)>>2]))e[n>>2]=-2&r,e[d+4>>2]=1|t,e[d+t>>2]=t;else{if((0|e[884])==(0|u))return u=(0|e[881])+t|0,e[881]=u,e[884]=d,e[d+4>>2]=1|u,(0|d)==(0|e[883])&&(e[883]=0,void(e[880]=0));if((0|e[883])==(0|u))return u=(0|e[880])+t|0,e[880]=u,e[883]=d,e[d+4>>2]=1|u,e[d+u>>2]=u,0;c=(-8&r)+t|0,g=r>>>3;do{if(r>>>0<256){if(t=0|e[u+8>>2],(0|(n=0|e[u+12>>2]))==(0|t)){e[878]=e[878]&~(1<<g);break}e[t+12>>2]=n,e[n+8>>2]=t;break}h=0|e[u+24>>2],n=0|e[u+12>>2];do if((0|n)==(0|u)){if(!(n=0|e[(t=4+(r=u+16|0)|0)>>2])){if(!(n=0|e[r>>2])){r=0;break}t=r}for(;;)if(r=0|e[(g=n+20|0)>>2])n=r,t=g;else{if(!(r=0|e[(g=n+16|0)>>2]))break;n=r,t=g}e[t>>2]=0,r=n}else r=0|e[u+8>>2],e[r+12>>2]=n,e[n+8>>2]=r,r=n;while(0);if(0|h){if(n=0|e[u+28>>2],(0|e[(t=3816+(n<<2)|0)>>2])==(0|u)){if(!(e[t>>2]=r)){e[879]=e[879]&~(1<<n);break}}else if(!(e[((0|e[(a=h+16|0)>>2])==(0|u)?a:h+20|0)>>2]=r))break;e[r+24>>2]=h,0|(n=0|e[(t=u+16|0)>>2])&&(e[r+16>>2]=n,e[n+24>>2]=r),0|(n=0|e[t+4>>2])&&(e[r+20>>2]=n,e[n+24>>2]=r)}}while(0);if(e[d+4>>2]=1|c,e[d+c>>2]=c,(0|d)==(0|e[883]))return e[880]=c,0;t=c}if(n=t>>>3,t>>>0<256)return r=3552+(n<<1<<2)|0,t=(t=0|e[878])&(n=1<<n)?0|e[(n=t=r+8|0)>>2]:(e[878]=t|n,n=r+8|0,r),e[n>>2]=d,e[t+12>>2]=d,e[d+8>>2]=t,e[d+12>>2]=r,0;if(r=3816+((h=(n=t>>>8)?16777215<t>>>0?31:1&((u=7+(h=14-((c=(c=520192+(h=n<<(a=(a=n+1048320|0)>>>16&8))|0)>>>16&4)|a|(u=(u=245760+(h<<=c)|0)>>>16&2))+((h<<=u)>>>15)|0)|0)?t>>>u:t)|h<<1:0)<<2)|0,e[d+28>>2]=h,e[d+20>>2]=0,!((n=(e[d+16>>2]=0)|e[879])&(g=1<<h)))return e[879]=n|g,e[r>>2]=d,e[d+24>>2]=r,e[d+12>>2]=d,e[d+8>>2]=d,0;n=0|e[r>>2];e:do if((-8&e[n+4>>2]|0)!=(0|t)){for(h=t<<((0|h)==31?0:25-(h>>>1)|0);r=0|e[(g=n+16+(h>>>31<<2)|0)>>2];){if((-8&e[r+4>>2]|0)==(0|t)){n=r;break e}h<<=1,n=r}return e[g>>2]=d,e[d+24>>2]=n,e[d+12>>2]=d,e[d+8>>2]=d,0}while(0);u=0|e[(a=n+8|0)>>2],e[u+12>>2]=d,e[a>>2]=d,e[d+8>>2]=u,e[d+12>>2]=n,e[d+24>>2]=0}function d0(t,r,n){t|=0;var g;return(3&(r|=0)|0)!=0|(0|(g=r>>>2))==0||1073741823+g&g|0?0|(t=28):(-64-r|0)>>>0<(n|=0)>>>0||!(r=0|function(h,c){c|=0;var a,d=0,u=0,f=0,A=0,_=0;if((d=16<(h|=0)>>>0?h:16)+-1&d)for(h=16;h>>>0<d>>>0;)h<<=1;else h=d;if((-64-h|0)>>>0<=c>>>0)return e[861]=48,(A=0)|A;if(!(d=0|ar(12+(a=c>>>0<11?16:c+11&-8)+h|0)))return(A=0)|A;f=d+-8|0;do{if(h+-1&d){if(c=(u=15<((u=(d+h+-1&0-h)-8|0)-(c=f)|0)>>>0?u:u+h|0)-c|0,d=(-8&(_=0|e[(h=d+-4|0)>>2]))-c|0,3&_){e[(_=u+4|0)>>2]=d|1&e[_>>2]|2,e[(d=u+d+4|0)>>2]=1|e[d>>2],e[h>>2]=c|1&e[h>>2]|2,e[_>>2]=1|e[_>>2],c0(f,c),h=c=u;break}e[u>>2]=(0|e[f>>2])+c,e[u+4>>2]=d,h=c=u;break}h=c=f}while(0);return 3&(h=0|e[(d=h+4|0)>>2])|0&&(16+a|0)>>>0<(A=-8&h)>>>0&&(_=A-a|0,f=c+a|0,e[d>>2]=a|1&h|2,e[f+4>>2]=3|_,e[(A=c+A+4|0)>>2]=1|e[A>>2],c0(f,_)),c+8|0}(16<r>>>0?r:16,n))?0|(t=48):(e[t>>2]=r,(t=0)|t)}function Jt(t){t|=0;var r,n=0;return(t=(r=0|e[(n=4032)>>2])+t|0)>>>0>(0|Ss())>>>0&&(0|ks(0|t))==0?(e[861]=48,0|(n=-1)):(e[n>>2]=t,0|(n=r))}function lr(t,r,n,g){r|=0,g|=0;var h,c;return n=0|function(a,d){var u,f,A,_;return a=((u=0|et(A=65535&(d|=0),_=65535&(a|=0)))>>>16)+(0|et(A,f=a>>>16))|0,d=0|et(A=d>>>16,_),0|(tt((a>>>16)+(0|et(A,f))+(((65535&a)+d|0)>>>16)|0),a+d<<16|65535&u|0)}(h=t|=0,c=n|=0),t=0|nt(),0|(tt((0|et(r,c))+(0|et(g,h))+t|0&t|0),0|n)}function vi(t,r,n,g){return 0|(tt((r|=0)+(g|=0)+((n=(t|=0)+(n|=0)>>>0)>>>0<t>>>0|0)>>>0|0),0|n)}function Gi(t,r,n,g){return 0|(tt(0|(g=(r|=0)-(g|=0)-((t|=0)>>>0<(n|=0)>>>0|0)>>>0)),t-n>>>0|0)}function f0(t){return 0|((t|=0)?31-(0|Ht(t^t-1))|0:32)}function Us(t,r,n,g,h){h|=0;var c=0,a=0,d=0,u=0,f=0,A=0,_=0,v=0,I=0,w=0,A=t|=0,a=n|=0,d=v=g|=0;if(!(f=u=r|=0))return c=(0|h)!=0,d?(c&&(e[h>>2]=0|t,e[h+4>>2]=0&r),(h=v=0)|(tt(0|v),h)):(c&&(e[h>>2]=(A>>>0)%(a>>>0),e[h+4>>2]=0),h=(A>>>(v=0))/(a>>>0)>>>0,0|(tt(0|v),h));c=(0|d)==0;do{if(a){if(!c){if((c=(0|Ht(0|d))-(0|Ht(0|f))|0)>>>0<=31){t=A>>>((a=_=c+1|0)>>>0)&(r=c-31>>31)|f<<(d=31-c|0),r&=f>>>(_>>>0),c=0,d=A<<d;break}return h&&(e[h>>2]=0|t,e[h+4>>2]=u|0&r),(h=v=0)|(tt(0|v),h)}if((c=a-1|0)&a|0){t=(_=32-(d=33+(0|Ht(0|a))-(0|Ht(0|f))|0)|0)-1>>31&f>>>((I=d-32|0)>>>0)|(f<<_|A>>>((a=d)>>>0))&(r=I>>31),r&=f>>>(d>>>0),c=A<<(w=64-d|0)&(u=_>>31),d=(f<<w|A>>>(I>>>0))&u|A<<_&d-33>>31;break}return 0|h&&(e[h>>2]=c&A,e[h+4>>2]=0),(0|a)==1?(w=0|t,0|(tt(0|(I=u|0&r)),w)):(I=f>>>((w=0|f0(0|a))>>>0)|0,w=f<<32-w|A>>>(w>>>0)|0,0|(tt(0|I),w))}if(c)return 0|h&&(e[h>>2]=(f>>>0)%(a>>>0),e[h+4>>2]=0),w=(f>>>(I=0))/(a>>>0)>>>0,0|(tt(0|I),w);if(!A)return 0|h&&(e[h>>2]=0,e[h+4>>2]=(f>>>0)%(d>>>0)),w=(f>>>(I=0))/(d>>>0)>>>0,0|(tt(0|I),w);if(!((c=d-1|0)&d))return 0|h&&(e[h>>2]=0|t,e[h+4>>2]=c&f|0&r),w=f>>>(((I=0)|f0(0|d))>>>0),0|(tt(0|I),w);if((c=(0|Ht(0|d))-(0|Ht(0|f))|0)>>>0<=30){t=f<<(d=31-c|0)|A>>>((a=r=c+1|0)>>>0),r=f>>>(r>>>0),c=0,d=A<<d;break}return h&&(e[h>>2]=0|t,e[h+4>>2]=u|0&r),(w=I=0)|(tt(0|I),w)}while(0);if(a){for(f=0|vi(0|(_=0|n),0|(A=v|0&g),-1,-1),n=0|nt(),u=d,d=0;u=c>>>31|(g=u)<<1,c=d|c<<1,Gi(0|f,0|n,0|(g=t<<1|g>>>31|0),0|(v=t>>>31|r<<1|0)),d=1&(I=(w=0|nt())>>31|((0|w)<0?-1:0)<<1),t=0|Gi(0|g,0|v,I&_|0,(((0|w)<0?-1:0)>>31|((0|w)<0?-1:0)<<1)&A|0),r=0|nt(),(0|(a=a-1|0))!=0;);f=u,u=0}else f=d,d=u=0;return(a=0)|h&&(e[h>>2]=t,e[h+4>>2]=r),w=-2&(c<<1|0)|d,0|(tt(0|(I=(0|c)>>>31|(f|a)<<1|0&(a<<1|c>>>31)|u)),w)}function ur(t,r,n,g){return 0|Us(t|=0,r|=0,n|=0,g|=0,0)}function Ni(t,r,n){return t|=0,r|=0,(0|(n|=0))<32?(tt(r>>>n|0),t>>>n|(r&(1<<n)-1)<<32-n):(tt(0),r>>>n-32|0)}function m0(t,r,n){return t|=0,r|=0,(0|(n|=0))<32?(tt(r<<n|(t&(1<<n)-1<<32-n)>>>32-n|0),t<<n):(tt(t<<n-32|0),0)}function Dt(t,r,n){var g,h,c;if(t|=0,r|=0,8192<=(0|(n|=0)))return Is(0|t,0|r,0|n),0|t;if(c=0|t,h=t+n|0,(3&t)==(3&r)){for(;3&t;){if(!n)return 0|c;B[t>>0]=0|B[r>>0],t=t+1|0,r=r+1|0,n=n-1|0}for(g=(n=-4&h|0)-64|0;(0|t)<=(0|g);)e[t>>2]=e[r>>2],e[t+4>>2]=e[r+4>>2],e[t+8>>2]=e[r+8>>2],e[t+12>>2]=e[r+12>>2],e[t+16>>2]=e[r+16>>2],e[t+20>>2]=e[r+20>>2],e[t+24>>2]=e[r+24>>2],e[t+28>>2]=e[r+28>>2],e[t+32>>2]=e[r+32>>2],e[t+36>>2]=e[r+36>>2],e[t+40>>2]=e[r+40>>2],e[t+44>>2]=e[r+44>>2],e[t+48>>2]=e[r+48>>2],e[t+52>>2]=e[r+52>>2],e[t+56>>2]=e[r+56>>2],e[t+60>>2]=e[r+60>>2],t=t+64|0,r=r+64|0;for(;(0|t)<(0|n);)e[t>>2]=e[r>>2],t=t+4|0,r=r+4|0}else for(n=h-4|0;(0|t)<(0|n);)B[t>>0]=0|B[r>>0],B[t+1>>0]=0|B[r+1>>0],B[t+2>>0]=0|B[r+2>>0],B[t+3>>0]=0|B[r+3>>0],t=t+4|0,r=r+4|0;for(;(0|t)<(0|h);)B[t>>0]=0|B[r>>0],t=t+1|0,r=r+1|0;return 0|c}function Ct(t,r,n){r|=0;var g,h,c,a=(t|=0)+(n|=0)|0;if(r&=255,67<=(0|n)){for(;3&t;)B[t>>0]=r,t=t+1|0;for(c=r|r<<8|r<<16|r<<24,h=(g=-4&a|0)-64|0;(0|t)<=(0|h);)e[t>>2]=c,e[t+4>>2]=c,e[t+8>>2]=c,e[t+12>>2]=c,e[t+16>>2]=c,e[t+20>>2]=c,e[t+24>>2]=c,e[t+28>>2]=c,e[t+32>>2]=c,e[t+36>>2]=c,e[t+40>>2]=c,e[t+44>>2]=c,e[t+48>>2]=c,e[t+52>>2]=c,e[t+56>>2]=c,e[t+60>>2]=c,t=t+64|0;for(;(0|t)<(0|g);)e[t>>2]=c,t=t+4|0}for(;(0|t)<(0|a);)B[t>>0]=r,t=t+1|0;return a-n|0}function g0(t){return ni(0),0}function p0(t,r,n,g){return ni(2),0}var Gs=[g0,function(t){return 0|ys(0,0|(t|=0))},function(t){return 0},g0],ji=[function(t,r,n){return ni(1),0},function(t,r,n){return 0|vs(0,0|(t|=0),0|(r|=0),0|(n|=0))},function(t,r,n){r|=0,n|=0;var g,h,c,a,d,u,f,A=0,_=0,v=0,I=0,w=x;for(x=x+32|0,h=(_=w)+16|0,A=0|e[(c=28+(t|=0)|0)>>2],e[_>>2]=A,A=(0|e[(a=t+20|0)>>2])-A|0,e[_+4>>2]=A,e[_+8>>2]=r,g=t+60|0,A=A+(e[_+12>>(v=2)]=n)|0;;){if((0|A)==(0|(r=0|function(E){return 0|(E=(E|=0)<<16>>16?(e[861]=65535&E,-1):0)}(0|Ps(0|e[g>>2],0|_,0|v,0|h))?e[h>>2]=-1:0|e[h>>2]))){r=6;break}if((0|r)<0){r=8;break}I=r-((d=(I=0|e[_+4>>2])>>>0<r>>>0)?I:0)|0,e[(u=d?_+8|0:_)>>2]=(0|e[u>>2])+I,e[(f=u+4|0)>>2]=(0|e[f>>2])-I,_=u,v=v+(d<<31>>31)|0,A=A-r|0}return(0|r)==6?(I=0|e[t+44>>2],e[t+16>>2]=I+(0|e[t+48>>2]),e[c>>2]=I,e[a>>2]=I):(0|r)==8&&(e[t+16>>2]=0,e[c>>2]=0,e[a>>2]=0,e[t>>2]=32|e[t>>2],n=(0|v)==2?0:n-(0|e[_+4>>2])|0),x=w,0|n},function(t,r,n){r|=0,n|=0;var g,h;return Dt(0|(h=0|e[(g=20+(t|=0)|0)>>2]),0|r,0|(t=n>>>0<(t=(0|e[t+16>>2])-h|0)>>>0?n:t)),e[g>>2]=(0|e[g>>2])+t,0|n}],Ns=[p0,function(t,r,n,g){return 0|ws(0,0|(t|=0),0|(r|=0),0|(n|=0),0|(g|=0))},function(t,r,n,g){return tt(0),0},p0],_0=[function(t){ni(3)},function(t){xs(0,0|(t|=0))}],A0=[function(t,r,n){ni(4)},function(t,r,n){Ms(0,0|(t|=0),0|(r|=0),0|(n|=0))},function(t,r,n){r|=0,n|=0;var g,h,c=0|e[24+(t|=0)>>2],a=0|e[n+136>>2],d=0|e[n+140>>2];return(0|(t=0|e[(h=t+4|0)>>2]))==-1?(e[a+(r<<2)>>2]=e[16+c>>2],void(S[d+(r<<2)>>2]=1)):(g=0|e[n+4>>2],n=0|e[20+c>>2],qt[3&e[g+(t<<5)+20>>2]](0|e[g+(t<<5)+24>>2],n,n,0|e[12+c>>2]),n=0|e[h>>2],S[a+(r<<2)>>2]=+S[16+c>>2]*+S[a+(n<<2)>>2],void(e[d+(r<<2)>>2]=e[d+(n<<2)>>2]))},function(t,r,n){r|=0,n|=0;var g,h,c,a,d,u,f,A,_,v,I,w,E,P,F,M,V,L,U=0,H=0,ne=0,se=0,z=0,K=0,X=0,Y=x;if(x=x+48|0,E=Y+8|0,I=Y+40|0,v=Y+32|0,_=(w=Y)+24|0,L=Y+16|0,F=0|e[24+(t|=0)>>2],M=0|e[n+136>>2],V=0|e[n+140>>2],(0|(t=0|e[(P=t+4|0)>>2]))==-1)return e[M+(r<<2)>>2]=e[4+F>>2],e[V+(r<<2)>>2]=e[8+F>>2],void(x=Y);for(a=0|e[n+4>>2],c=0|e[(d=12+F|0)>>2],e[L>>2]=c,A=4+L|0,f=0|e[(u=16+F|0)>>2],e[A>>2]=f,K=(0|e[a+(t<<5)+8>>2])==1?-10:-.10000000149011612,e[I>>2]=c,e[(c=4+I|0)>>2]=f,f=a+(t<<5)+20|0,a=a+(t<<5)+24|0,qt[3&e[f>>2]](0|e[a>>2],I,v,1),h=4+_|0,t=4+v|0,n=w+4|0,se=9,z=1;ne=0*z,S[_>>2]=ne+ +S[I>>2],g=K*z,S[h>>2]=g+ +S[c>>2],qt[3&e[f>>2]](0|e[a>>2],_,w,1),H=+S[w>>2]-+S[v>>2],S[w>>2]=H,U=+S[n>>2]-+S[t>>2],!(H!=0|(S[n>>2]=U)!=0);){if(S[_>>2]=+S[I>>2]-ne,S[h>>2]=+S[c>>2]-g,qt[3&e[f>>2]](0|e[a>>2],_,w,1),U=+S[w>>2]-+S[v>>2],S[w>>2]=U,ne=+S[n>>2]-+S[t>>2],U!=0|(S[n>>2]=ne)!=0){X=6;break}if(!se){X=8;break}se=se+-1|0,z*=.10000000149011612}(0|X)==6?(H=-U,U=-ne):(0|X)==8&&(he(0,2207,E),U=H=0),K=180*+Es(0,K,H,U)/3.1415927410125732,qt[3&e[f>>2]](0|e[a>>2],L,L,1),e[d>>2]=e[L>>2],e[u>>2]=e[A>>2],S[(L=20+F|0)>>2]=+S[L>>2]-K,L=0|e[P>>2],S[M+(r<<2)>>2]=+S[4+F>>2]*+S[M+(L<<2)>>2],K=+S[(X=8+F|0)>>2]*+S[V+(L<<2)>>2],S[V+(r<<2)>>2]=K,S[X>>2]=K,x=Y}],qt=[function(t,r,n,g){ni(5)},function(t,r,n,g){Cs(0,0|(t|=0),0|(r|=0),0|(n|=0),0|(g|=0))},function(t,r,n,g){r|=0,n|=0,g|=0;var h,c,a,d,u,f,A,_,v,I,w,E,P,F,M,V,L,U,H,ne,se,z,K,X=0,Y=0,te=0,oe=0,Ve=0,He=0,Ue=0,Se=0,Ge=0,Re=0,ie=0,Ee=0,De=0,ve=0,Ie=0,fe=0,ae=0,me=0,Xe=0,ce=0,Ce=0,Me=0,_e=0,we=0,$t=x;if(x=x+32|0,H=$t,P=0|e[20+(t|=0)>>2],F=0|e[t+4>>2],M=0|e[t>>2],V=1+F|0,(0|g)<=0)x=$t;else{L=+(0|F),U=+(0|M),E=(0|e[t+8>>2])==0,c=P+(F<<3)|0,a=P+((v=0|et(M,V))<<3)|0,d=P+((_=v+F|0)<<3)|0,u=4+P|0,f=P+(F<<3)+4|0,A=P+(v<<3)+4|0,_=P+(_<<3)+4|0,w=F-1|0,I=M-1|0,De=ve=Ie=fe=te=oe=Ee=ie=Re=Ge=Me=Ce=Se=Ue=He=Ve=_e=Xe=0;do{ae=(h=+S[r+(_e<<3)>>2])*L,ce=(me=+S[r+(_e<<3)+4>>2])*U,X=!(1<=h),Y=!(1<=me);do{if(Y&X&!(h<0)&!(me<0)){if(X=~~ae,t=(0|et(V,Y=~~ce))+X|0,oe=ae-(0|X),te=ce-(0|Y),!E){me=1-oe,ae=1-te,we=t+1|0,Y=1+(X=t+V|0)|0,S[n+(_e<<3)>>2]=ae*(me*+S[P+(t<<3)>>2])+ae*(oe*+S[P+(we<<3)>>2])+te*(me*+S[P+(X<<3)>>2])+te*(oe*+S[P+(Y<<3)>>2]),me=ae*(me*+S[P+(t<<3)+4>>2])+ae*(oe*+S[P+(we<<3)+4>>2])+te*(me*+S[P+(X<<3)+4>>2]),ae=te*(oe*+S[P+(Y<<3)+4>>2]);break}if(oe+te<=1){me=1-oe-te,Y=t+1|0,we=t+V|0,S[n+(_e<<3)>>2]=me*+S[P+(t<<3)>>2]+oe*+S[P+(Y<<3)>>2]+te*+S[P+(we<<3)>>2],me=me*+S[P+(t<<3)+4>>2]+oe*+S[P+(Y<<3)+4>>2],ae=te*+S[P+(we<<3)+4>>2];break}X=1+(Y=t+V|0)|0,ce=oe+-1+te,me=1-oe,we=t+1|0,ae=1-te,S[n+(_e<<3)>>2]=ce*+S[P+(X<<3)>>2]+me*+S[P+(Y<<3)>>2]+ae*+S[P+(we<<3)>>2],me=ce*+S[P+(X<<3)+4>>2]+me*+S[P+(Y<<3)+4>>2],ae*=+S[P+(we<<3)+4>>2];break}if(Xe||(K=+S[P>>2],z=+S[c>>2],se=+S[a>>2],Ce=+S[d>>2],ne=+S[u>>2],De=(Ie=+S[f>>2])-(fe=+S[A>>2]),Xe=1,Ce=.25*(K+z+se+Ce)-.5*(K=Ce-K),Me=.25*(ne+Ie+fe+(Me=+S[_>>2]))-.5*(ne=Me-ne),fe=.5*((ve=z-se)+K),Ie=.5*(De+ne),ve=.5*(K-ve),De=.5*(ne-De)),!(me<3&-2<h&h<3&-2<me)){S[n+(_e<<3)>>2]=me*ve+(h*fe+Ce),me*=De,ae=h*Ie+Me;break}do{if(h<=0){if(me<=0){Ve=Ce-(Ue=2*ve),He=Me-(Se=2*De),Ue=(ie=Ce-2*fe)-Ue,Se=(Ee=Me-2*Ie)-Se,Ge=+S[P>>2],Re=+S[u>>2],oe=.5*(2+h),te=.5*(me+2);break}if(Y){Se=(te=+(0|(Y=(0|M)==(0|(Y=~~ce))?I:Y)))/U,oe=(0|(we=Y+1|0))/U,Y=0|et(Y,V),we=0|et(we,V),ie=Ce-2*fe,Ee=Me-2*Ie,Ve=+S[P+(Y<<3)>>2],He=+S[P+(Y<<3)+4>>2],Ue=Se*ve+ie,Se=Se*De+Ee,Ge=+S[P+(we<<3)>>2],Re=+S[P+(we<<3)+4>>2],ie=oe*ve+ie,Ee=oe*De+Ee,oe=.5*(2+h),te=ce-te;break}ie=Ce-2*fe,Ee=Me-2*Ie,te=3*ve,oe=3*De,Ve=+S[a>>2],He=+S[A>>2],Ue=ve+ie,Se=De+Ee,Ge=te+Ce,Re=oe+Me,ie=te+ie,Ee=oe+Ee,oe=.5*(2+h),te=.5*(me+-1);break}if(t=me<=0,X){if(t){Ve=(He=(0|(Y=(we=(0|F)==(0|(we=~~ae))?w:we)+1|0))/L)*fe+Ce-(Ue=2*ve),He=He*Ie+Me-(Se=2*De),Ue=(Ge=(oe=+(0|we))/L)*fe+Ce-Ue,Se=Ge*Ie+Me-Se,Ge=+S[P+(Y<<3)>>2],Re=+S[P+(Y<<3)+4>>2],ie=+S[P+(we<<3)>>2],Ee=+S[P+(we<<3)+4>>2],oe=ae-oe,te=.5*(me+2);break}if(Y){e[H>>2]=_e,Fe[H+8>>3]=h,Fe[H+16>>3]=me,he(0,2135,H);break}Ee=(oe=+(0|(we=(0|F)==(0|(we=~~ae))?w:we)))/L,Re=(0|(Y=we+1|0))/L,we=we+v|0,ie=3*ve,te=3*De,Ve=+S[P+((Y=Y+v|0)<<3)>>2],He=+S[P+(Y<<3)+4>>2],Ue=+S[P+(we<<3)>>2],Se=+S[P+(we<<3)+4>>2],Ge=ie+(Re*fe+Ce),Re=te+(Re*Ie+Me),ie+=Ee*fe+Ce,Ee=te+(Ee*Ie+Me),oe=ae-oe,te=.5*(me+-1);break}if(t){Ve=(Ge=3*fe+Ce)-(Ue=2*ve),He=(Re=3*Ie+Me)-(Se=2*De),Ue=fe+Ce-Ue,Se=Ie+Me-Se,ie=+S[c>>2],Ee=+S[f>>2],oe=.5*(h-1),te=.5*(me+2);break}if(Y){He=(te=+(0|(Y=(0|M)==(0|(Y=~~ce))?I:Y)))/U,ie=(0|(we=Y+1|0))/U,Y=(0|et(Y,V))+F|0,we=(0|et(we,V))+F|0,Ve=He*ve+(Ge=3*fe+Ce),He=He*De+(Re=3*Ie+Me),Ue=+S[P+(Y<<3)>>2],Se=+S[P+(Y<<3)+4>>2],Ge=ie*ve+Ge,Re=ie*De+Re,ie=+S[P+(we<<3)>>2],Ee=+S[P+(we<<3)+4>>2],oe=.5*(h-1),te=ce-te;break}ie=3*ve,Ee=3*De,Ve=ve+(Ge=3*fe+Ce),He=De+(Re=3*Ie+Me),Ue=+S[d>>2],Se=+S[_>>2],Ge=ie+Ge,Re=Ee+Re,ie+=fe+Ce,Ee+=Ie+Me,oe=.5*(h-1),te=.5*(me+-1);break}while(0);if(oe+te<=1){S[n+(_e<<3)>>2]=Ue+(Ve-Ue)*oe+(ie-Ue)*te,me=Se+(He-Se)*oe,ae=(Ee-Se)*te;break}me=1-oe,ae=1-te,S[n+(_e<<3)>>2]=Ge+(ie-Ge)*me+(Ve-Ge)*ae,me=Re+(Ee-Re)*me,ae*=He-Re;break}while(0);S[n+(_e<<3)+4>>2]=me+ae,_e=_e+1|0}while((0|_e)!=(0|g));x=$t}},function(t,r,n,g){r|=0,n|=0,g|=0;var h,c,a,d,u,f,A=3.1415927410125732*(+S[(t|=0)>>2]+ +S[t+20>>2])/180,_=+si(+A);if(A=+It(+A),c=+S[t+8>>2],a=(h=(0|e[t+24>>2])==0?1:-1)*(A*=c),c=(_*=c)*(f=(0|e[t+28>>2])==0?1:-1),_*=h,f*=A,A=+S[t+12>>2],h=+S[t+16>>2],!((0|g)<=0))for(t=0;u=+S[r+(t<<3)>>2],d=+S[r+(t<<3)+4>>2],S[n+(t<<3)>>2]=a*u-c*d+A,S[n+(t<<3)+4>>2]=_*u+f*d+h,(0|(t=t+1|0))!=(0|g););}];return{___errno_location:function(){return 3444},___muldi3:lr,___udivdi3:ur,_bitshift64Lshr:Ni,_bitshift64Shl:m0,_csmFree:function(t){or(t|=0)},_csmGetDrawableConstantFlags:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[872+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1722,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableCount:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+200>>2],x=n,0|r):(e[r>>2]=1684,e[r+4>>2]=1258,he(0,1116,r),x=n,0|(r=-1))},_csmGetDrawableDrawOrders:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+268>>2],x=n,0|r):(e[r>>2]=1806,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableDynamicFlags:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+260>>2],x=n,0|r):(e[r>>2]=1750,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableIds:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[820+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1704,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableIndexCounts:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[888+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=2008,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableIndices:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[828+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=2034,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableMaskCounts:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[896+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1882,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableMasks:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[832+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1907,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableOpacities:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+276>>2],x=n,0|r):(e[r>>2]=1858,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableRenderOrders:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+264>>2],x=n,0|r):(e[r>>2]=1831,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableTextureIndices:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[868+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1777,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableVertexCounts:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[876+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1927,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableVertexPositions:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+272>>2],x=n,0|r):(e[r>>2]=1954,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetDrawableVertexUvs:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[824+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1984,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetLatestMocVersion:function(){return 3},_csmGetMocVersion:function(t,r){r|=0;var n=x;return x=x+16|0,r=n,(t|=0)?(t=0|Ts(t),x=n,0|t):(e[r>>2]=1133,e[r+4>>2]=1150,he(0,1116,r),x=n,(t=0)|t)},_csmGetParameterCount:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+292>>2],x=n,0|r):(e[r>>2]=1457,e[r+4>>2]=1258,he(0,1116,r),x=n,0|(r=-1))},_csmGetParameterDefaultValues:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[916+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1555,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetParameterIds:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[900+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1478,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetParameterKeyCounts:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+384>>2],x=n,0|r):(e[r>>2]=2085,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetParameterKeyValues:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+388>>2],x=n,0|r):(e[r>>2]=2110,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetParameterMaximumValues:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[908+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1526,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetParameterMinimumValues:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[912+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1497,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetParameterValues:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+300>>2],x=n,0|r):(e[r>>2]=1584,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetPartCount:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+4>>2],x=n,0|r):(e[r>>2]=1606,e[r+4>>2]=1258,he(0,1116,r),x=n,0|(r=-1))},_csmGetPartIds:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[712+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1622,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetPartOpacities:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[t+52>>2],x=n,0|r):(e[r>>2]=1636,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetPartParentPartIndices:function(t){var r=0,n=x;return x=x+16|0,r=n,(t|=0)?(r=0|e[740+(0|e[t>>2])>>2],x=n,0|r):(e[r>>2]=1656,e[r+4>>2]=1258,he(0,1116,r),x=n,(r=0)|r)},_csmGetSizeofModel:$r,_csmGetVersion:function(){return 67174400},_csmInitializeModelInPlace:Kr,_csmMalloc:function(t){return 0|ar(t|=0)},_csmMallocMoc:function(t){var r,n=x;return x=x+16|0,d0(r=n,64,t|=0),x=n,0|e[r>>2]},_csmMallocModelAndInitialize:function(t){var r=0,n=0,g=x;return x=x+16|0,r=g,(0|(t|=0))!=0&&(0|d0(r,16,n=0|$r(t)))==0?(r=0|Kr(t,t=0|e[r>>2],n))||(or(t),r=0):r=0,x=g,0|r},_csmReadCanvasInfo:function(t,r,n,g){r|=0,n|=0,g|=0;var h,c,a,d=0,u=x;return x=x+32|0,c=u+24|0,d=u+16|0,a=u+8|0,h=u,(t|=0)?r?n?g?(d=0|e[708+(0|e[t>>2])>>2],e[r>>2]=e[d+12>>2],e[r+4>>2]=e[d+16>>2],e[n>>2]=e[d+4>>2],e[n+4>>2]=e[d+8>>2],e[g>>2]=e[d>>2]):(e[c>>2]=1240,e[4+c>>2]=1334,he(0,1116,c)):(e[d>>2]=1240,e[d+4>>2]=1305,he(0,1116,d)):(e[a>>2]=1240,e[4+a>>2]=1278,he(0,1116,a)):(e[h>>2]=1240,e[h+4>>2]=1258,he(0,1116,h)),void(x=u)},_csmResetDrawableDynamicFlags:function(t){var r,n=x;return x=x+16|0,r=n,(t|=0)?e[t+256>>2]=1:(e[r>>2]=2056,e[r+4>>2]=1258,he(0,1116,r)),void(x=n)},_csmReviveMocInPlace:function(t,r){r|=0;var n,g=0,h=0,c=x;return x=x+32|0,h=c+16|0,n=c+8|0,g=c,(t|=0)?((g=t)+63&-64|0)!=(0|g)?(e[n>>2]=1169,e[4+n>>2]=1189,he(0,1116,n),x=c,(h=0)|h):0|r&&(r+63&-64|0)==(0|r)?(h=0|Ds(t),x=c,0|h):(e[h>>2]=1169,e[h+4>>2]=1221,he(0,1116,h),x=c,(h=0)|h):(e[g>>2]=1169,e[g+4>>2]=1150,he(0,1116,g),x=c,(h=0)|h)},_csmSetLogFunction:function(t){t|=0,e[860]=t},_csmUpdateModel:function(t){var r,n=x;return x=x+16|0,r=n,(t|=0)?Qr(t):(e[r>>2]=1442,e[r+4>>2]=1258,he(0,1116,r)),void(x=n)},_emscripten_get_sbrk_ptr:function(){return 4032},_emscripten_replace_memory:function(t){return B=new Int8Array(t),ze=new Uint8Array(t),Le=new Int16Array(t),ct=new Uint16Array(t),e=new Int32Array(t),S=new Float32Array(t),Fe=new Float64Array(t),!0},_free:or,_i64Add:vi,_i64Subtract:Gi,_malloc:ar,_memcpy:Dt,_memset:Ct,dynCall_ii:function(t,r){return r|=0,0|Gs[3&(t|=0)](0|r)},dynCall_iiii:function(t,r,n,g){return r|=0,n|=0,g|=0,0|ji[3&(t|=0)](0|r,0|n,0|g)},dynCall_iiiii:function(t,r,n,g,h){return r|=0,n|=0,g|=0,h|=0,0|Ns[3&(t|=0)](0|r,0|n,0|g,0|h)},dynCall_vi:function(t,r){r|=0,_0[1&(t|=0)](0|r)},dynCall_viii:function(t,r,n,g){r|=0,n|=0,g|=0,A0[3&(t|=0)](0|r,0|n,0|g)},dynCall_viiii:function(t,r,n,g,h){r|=0,n|=0,g|=0,h|=0,qt[3&(t|=0)](0|r,0|n,0|g,0|h)},establishStackSpace:function(t,r){x=t|=0},stackAlloc:function(t){var r=x;return x=15+(x=x+(t|=0)|0)&-16,0|r},stackRestore:function(t){x=t|=0},stackSave:function(){return 0|x}}}({Math,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Float32Array,Float64Array},{a:pi,b:function(T){Lr=T},c:function(){return Lr},d:function(T,O){return Lt[T](O)},e:function(T,O,Z,B){return Lt[T](O,Z,B)},f:function(T,O,Z,B,Le){return Lt[T](O,Z,B,Le)},g:function(T,O){Lt[T](O)},h:function(T,O,Z,B){Lt[T](O,Z,B)},i:function(T,O,Z,B,Le){Lt[T](O,Z,B,Le)},j:function(){return Wr.apply(null,arguments)},k:Hr,l:function(T,O,Z){Rt.set(Rt.subarray(O,O+Z),T)},m:function(T){if(2130706432<T)return!1;for(var O=Math.max(Hr(),16777216);O<T;)O=O<=536870912?Ur(2*O):Math.min(Ur((3*O+2147483648)/4),2130706432);return!!Yr(O)},n:Wr,o:function(){pi("OOM")},p:function(T){return T},q:zr,r:Yr,s:function(){var T=m._fflush;T&&T(0),er[1].length&&tr(1,10),er[2].length&&tr(2,10)},t:Xr,u:function(){var T=Xr();return m.extraStackTrace&&(T+=`
`+m.extraStackTrace()),zr(T)},v:4224},Fi),m.___errno_location=j.___errno_location,m.___muldi3=j.___muldi3,m.___udivdi3=j.___udivdi3,m._bitshift64Lshr=j._bitshift64Lshr,m._bitshift64Shl=j._bitshift64Shl,m._csmFree=j._csmFree,m._csmGetDrawableConstantFlags=j._csmGetDrawableConstantFlags,m._csmGetDrawableCount=j._csmGetDrawableCount,m._csmGetDrawableDrawOrders=j._csmGetDrawableDrawOrders,m._csmGetDrawableDynamicFlags=j._csmGetDrawableDynamicFlags,m._csmGetDrawableIds=j._csmGetDrawableIds,m._csmGetDrawableIndexCounts=j._csmGetDrawableIndexCounts,m._csmGetDrawableIndices=j._csmGetDrawableIndices,m._csmGetDrawableMaskCounts=j._csmGetDrawableMaskCounts,m._csmGetDrawableMasks=j._csmGetDrawableMasks,m._csmGetDrawableOpacities=j._csmGetDrawableOpacities,m._csmGetDrawableRenderOrders=j._csmGetDrawableRenderOrders,m._csmGetDrawableTextureIndices=j._csmGetDrawableTextureIndices,m._csmGetDrawableVertexCounts=j._csmGetDrawableVertexCounts,m._csmGetDrawableVertexPositions=j._csmGetDrawableVertexPositions,m._csmGetDrawableVertexUvs=j._csmGetDrawableVertexUvs,m._csmGetLatestMocVersion=j._csmGetLatestMocVersion,m._csmGetMocVersion=j._csmGetMocVersion,m._csmGetParameterCount=j._csmGetParameterCount,m._csmGetParameterDefaultValues=j._csmGetParameterDefaultValues,m._csmGetParameterIds=j._csmGetParameterIds,m._csmGetParameterKeyCounts=j._csmGetParameterKeyCounts,m._csmGetParameterKeyValues=j._csmGetParameterKeyValues,m._csmGetParameterMaximumValues=j._csmGetParameterMaximumValues,m._csmGetParameterMinimumValues=j._csmGetParameterMinimumValues,m._csmGetParameterValues=j._csmGetParameterValues,m._csmGetPartCount=j._csmGetPartCount,m._csmGetPartIds=j._csmGetPartIds,m._csmGetPartOpacities=j._csmGetPartOpacities,m._csmGetPartParentPartIndices=j._csmGetPartParentPartIndices,m._csmGetSizeofModel=j._csmGetSizeofModel,m._csmGetVersion=j._csmGetVersion,m._csmInitializeModelInPlace=j._csmInitializeModelInPlace,m._csmMalloc=j._csmMalloc,m._csmMallocMoc=j._csmMallocMoc,m._csmMallocModelAndInitialize=j._csmMallocModelAndInitialize,m._csmReadCanvasInfo=j._csmReadCanvasInfo,m._csmResetDrawableDynamicFlags=j._csmResetDrawableDynamicFlags,m._csmReviveMocInPlace=j._csmReviveMocInPlace,m._csmSetLogFunction=j._csmSetLogFunction,m._csmUpdateModel=j._csmUpdateModel,m._emscripten_get_sbrk_ptr=j._emscripten_get_sbrk_ptr;var ps=m._emscripten_replace_memory=j._emscripten_replace_memory;m._free=j._free,m._i64Add=j._i64Add,m._i64Subtract=j._i64Subtract,m._malloc=j._malloc,m._memcpy=j._memcpy,m._memset=j._memset,m.establishStackSpace=j.establishStackSpace;var Bi,ir,Wt,Ai,Jr=m.stackAlloc=j.stackAlloc,_s=m.stackRestore=j.stackRestore,As=m.stackSave=j.stackSave;function rr(){function T(){if(!Ai&&(Ai=!0,!Rr)){if(Ri(ds),Ri(fs),m.onRuntimeInitialized&&m.onRuntimeInitialized(),m.postRun)for(typeof m.postRun=="function"&&(m.postRun=[m.postRun]);m.postRun.length;){var O=m.postRun.shift();jr.unshift(O)}Ri(jr)}}if(!(0<Xt)){if(m.preRun)for(typeof m.preRun=="function"&&(m.preRun=[m.preRun]);m.preRun.length;)(function(){var O=m.preRun.shift();Nr.unshift(O)})();Ri(Nr),0<Xt||(m.setStatus?(m.setStatus("Running..."),setTimeout(function(){setTimeout(function(){m.setStatus("")},1),T()},1)):T())}}if(m.dynCall_ii=j.dynCall_ii,m.dynCall_iiii=j.dynCall_iiii,m.dynCall_iiiii=j.dynCall_iiiii,m.dynCall_vi=j.dynCall_vi,m.dynCall_viii=j.dynCall_viii,m.dynCall_viiii=j.dynCall_viiii,m.asm=j,m.ccall=function(T,O,Z,B){var Le={string:function(Fe){var st=0;if(Fe!=null&&Fe!==0){var St=1+(Fe.length<<2),ft=st=Jr(St),It=Rt;if(0<St){St=ft+St-1;for(var si=0;si<Fe.length;++si){var lt=Fe.charCodeAt(si);if(55296<=lt&&lt<=57343&&(lt=65536+((1023&lt)<<10)|1023&Fe.charCodeAt(++si)),lt<=127){if(St<=ft)break;It[ft++]=lt}else{if(lt<=2047){if(St<=ft+1)break;It[ft++]=192|lt>>6}else{if(lt<=65535){if(St<=ft+2)break;It[ft++]=224|lt>>12}else{if(St<=ft+3)break;It[ft++]=240|lt>>18,It[ft++]=128|lt>>12&63}It[ft++]=128|lt>>6&63}It[ft++]=128|63&lt}}It[ft]=0}}return st},array:function(Fe){var st=Jr(Fe.length);return Li.set(Fe,st),st}},e=function(Fe){var st=m["_"+Fe];return Ei(st,"Cannot call unknown function "+Fe+", make sure it is exported"),st}(T),ze=[];if(T=0,B)for(var ct=0;ct<B.length;ct++){var S=Le[Z[ct]];S?(T===0&&(T=As()),ze[ct]=S(B[ct])):ze[ct]=B[ct]}return Z=function(Fe){return O==="string"?Vr(Fe):O==="boolean"?!!Fe:Fe}(Z=e.apply(null,ze)),T!==0&&_s(T),Z},m.UTF8ToString=Vr,m.addFunction=function(T){for(var O=0;O<1;O++)if(!Lt[O])return Lt[O]=T,1+O;throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},Mt&&((String.prototype.startsWith?Mt.startsWith(_i):Mt.indexOf(_i)===0)||(j=Mt,Mt=m.locateFile?m.locateFile(j,dt):dt+j),be||je?(Wt=de(Mt),Rt.set(Wt,8)):(Xt++,m.monitorRunDependencies&&m.monitorRunDependencies(Xt),Bi=function(T){T.byteLength&&(T=new Uint8Array(T)),Rt.set(T,8),m.memoryInitializerRequest&&delete m.memoryInitializerRequest.response,Xt--,m.monitorRunDependencies&&m.monitorRunDependencies(Xt),Xt==0&&gi&&(T=gi,gi=null,T())},ir=function(){J(function(){throw"could not load memory initializer "+Mt})},(Wt=Bt(Mt))?Bi(Wt.buffer):m.memoryInitializerRequest?(Wt=function(){var T=m.memoryInitializerRequest,O=T.response;if(T.status!==200&&T.status!==0){if(!(O=Bt(m.memoryInitializerRequestURL)))return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+T.status+", retrying "+Mt),void ir();O=O.buffer}Bi(O)},m.memoryInitializerRequest.response?setTimeout(Wt,0):m.memoryInitializerRequest.addEventListener("load",Wt)):ir())),m.then=function(T){var O;return Ai?T(m):(O=m.onRuntimeInitialized,m.onRuntimeInitialized=function(){O&&O(),T(m)}),m},gi=function T(){Ai||rr(),Ai||(gi=T)},m.run=rr,m.preInit)for(typeof m.preInit=="function"&&(m.preInit=[m.preInit]);0<m.preInit.length;)m.preInit.pop()();return rr(),D});typeof Qi=="object"&&typeof Fr=="object"?Fr.exports=R:typeof define=="function"&&define.amd?define([],function(){return R}):typeof Qi=="object"&&(Qi._em_module=R);var k=R()})(Live2DCubismCore=Live2DCubismCore||{});class T0 extends Ys{constructor(){super(...arguments);this.name="Live2D",this.resource=""}init(i){Object.assign(this,i)}}T0.componentName="Live2D";const E0=2,F0=2;var _t;(function(l){l.LOG_LEVEL_VERBOSE=0,l.LOG_LEVEL_WARNING=1,l.LOG_LEVEL_ERROR=2,l.LOG_LEVEL_NONE=999,l.logLevel=l.LOG_LEVEL_WARNING,l.sound=!0,l.motionSync=!0,l.motionFadingDuration=500,l.idleMotionFadingDuration=2e3,l.expressionFadingDuration=500})(_t||(_t={}));var Ne;(function(l){function i(p,...y){_t.logLevel<=_t.LOG_LEVEL_VERBOSE&&console.log(`[${p}]`,...y)}l.log=i;function s(p,...y){_t.logLevel<=_t.LOG_LEVEL_WARNING&&console.warn(`[${p}]`,...y)}l.warn=s;function o(p,...y){_t.logLevel<=_t.LOG_LEVEL_ERROR&&console.error(`[${p}]`,...y)}l.error=o})(Ne||(Ne={}));function L0(l,i,s){return l<i?i:l>s?s:l}function R0(l,i){i.forEach(s=>{Object.getOwnPropertyNames(s.prototype).forEach(o=>{o!=="constructor"&&Object.defineProperty(l.prototype,o,Object.getOwnPropertyDescriptor(s.prototype,o))})})}function tn(l){let i=l.lastIndexOf("/");return i!=-1&&(l=l.slice(0,i)),i=l.lastIndexOf("/"),i!==-1&&(l=l.slice(i+1)),l}class B0 extends cr{constructor(i,s){super();this.expressions=[],this.reserveExpressionIndex=-1,this.destroyed=!1,this.settings=i,this.tag=`ExpressionManager(${i.name})`}init(){this.defaultExpression=this.createExpression({},void 0),this.currentExpression=this.defaultExpression,this.stopAllExpressions()}async loadExpression(i){if(!this.definitions[i]){Ne.warn(this.tag,`Undefined expression at [${i}]`);return}if(this.expressions[i]===null){Ne.warn(this.tag,`Cannot set expression at [${i}] because it's already failed in loading.`);return}if(this.expressions[i])return this.expressions[i];const s=await this._loadExpression(i);return this.expressions[i]=s,s}_loadExpression(i){throw new Error("Not implemented.")}async setRandomExpression(){if(this.definitions.length){const i=[];for(let s=0;s<this.definitions.length;s++)this.expressions[s]!==null&&this.expressions[s]!==this.currentExpression&&s!==this.reserveExpressionIndex&&i.push(s);if(i.length){const s=Math.floor(Math.random()*i.length);return this.setExpression(s)}}return!1}resetExpression(){this._setExpression(this.defaultExpression)}restoreExpression(){this._setExpression(this.currentExpression)}async setExpression(i){if(typeof i!="number"&&(i=this.getExpressionIndex(i)),!(i>-1&&i<this.definitions.length)||i===this.expressions.indexOf(this.currentExpression))return!1;this.reserveExpressionIndex=i;const s=await this.loadExpression(i);return!s||this.reserveExpressionIndex!==i?!1:(this.reserveExpressionIndex=-1,this.currentExpression=s,this._setExpression(s),!0)}update(i,s){return this.isFinished()?!1:this.updateParameters(i,s)}destroy(){this.destroyed=!0,this.emit("destroy");const i=this;i.definitions=void 0,i.expressions=void 0}}const O0=.01,rn=40/7.5,sn=1/(.15*1e3);class nn{constructor(){this.targetX=0,this.targetY=0,this.x=0,this.y=0,this.vx=0,this.vy=0}focus(i,s,o=!1){this.targetX=L0(i,-1,1),this.targetY=L0(s,-1,1),o&&(this.x=this.targetX,this.y=this.targetY)}update(i){const s=this.targetX-this.x,o=this.targetY-this.y;if(Math.abs(s)<O0&&Math.abs(o)<O0)return;const p=Math.sqrt(s**2+o**2),y=rn/(1e3/i);let C=y*(s/p)-this.vx,b=y*(o/p)-this.vy;const R=Math.sqrt(C**2+b**2),k=y*sn*i;R>k&&(C*=k/R,b*=k/R),this.vx+=C,this.vy+=b;const D=Math.sqrt(this.vx**2+this.vy**2),m=.5*(Math.sqrt(k**2+8*k*p)-k);D>m&&(this.vx*=m/D,this.vy*=m/D),this.x+=this.vx,this.y+=this.vy}}class gr{constructor(i){this.json=i;let s=i.url;if(typeof s!="string")throw new TypeError("The `url` field in settings JSON must be defined as a string.");this.url=s,this.name=tn(this.url)}resolveURL(i){return dr.resolve(this.url,i)}replaceFiles(i){this.moc=i(this.moc,"moc"),this.pose!==void 0&&(this.pose=i(this.pose,"pose")),this.physics!==void 0&&(this.physics=i(this.physics,"physics"));for(let s=0;s<this.textures.length;s++)this.textures[s]=i(this.textures[s],`textures[${s}]`)}getDefinedFiles(){const i=[];return this.replaceFiles(s=>(i.push(s),s)),i}validateFiles(i){const s=(y,C)=>{const b=this.resolveURL(y);if(!i.includes(b)){if(C)throw new Error(`File "${y}" is defined in settings, but doesn't exist in given files`);return!1}return!0};return[this.moc,...this.textures].forEach(y=>s(y,!0)),this.getDefinedFiles().filter(y=>s(y,!1))}}var zi;(function(l){l[l.NONE=0]="NONE",l[l.IDLE=1]="IDLE",l[l.NORMAL=2]="NORMAL",l[l.FORCE=3]="FORCE"})(zi||(zi={}));class an{constructor(){this.debug=!1,this.currentPriority=0,this.reservePriority=0}reserve(i,s,o){if(o<=0)return Ne.log(this.tag,"Cannot start a motion with MotionPriority.NONE."),!1;if(i===this.currentGroup&&s===this.currentIndex)return Ne.log(this.tag,"Motion is already playing.",this.dump(i,s)),!1;if(i===this.reservedGroup&&s===this.reservedIndex||i===this.reservedIdleGroup&&s===this.reservedIdleIndex)return Ne.log(this.tag,"Motion is already reserved.",this.dump(i,s)),!1;if(o===1){if(this.currentPriority!==0)return Ne.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(i,s)),!1;if(this.reservedIdleGroup!==void 0)return Ne.log(this.tag,"Cannot start idle motion because another idle motion has reserved.",this.dump(i,s)),!1;this.setReservedIdle(i,s)}else{if(o<3){if(o<=this.currentPriority)return Ne.log(this.tag,"Cannot start motion because another motion is playing as an equivalent or higher priority.",this.dump(i,s)),!1;if(o<=this.reservePriority)return Ne.log(this.tag,"Cannot start motion because another motion has reserved as an equivalent or higher priority.",this.dump(i,s)),!1}this.setReserved(i,s,o)}return!0}start(i,s,o,p){if(p===1){if(this.setReservedIdle(void 0,void 0),this.currentPriority!==0)return Ne.log(this.tag,"Cannot start idle motion because another motion is playing.",this.dump(s,o)),!1}else{if(s!==this.reservedGroup||o!==this.reservedIndex)return Ne.log(this.tag,"Cannot start motion because another motion has taken the place.",this.dump(s,o)),!1;this.setReserved(void 0,void 0,0)}return i?(this.setCurrent(s,o,p),!0):!1}complete(){this.setCurrent(void 0,void 0,0)}setCurrent(i,s,o){this.currentPriority=o,this.currentGroup=i,this.currentIndex=s}setReserved(i,s,o){this.reservePriority=o,this.reservedGroup=i,this.reservedIndex=s}setReservedIdle(i,s){this.reservedIdleGroup=i,this.reservedIdleIndex=s}isActive(i,s){return i===this.currentGroup&&s===this.currentIndex||i===this.reservedGroup&&s===this.reservedIndex||i===this.reservedIdleGroup&&s===this.reservedIdleIndex}reset(){this.setCurrent(void 0,void 0,0),this.setReserved(void 0,void 0,0),this.setReservedIdle(void 0,void 0)}shouldRequestIdleMotion(){return this.currentGroup===void 0&&this.reservedIdleGroup===void 0}shouldOverrideExpression(){return this.currentPriority>1}dump(i,s){if(this.debug){const o=["currentPriority","reservePriority","currentGroup","currentIndex","reservedGroup","reservedIndex","reservedIdleGroup","reservedIdleIndex"];return`
<Requested> group = "${i}", index = ${s}
`+o.map(p=>"["+p+"] "+this[p]).join(`
`)}return""}}const on="SoundManager",ln=.5;class ti{static get volume(){return this._volume}static set volume(i){this._volume=(i>1?1:i<0?0:i)||0,this.audios.forEach(s=>s.volume=this._volume)}static add(i,s,o){const p=new Audio(i);return p.volume=this._volume,p.preload="auto",p.addEventListener("ended",()=>{this.dispose(p),s==null||s()}),p.addEventListener("error",y=>{this.dispose(p),Ne.warn(on,`Error occurred on "${i}"`,y.error),o==null||o(y.error)}),this.audios.push(p),p}static play(i){return new Promise((s,o)=>{var p;(p=i.play())==null||p.catch(y=>{i.dispatchEvent(new ErrorEvent("error",{error:y})),o(y)}),i.readyState===i.HAVE_ENOUGH_DATA?s():i.addEventListener("canplaythrough",s)})}static dispose(i){i.pause(),i.removeAttribute("src"),Zs(this.audios,i)}static destroy(){for(let i=this.audios.length-1;i>=0;i--)this.dispose(this.audios[i])}}ti.audios=[];ti._volume=ln;var Mi;(function(l){l.ALL="ALL",l.IDLE="IDLE",l.NONE="NONE"})(Mi||(Mi={}));class pr extends cr{constructor(i,s){super();this.motionGroups={},this.state=new an,this.playing=!1,this.destroyed=!1,this.settings=i,this.tag=`MotionManager(${i.name})`,this.state.tag=this.tag}init(i){(i==null?void 0:i.idleMotionGroup)&&(this.groups.idle=i.idleMotionGroup),this.setupMotions(i),this.stopAllMotions()}setupMotions(i){for(const o of Object.keys(this.definitions))this.motionGroups[o]=[];let s;switch(i==null?void 0:i.motionPreload){case Mi.NONE:return;case Mi.ALL:s=Object.keys(this.definitions);break;case Mi.IDLE:default:s=[this.groups.idle];break}for(const o of s)if(this.definitions[o])for(let p=0;p<this.definitions[o].length;p++)this.loadMotion(o,p).then()}async loadMotion(i,s){var p;if(!((p=this.definitions[i])==null?void 0:p[s])){Ne.warn(this.tag,`Undefined motion at "${i}"[${s}]`);return}if(this.motionGroups[i][s]===null){Ne.warn(this.tag,`Cannot start motion at "${i}"[${s}] because it's already failed in loading.`);return}if(this.motionGroups[i][s])return this.motionGroups[i][s];const o=await this._loadMotion(i,s);if(!this.destroyed)return this.motionGroups[i][s]=o!=null?o:null,o}_loadMotion(i,s){throw new Error("Not implemented.")}async startMotion(i,s,o=zi.NORMAL){var b;if(!this.state.reserve(i,s,o))return!1;const p=(b=this.definitions[i])==null?void 0:b[s];if(!p)return!1;this.currentAudio&&ti.dispose(this.currentAudio);let y;if(_t.sound){const R=this.getSoundFile(p);if(R)try{y=ti.add(this.settings.resolveURL(R),()=>this.currentAudio=void 0,()=>this.currentAudio=void 0),this.currentAudio=y}catch(k){Ne.warn(this.tag,"Failed to create audio",R,k)}}const C=await this.loadMotion(i,s);if(y){const R=ti.play(y).catch(k=>Ne.warn(this.tag,"Failed to play audio",y.src,k));_t.motionSync&&await R}return this.state.start(C,i,s,o)?(Ne.log(this.tag,"Start motion:",this.getMotionName(p)),this.emit("motionStart",i,s,y),this.state.shouldOverrideExpression()&&this.expressionManager&&this.expressionManager.resetExpression(),this.playing=!0,this._startMotion(C),!0):(y&&(ti.dispose(y),this.currentAudio=void 0),!1)}async startRandomMotion(i,s){const o=this.definitions[i];if(o==null?void 0:o.length){const p=[];for(let y=0;y<o.length;y++)this.motionGroups[i][y]!==null&&!this.state.isActive(i,y)&&p.push(y);if(p.length){const y=Math.floor(Math.random()*p.length);return this.startMotion(i,p[y],s)}}return!1}stopAllMotions(){this._stopAllMotions(),this.state.reset(),this.currentAudio&&(ti.dispose(this.currentAudio),this.currentAudio=void 0)}update(i,s){var p,y;this.isFinished()&&(this.playing&&(this.playing=!1,this.emit("motionFinish")),this.state.shouldOverrideExpression()&&((p=this.expressionManager)==null||p.restoreExpression()),this.state.complete(),this.state.shouldRequestIdleMotion()&&this.startRandomMotion(this.groups.idle,zi.IDLE));let o=this.updateParameters(i,s);return o=((y=this.expressionManager)==null?void 0:y.update(i,s))||o,o}destroy(){var s;this.destroyed=!0,this.emit("destroy"),this.stopAllMotions(),(s=this.expressionManager)==null||s.destroy();const i=this;i.definitions=void 0,i.motionGroups=void 0}}const un={x:0,y:0,width:0,height:0};class hn extends cr{constructor(){super(...arguments);this.focusController=new nn,this.originalWidth=0,this.originalHeight=0,this.width=0,this.height=0,this.localTransform=new Et.Matrix,this.drawingMatrix=new Et.Matrix,this.hitAreas={},this.textureFlipY=!1,this.viewport=[0,0,0,0],this.destroyed=!1}init(){this.setupLayout(),this.setupHitAreas()}setupLayout(){const i=this,s=this.getSize();i.originalWidth=s[0],i.originalHeight=s[1];const o=Object.assign({width:E0,height:F0},this.getLayout());this.localTransform.scale(o.width/E0,o.height/F0),i.width=this.originalWidth*this.localTransform.a,i.height=this.originalHeight*this.localTransform.d;const p=o.x!==void 0&&o.x-o.width/2||o.centerX!==void 0&&o.centerX||o.left!==void 0&&o.left-o.width/2||o.right!==void 0&&o.right+o.width/2||0,y=o.y!==void 0&&o.y-o.height/2||o.centerY!==void 0&&o.centerY||o.top!==void 0&&o.top-o.height/2||o.bottom!==void 0&&o.bottom+o.height/2||0;this.localTransform.translate(this.width*p,-this.height*y)}setupHitAreas(){const i=this.getHitAreaDefs().filter(s=>s.index>=0);for(const s of i)this.hitAreas[s.name]=s}hitTest(i,s){return Object.keys(this.hitAreas).filter(o=>this.isHit(o,i,s))}isHit(i,s,o){if(!this.hitAreas[i])return!1;const p=this.hitAreas[i].index,y=this.getDrawableBounds(p,un);return y.x<=s&&s<=y.x+y.width&&y.y<=o&&o<=y.y+y.height}getDrawableBounds(i,s){const o=this.getDrawableVertices(i);let p=o[0],y=o[0],C=o[1],b=o[1];for(let R=0;R<o.length;R+=2){const k=o[R],D=o[R+1];p=Math.min(k,p),y=Math.max(k,y),C=Math.min(D,C),b=Math.max(D,b)}return s={},s.x=p,s.y=C,s.width=y-p,s.height=b-C,s}updateTransform(i){i.copy(this.drawingMatrix).append(this.localTransform)}update(i,s){this.focusController.update(i)}destroy(){this.destroyed=!0,this.emit("destroy"),this.motionManager.destroy(),this.motionManager=void 0}}const cn="XHRLoader";class V0 extends Error{constructor(i,s,o,p=!1){super(i);this.url=s,this.status=o,this.aborted=p}}const gt=class{static createXHR(l,i,s,o,p){const y=new XMLHttpRequest;if(gt.allXhrSet.add(y),l){let C=gt.xhrMap.get(l);C?C.add(y):(C=new Set([y]),gt.xhrMap.set(l,C)),l.listeners("destroy").includes(gt.cancelXHRs)||l.once("destroy",gt.cancelXHRs)}return y.open("GET",i),y.responseType=s,y.onload=()=>{(y.status===200||y.status===0)&&y.response?o(y.response):y.onerror()},y.onerror=()=>{Ne.warn(cn,`Failed to load resource as ${y.responseType} (Status ${y.status}): ${i}`),p(new V0("Network error.",i,y.status))},y.onabort=()=>p(new V0("Aborted.",i,y.status,!0)),y.onloadend=()=>{var C;gt.allXhrSet.delete(y),l&&((C=gt.xhrMap.get(l))==null||C.delete(y))},y}static cancelXHRs(){var l;(l=gt.xhrMap.get(this))==null||l.forEach(i=>{i.abort(),gt.allXhrSet.delete(i)}),gt.xhrMap.delete(this)}static release(){gt.allXhrSet.forEach(l=>l.abort()),gt.allXhrSet.clear(),gt.xhrMap=new WeakMap}};let Xi=gt;Xi.xhrMap=new WeakMap;Xi.allXhrSet=new Set;Xi.loader=(l,i)=>new Promise((s,o)=>{gt.createXHR(l.target,l.settings?l.settings.resolveURL(l.url):l.url,l.type,y=>{l.result=y,s()},o).send()});function U0(l,i){let s=-1;return o(0);function o(p,y){if(y)return Promise.reject(y);if(p<=s)return Promise.reject(new Error("next() called multiple times"));s=p;const C=l[p];if(!C)return Promise.resolve();try{return Promise.resolve(C(i,o.bind(null,p+1)))}catch(b){return Promise.reject(b)}}}class Ot{static load(i){return U0(this.middlewares,i).then(()=>i.result)}}Ot.middlewares=[Xi.loader];function dn(l,i={}){var p;const s=Et.Texture.from(l);if(s.baseTexture.valid)return Promise.resolve(s);const o=s.baseTexture;return o._live2d_load=(p=o._live2d_load)!=null?p:new Promise((y,C)=>{const b=R=>{o.source.removeEventListener("error",b);const k=new Error("Texture loading error");k.event=R,C(k)};o.source.addEventListener("error",b),o.on("loaded",()=>y(s)),o.on("error",()=>b())}),o._live2d_load}const G0="Live2DFactory",N0=async(l,i)=>{if(typeof l.source=="string"){const s=await Ot.load({url:l.source,type:"json",target:l.live2dModel});s.url=l.source,l.source=s,l.live2dModel.emit("settingsJSONLoaded",s)}return i()},j0=async(l,i)=>{if(l.source instanceof gr)return l.settings=l.source,i();if(typeof l.source=="object"){const s=Qe.findRuntime(l.source);if(s){const o=s.createModelSettings(l.source);return l.settings=o,l.live2dModel.emit("settingsLoaded",o),i()}}throw new TypeError("Unknown settings format.")},z0=(l,i)=>{if(l.settings){const s=Qe.findRuntime(l.settings);if(s)return s.ready().then(i)}return i()},X0=async(l,i)=>{await i();const s=l.internalModel;if(s){const o=l.settings,p=Qe.findRuntime(o);if(p){const y=[];o.pose&&y.push(Ot.load({settings:o,url:o.pose,type:"json",target:s}).then(C=>{s.pose=p.createPose(s.coreModel,C),l.live2dModel.emit("poseLoaded",s.pose)}).catch(C=>{l.live2dModel.emit("poseLoadError",C),Ne.warn(G0,"Failed to load pose.",C)})),o.physics&&y.push(Ot.load({settings:o,url:o.physics,type:"json",target:s}).then(C=>{s.physics=p.createPhysics(s.coreModel,C),l.live2dModel.emit("physicsLoaded",s.physics)}).catch(C=>{l.live2dModel.emit("physicsLoadError",C),Ne.warn(G0,"Failed to load physics.",C)})),y.length&&await Promise.all(y)}}},W0=async(l,i)=>{if(l.settings){const s=l.live2dModel,o=l.settings.textures.map(p=>{const y=l.settings.resolveURL(p);return dn(y,{crossOrigin:l.options.crossOrigin})});if(await i(),l.internalModel)s.internalModel=l.internalModel,s.emit("modelLoaded",l.internalModel);else throw new TypeError("Missing internal model.");s.textures=await Promise.all(o),s.emit("textureLoaded",s.textures)}else throw new TypeError("Missing settings.")},H0=async(l,i)=>{const s=l.settings;if(s instanceof gr){const o=Qe.findRuntime(s);if(!o)throw new TypeError("Unknown model settings.");const p=await Ot.load({settings:s,url:s.moc,type:"arraybuffer",target:l.live2dModel});if(!o.isValidMoc(p))throw new Error("Invalid moc data");const y=o.createCoreModel(p);return l.internalModel=o.createInternalModel(y,s,l.options),i()}throw new TypeError("Missing settings.")},ht=class{static registerRuntime(l){ht.runtimes.push(l),ht.runtimes.sort((i,s)=>s.version-i.version)}static findRuntime(l){for(const i of ht.runtimes)if(i.test(l))return i}static async setupLive2DModel(l,i,s){const o=new Promise(C=>l.once("textureLoaded",C)),p=new Promise(C=>l.once("modelLoaded",C)),y=Promise.all([o,p]).then(()=>l.emit("ready"));await U0(ht.live2DModelMiddlewares,{live2dModel:l,source:i,options:s||{}}),await y,l.emit("load")}static loadMotion(l,i,s){var p,y;const o=C=>l.emit("motionLoadError",i,s,C);try{const C=(p=l.definitions[i])==null?void 0:p[s];if(!C)return Promise.resolve(void 0);l.listeners("destroy").includes(ht.releaseTasks)||l.once("destroy",ht.releaseTasks);let b=ht.motionTasksMap.get(l);b||(b={},ht.motionTasksMap.set(l,b));let R=b[i];R||(R=[],b[i]=R);const k=l.getMotionFile(C);return R[s]=(y=R[s])!=null?y:Ot.load({url:k,settings:l.settings,type:l.motionDataType,target:l}).then(D=>{var q;const m=(q=ht.motionTasksMap.get(l))==null?void 0:q[i];m&&delete m[s];const N=l.createMotion(D,i,C);return l.emit("motionLoaded",i,s,N),N}).catch(D=>{Ne.warn(l.tag,`Failed to load motion: ${k}
`,D),o(D)}),R[s]}catch(C){Ne.warn(l.tag,`Failed to load motion at "${i}"[${s}]
`,C),o(C)}return Promise.resolve(void 0)}static loadExpression(l,i){var o;const s=p=>l.emit("expressionLoadError",i,p);try{const p=l.definitions[i];if(!p)return Promise.resolve(void 0);l.listeners("destroy").includes(ht.releaseTasks)||l.once("destroy",ht.releaseTasks);let y=ht.expressionTasksMap.get(l);y||(y=[],ht.expressionTasksMap.set(l,y));const C=l.getExpressionFile(p);return y[i]=(o=y[i])!=null?o:Ot.load({url:C,settings:l.settings,type:"json",target:l}).then(b=>{const R=ht.expressionTasksMap.get(l);R&&delete R[i];const k=l.createExpression(b,p);return l.emit("expressionLoaded",i,k),k}).catch(b=>{Ne.warn(l.tag,`Failed to load expression: ${C}
`,b),s(b)}),y[i]}catch(p){Ne.warn(l.tag,`Failed to load expression at [${i}]
`,p),s(p)}return Promise.resolve(void 0)}static releaseTasks(){this instanceof pr?ht.motionTasksMap.delete(this):ht.expressionTasksMap.delete(this)}};let Qe=ht;Qe.runtimes=[];Qe.urlToJSON=N0;Qe.jsonToSettings=j0;Qe.waitUntilReady=z0;Qe.setupOptionals=X0;Qe.setupEssentials=W0;Qe.createInternalModel=H0;Qe.live2DModelMiddlewares=[N0,j0,z0,X0,W0,H0];Qe.motionTasksMap=new WeakMap;Qe.expressionTasksMap=new WeakMap;pr.prototype._loadMotion=function(l,i){return Qe.loadMotion(this,l,i)};B0.prototype._loadExpression=function(l){return Qe.loadExpression(this,l)};class fn{constructor(){this._autoInteract=!1}get autoInteract(){return this._autoInteract}set autoInteract(i){i!==this._autoInteract&&(i?this.on("pointertap",Y0,this):this.off("pointertap",Y0,this),this._autoInteract=i)}registerInteraction(i){i!==this.interactionManager&&(this.unregisterInteraction(),this._autoInteract&&i&&(this.interactionManager=i,i.on("pointermove",Z0,this)))}unregisterInteraction(){var i;this.interactionManager&&((i=this.interactionManager)==null||i.off("pointermove",Z0,this),this.interactionManager=void 0)}}function Y0(l){this.tap(l.data.global.x,l.data.global.y)}function Z0(l){this.focus(l.data.global.x,l.data.global.y)}class mn extends Et.Transform{}const wt=new Et.Point,gn=new Et.Matrix;let ii;class Wi extends Et.Container{constructor(i){super();this.tag="Live2DModel(uninitialized)",this.textures=[],this.transform=new mn,this.anchor=new Et.ObservablePoint(this.onAnchorChange,this,0,0),this.glContextID=-1,this.elapsedTime=performance.now(),this.deltaTime=0,this._autoUpdate=!1,this.once("modelLoaded",()=>this.init(i))}static from(i,s){const o=new this(s);return Qe.setupLive2DModel(o,i,s).then(()=>o)}static fromSync(i,s){const o=new this(s);return Qe.setupLive2DModel(o,i,s).then(s==null?void 0:s.onLoad).catch(s==null?void 0:s.onError),o}static registerTicker(i){ii=i}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i?this._destroyed||(ii?(ii.add(()=>this.onTickerUpdate()),this._autoUpdate=!0):Ne.warn(this.tag,"No Ticker registered, please call Live2DModel.registerTicker(Ticker).")):(ii==null||ii.remove(this.onTickerUpdate,this),this._autoUpdate=!1)}init(i){this.tag=`Live2DModel(${this.internalModel.settings.name})`;const s=Object.assign({autoUpdate:!0,autoInteract:!0},i);s.autoInteract&&(this.interactive=!0),this.autoInteract=s.autoInteract,this.autoUpdate=s.autoUpdate}onAnchorChange(){this.pivot.set(this.anchor.x*this.internalModel.width,this.anchor.y*this.internalModel.height)}motion(i,s,o){return s===void 0?this.internalModel.motionManager.startRandomMotion(i,o):this.internalModel.motionManager.startMotion(i,s,o)}expression(i){return this.internalModel.motionManager.expressionManager?i===void 0?this.internalModel.motionManager.expressionManager.setRandomExpression():this.internalModel.motionManager.expressionManager.setExpression(i):Promise.resolve(!1)}focus(i,s,o=!1){wt.x=i,wt.y=s,this.toModelPosition(wt,wt,!0),this.internalModel.focusController.focus(wt.x/this.internalModel.originalWidth*2-1,-(wt.y/this.internalModel.originalHeight*2-1),o)}tap(i,s){const o=this.hitTest(i,s);o.length&&(Ne.log(this.tag,"Hit",o),this.emit("hit",o))}hitTest(i,s){return wt.x=i,wt.y=s,this.toModelPosition(wt,wt),this.internalModel.hitTest(wt.x,wt.y)}toModelPosition(i,s=i.clone(),o){return o||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.transform.worldTransform.applyInverse(i,s),this.internalModel.localTransform.applyInverse(s,s),s}containsPoint(i){return this.getBounds(!0).contains(i.x,i.y)}_calculateBounds(){this._bounds.addFrame(this.transform,0,0,this.internalModel.width,this.internalModel.height)}onTickerUpdate(){this.update(ii._frameDuration)}update(i){this.deltaTime+=i,this.elapsedTime+=i}renderWebGL(i){this.registerInteraction(i.plugins.interaction),i.setObjectRenderer(i.emptyRenderer),i.bindVao(null),i._activeShader=null,i.rootRenderTarget.activate();let s=!1;this.glContextID!==i.CONTEXT_UID&&(this.glContextID=i.CONTEXT_UID,this.internalModel.updateWebGLContext(i.gl,this.glContextID),s=!0);for(let y=0;y<this.textures.length;y++){const C=this.textures[y];!C.valid||((s||!C.baseTexture._glTextures[this.glContextID])&&(i.gl.pixelStorei(WebGLRenderingContext.UNPACK_FLIP_Y_WEBGL,this.internalModel.textureFlipY),i.bindTexture(C.baseTexture,0)),this.internalModel.bindTexture(y,C.baseTexture._glTextures[this.glContextID].texture),C.baseTexture.touched=i.textureGC.count)}const o=i.screen;this.internalModel.viewport=[o.x,o.y,o.width,o.height],this.deltaTime&&(this.internalModel.update(this.deltaTime,this.elapsedTime),this.deltaTime=0);const p=i.rootRenderTarget.projectionMatrix.copy(gn).append(this.worldTransform);this.internalModel.updateTransform(p),this.internalModel.draw(i.gl),i.state.resetToDefault();for(let y=0;y<i.boundTextures.length;y++)i.unbindTexture(i.boundTextures[y])}destroy(i){this.emit("destroy"),this.autoUpdate=!1,this.unregisterInteraction(),(i==null?void 0:i.texture)&&this.textures.forEach(s=>s.destroy(i.baseTexture)),this.internalModel.destroy(),super.destroy(i)}}R0(Wi,[fn]);const kt=class{static resolveURL(l,i){var o;const s=(o=kt.filesMap[l])==null?void 0:o[i];if(s===void 0)throw new Error("Cannot find this file from uploaded files: "+i);return s}static async upload(l,i){const s={};for(const o of i.getDefinedFiles()){const p=decodeURI(dr.resolve(i.url,o)),y=l.find(C=>C.webkitRelativePath===p);y&&(s[o]=URL.createObjectURL(y))}kt.filesMap[i._objectURL]=s}static async createSettings(l){const i=l.find(C=>C.name.endsWith("model.json")||C.name.endsWith("model3.json"));if(!i)throw new TypeError("Settings file not found");const s=await kt.readText(i),o=JSON.parse(s);o.url=i.webkitRelativePath;const p=Qe.findRuntime(o);if(!p)throw new Error("Unknown settings JSON");const y=p.createModelSettings(o);return y._objectURL=URL.createObjectURL(i),y}static async readText(l){return new Promise((i,s)=>{const o=new FileReader;o.onload=()=>i(o.result),o.onerror=s,o.readAsText(l,"utf8")})}};let _r=kt;_r.filesMap={};_r.factory=async(l,i)=>{if(Array.isArray(l.source)&&l.source[0]instanceof File){const s=l.source;let o=s.settings;if(!o)o=await kt.createSettings(s);else if(!o._objectURL)throw new Error('"_objectURL" must be specified in ModelSettings');o.validateFiles(s.map(p=>encodeURI(p.webkitRelativePath))),await kt.upload(s,o),o.resolveURL=function(p){return kt.resolveURL(this._objectURL,p)},l.source=o,l.live2dModel.once("modelLoaded",p=>{p.once("destroy",function(){const y=this.settings._objectURL;if(URL.revokeObjectURL(y),kt.filesMap[y])for(const C of Object.values(kt.filesMap[y]))URL.revokeObjectURL(C);delete kt.filesMap[y]})})}return i()};Qe.live2DModelMiddlewares.unshift(_r.factory);const At=class{static async unzip(l,i){const s=await At.getFilePaths(l),o=[];for(const y of i.getDefinedFiles()){const C=decodeURI(dr.resolve(i.url,y));s.includes(C)&&o.push(C)}const p=await At.getFiles(l,o);for(let y=0;y<p.length;y++){const C=o[y],b=p[y];Object.defineProperty(b,"webkitRelativePath",{value:C})}return p}static async createSettings(l){const s=(await At.getFilePaths(l)).find(C=>C.endsWith("model.json")||C.endsWith("model3.json"));if(!s)throw new Error("Settings file not found");const o=await At.readText(l,s);if(!o)throw new Error("Empty settings file: "+s);const p=JSON.parse(o);p.url=s;const y=Qe.findRuntime(p);if(!y)throw new Error("Unknown settings JSON");return y.createModelSettings(p)}static async zipReader(l,i){throw new Error("Not implemented")}static async getFilePaths(l){throw new Error("Not implemented")}static async getFiles(l,i){throw new Error("Not implemented")}static async readText(l,i){throw new Error("Not implemented")}static releaseReader(l){}};let Hi=At;Hi.ZIP_PROTOCOL="zip://";Hi.uid=0;Hi.factory=async(l,i)=>{const s=l.source;let o,p,y;if(typeof s=="string"&&(s.endsWith(".zip")||s.startsWith(At.ZIP_PROTOCOL))?(s.startsWith(At.ZIP_PROTOCOL)?o=s.slice(At.ZIP_PROTOCOL.length):o=s,p=await Ot.load({url:o,type:"blob",target:l.live2dModel})):Array.isArray(s)&&s.length===1&&s[0]instanceof File&&s[0].name.endsWith(".zip")&&(p=s[0],o=URL.createObjectURL(p),y=s.settings),p){if(!p.size)throw new Error("Empty zip file");const C=await At.zipReader(p,o);y||(y=await At.createSettings(C)),y._objectURL=At.ZIP_PROTOCOL+At.uid+"/"+y.url;const b=await At.unzip(C,y);b.settings=y,l.source=b,o.startsWith("blob:")&&l.live2dModel.once("modelLoaded",R=>{R.once("destroy",function(){URL.revokeObjectURL(o)})})}return i()};Qe.live2DModelMiddlewares.unshift(Hi.factory);if(!window.Live2DCubismCore)throw new Error("Cannot find Cubism 4 runtime. Did you forget to include the live2dcubismcore.min.js?");class Ae{constructor(i,s){this.x=i||0,this.y=s||0}add(i){const s=new Ae(0,0);return s.x=this.x+i.x,s.y=this.y+i.y,s}substract(i){const s=new Ae(0,0);return s.x=this.x-i.x,s.y=this.y-i.y,s}multiply(i){const s=new Ae(0,0);return s.x=this.x*i.x,s.y=this.y*i.y,s}multiplyByScaler(i){return this.multiply(new Ae(i,i))}division(i){const s=new Ae(0,0);return s.x=this.x/i.x,s.y=this.y/i.y,s}divisionByScalar(i){return this.division(new Ae(i,i))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(i){return Math.sqrt((this.x-i.x)*(this.x-i.x)+(this.y-i.y)*(this.y-i.y))}dot(i){return this.x*i.x+this.y*i.y}normalize(){const i=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/i,this.y=this.y/i}isEqual(i){return this.x==i.x&&this.y==i.y}isNotEqual(i){return!this.isEqual(i)}}class $e{static range(i,s,o){return i<s?i=s:i>o&&(i=o),i}static sin(i){return Math.sin(i)}static cos(i){return Math.cos(i)}static abs(i){return Math.abs(i)}static sqrt(i){return Math.sqrt(i)}static getEasingSine(i){return i<0?0:i>1?1:.5-.5*this.cos(i*Math.PI)}static max(i,s){return i>s?i:s}static min(i,s){return i>s?s:i}static degreesToRadian(i){return i/180*Math.PI}static radianToDegrees(i){return i*180/Math.PI}static directionToRadian(i,s){const o=Math.atan2(s.y,s.x),p=Math.atan2(i.y,i.x);let y=o-p;for(;y<-Math.PI;)y+=Math.PI*2;for(;y>Math.PI;)y-=Math.PI*2;return y}static directionToDegrees(i,s){const o=this.directionToRadian(i,s);let p=this.radianToDegrees(o);return s.x-i.x>0&&(p=-p),p}static radianToDirection(i){const s=new Ae;return s.x=this.sin(i),s.y=this.cos(i),s}constructor(){}}class xt{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(i,s,o){const p=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),y=4;for(let C=0;C<y;++C)for(let b=0;b<y;++b)for(let R=0;R<y;++R)p[b+C*4]+=i[R+C*4]*s[b+R*4];for(let C=0;C<16;++C)o[C]=p[C]}loadIdentity(){const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(i)}setMatrix(i){for(let s=0;s<16;++s)this._tr[s]=i[s]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(i){return this._tr[0]*i+this._tr[12]}transformY(i){return this._tr[5]*i+this._tr[13]}invertTransformX(i){return(i-this._tr[12])/this._tr[0]}invertTransformY(i){return(i-this._tr[13])/this._tr[5]}translateRelative(i,s){const o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,i,s,0,1]);xt.multiply(o,this._tr,this._tr)}translate(i,s){this._tr[12]=i,this._tr[13]=s}translateX(i){this._tr[12]=i}translateY(i){this._tr[13]=i}scaleRelative(i,s){const o=new Float32Array([i,0,0,0,0,s,0,0,0,0,1,0,0,0,0,1]);xt.multiply(o,this._tr,this._tr)}scale(i,s){this._tr[0]=i,this._tr[5]=s}multiplyByMatrix(i){xt.multiply(i.getArray(),this._tr,this._tr)}clone(){const i=new xt;for(let s=0;s<this._tr.length;s++)i._tr[s]=this._tr[s];return i}}class Ar{initialize(i){this._model=i}drawModel(){this.getModel()!=null&&this.doDrawModel()}setMvpMatrix(i){this._mvpMatrix4x4.setMatrix(i.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(i,s,o,p){i<0?i=0:i>1&&(i=1),s<0?s=0:s>1&&(s=1),o<0?o=0:o>1&&(o=1),p<0?p=0:p>1&&(p=1),this._modelColor.R=i,this._modelColor.G=s,this._modelColor.B=o,this._modelColor.A=p}getModelColor(){return Object.assign({},this._modelColor)}setIsPremultipliedAlpha(i){this._isPremultipliedAlpha=i}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(i){this._isCulling=i}isCulling(){return this._isCulling}setAnisotropy(i){this._anisortopy=i}getAnisotropy(){return this._anisortopy}getModel(){return this._model}constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisortopy=0,this._modelColor=new Ci,this._mvpMatrix4x4=new xt,this._mvpMatrix4x4.loadIdentity()}}var Ft;(function(l){l[l.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",l[l.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",l[l.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative"})(Ft||(Ft={}));class Ci{constructor(){this.R=1,this.G=1,this.B=1,this.A=1}}let bt=!1,oi=!1,li;var Pi;(function(l){l.vertexOffset=0,l.vertexStep=2})(Pi||(Pi={}));class Si{static startUp(i){if(bt)return Ii("CubismFramework.startUp() is already done."),bt;if(Live2DCubismCore._isStarted)return bt=!0,!0;if(Live2DCubismCore._isStarted=!0,li=i,li&&Live2DCubismCore.Logging.csmSetLogFunction(li.logFunction),bt=!0,bt){const s=Live2DCubismCore.Version.csmGetVersion(),o=(s&4278190080)>>24,p=(s&16711680)>>16,y=s&65535,C=s;Ii("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+o).slice(-2),("00"+p).slice(-2),("0000"+y).slice(-4),C)}return Ii("CubismFramework.startUp() is complete."),bt}static cleanUp(){bt=!1,oi=!1,li=void 0}static initialize(){if(!bt){Zi("CubismFramework is not started.");return}if(oi){Zi("CubismFramework.initialize() skipped, already initialized.");return}oi=!0,Ii("CubismFramework.initialize() is complete.")}static dispose(){if(!bt){Zi("CubismFramework is not started.");return}if(!oi){Zi("CubismFramework.dispose() skipped, not initialized.");return}Ar.staticRelease(),oi=!1,Ii("CubismFramework.dispose() is complete.")}static isStarted(){return bt}static isInitialized(){return oi}static coreLogFunction(i){!Live2DCubismCore.Logging.csmGetLogFunction()||Live2DCubismCore.Logging.csmGetLogFunction()(i)}static getLoggingLevel(){return li!=null?li.loggingLevel:Vt.LogLevel_Off}constructor(){}}var Vt;(function(l){l[l.LogLevel_Verbose=0]="LogLevel_Verbose",l[l.LogLevel_Debug=1]="LogLevel_Debug",l[l.LogLevel_Info=2]="LogLevel_Info",l[l.LogLevel_Warning=3]="LogLevel_Warning",l[l.LogLevel_Error=4]="LogLevel_Error",l[l.LogLevel_Off=5]="LogLevel_Off"})(Vt||(Vt={}));const Yi=()=>{};function J0(l,...i){Ji.print(Vt.LogLevel_Debug,"[CSM][D]"+l+`
`,i)}function Ii(l,...i){Ji.print(Vt.LogLevel_Info,"[CSM][I]"+l+`
`,i)}function Zi(l,...i){Ji.print(Vt.LogLevel_Warning,"[CSM][W]"+l+`
`,i)}function ui(l,...i){Ji.print(Vt.LogLevel_Error,"[CSM][E]"+l+`
`,i)}class Ji{static print(i,s,o){if(i<Si.getLoggingLevel())return;const p=Si.coreLogFunction;if(!p)return;const y=s.replace(/{(\d+)}/g,(C,b)=>o[b]);p(y)}static dumpBytes(i,s,o){for(let p=0;p<o;p++)p%16==0&&p>0?this.print(i,`
`):p%8==0&&p>0&&this.print(i,"  "),this.print(i,"{0} ",[s[p]&255]);this.print(i,`
`)}constructor(){}}class q0{constructor(){this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=[]}release(){this._weight=0}updateParameters(i,s,o){if(!s.isAvailable()||s.isFinished())return;if(!s.isStarted()){s.setIsStarted(!0),s.setStartTime(o-this._offsetSeconds),s.setFadeInStartTime(o);const b=this.getDuration();s.getEndTime()<0&&s.setEndTime(b<=0?-1:s.getStartTime()+b)}let p=this._weight;const y=this._fadeInSeconds==0?1:$e.getEasingSine((o-s.getFadeInStartTime())/this._fadeInSeconds),C=this._fadeOutSeconds==0||s.getEndTime()<0?1:$e.getEasingSine((s.getEndTime()-o)/this._fadeOutSeconds);p=p*y*C,s.setState(o,p),this.doUpdateParameters(i,o,p,s),s.getEndTime()>0&&s.getEndTime()<o&&s.setIsFinished(!0)}setFadeInTime(i){this._fadeInSeconds=i}setFadeOutTime(i){this._fadeOutSeconds=i}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(i){this._weight=i}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(i){this._offsetSeconds=i}getFiredEvent(i,s){return this._firedEventValues}setFinishedMotionHandler(i){this._onFinishedMotion=i}getFinishedMotionHandler(){return this._onFinishedMotion}}const $0=1;class yr extends q0{static create(i){const s=new yr,o=i.FadeInTime,p=i.FadeOutTime;s.setFadeInTime(o!==void 0?o:$0),s.setFadeOutTime(p!==void 0?p:$0);const y=i.Parameters||[];for(let C=0;C<y.length;++C){const b=y[C],R=b.Id,k=b.Value;let D;switch(b.Blend){case"Multiply":D=Ut.ExpressionBlendType_Multiply;break;case"Overwrite":D=Ut.ExpressionBlendType_Overwrite;break;case"Add":default:D=Ut.ExpressionBlendType_Add;break}const m={parameterId:R,blendType:D,value:k};s._parameters.push(m)}return s}doUpdateParameters(i,s,o,p){for(let y=0;y<this._parameters.length;++y){const C=this._parameters[y];switch(C.blendType){case Ut.ExpressionBlendType_Add:{i.addParameterValueById(C.parameterId,C.value,o);break}case Ut.ExpressionBlendType_Multiply:{i.multiplyParameterValueById(C.parameterId,C.value,o);break}case Ut.ExpressionBlendType_Overwrite:{i.setParameterValueById(C.parameterId,C.value,o);break}}}}constructor(){super();this._parameters=[]}}var Ut;(function(l){l[l.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",l[l.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",l[l.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite"})(Ut||(Ut={}));class pn{constructor(){this._autoDelete=!1,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&this._motion.release()}setFadeOut(i){this._fadeOutSeconds=i,this._isTriggeredFadeOut=!0}startFadeOut(i,s){const o=s+i;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||o<this._endTimeSeconds)&&(this._endTimeSeconds=o)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(i){this._startTimeSeconds=i}setFadeInStartTime(i){this._fadeInStartTimeSeconds=i}setEndTime(i){this._endTimeSeconds=i}setIsFinished(i){this._finished=i}setIsStarted(i){this._started=i}isAvailable(){return this._available}setIsAvailable(i){this._available=i}setState(i,s){this._stateTimeSeconds=i,this._stateWeight=s}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(i){this._lastEventCheckSeconds=i}isTriggeredFadeOut(){return this._isTriggeredFadeOut&&this._endTimeSeconds<0}getFadeOutSeconds(){return this._fadeOutSeconds}}class K0{constructor(){this._userTimeSeconds=0,this._eventCustomData=null,this._motions=[]}release(){for(let i=0;i<this._motions.length;++i)this._motions[i]&&this._motions[i].release();this._motions=void 0}startMotion(i,s,o){if(i==null)return _n;let p;for(let y=0;y<this._motions.length;++y)p=this._motions[y],p!=null&&p.setFadeOut(p._motion.getFadeOutTime());return p=new pn,p._autoDelete=s,p._motion=i,this._motions.push(p),p._motionQueueEntryHandle}isFinished(){let i=0;for(;i<this._motions.length;){const s=this._motions[i];if(s==null){this._motions.splice(i,1);continue}if(s._motion==null){s.release(),this._motions.splice(i,1);continue}if(!s.isFinished())return!1;i++}return!0}isFinishedByHandle(i){for(let s=0;s<this._motions.length;s++){const o=this._motions[s];if(o!=null&&o._motionQueueEntryHandle==i&&!o.isFinished())return!1}return!0}stopAllMotions(){for(let i=0;i<this._motions.length;i++){const s=this._motions[i];s!=null&&s.release()}this._motions=[]}getCubismMotionQueueEntry(i){return this._motions.find(s=>s!=null&&s._motionQueueEntryHandle==i)}setEventCallback(i,s=null){this._eventCallBack=i,this._eventCustomData=s}doUpdateMotion(i,s){let o=!1,p=0;for(;p<this._motions.length;){const y=this._motions[p];if(y==null){this._motions.splice(p,1);continue}const C=y._motion;if(C==null){y.release(),this._motions.splice(p,1);continue}C.updateParameters(i,y,s),o=!0;const b=C.getFiredEvent(y.getLastCheckEventSeconds()-y.getStartTime(),s-y.getStartTime());for(let R=0;R<b.length;++R)this._eventCallBack(this,b[R],this._eventCustomData);y.setLastCheckEventSeconds(s),y.isFinished()?(y.release(),this._motions.splice(p,1)):(y.isTriggeredFadeOut()&&y.startFadeOut(y.getFadeOutSeconds(),s),p++)}return o}}const _n=-1;class An extends B0{constructor(i,s){super(i,s);var o;this.queueManager=new K0,this.definitions=(o=i.expressions)!=null?o:[],this.init()}isFinished(){return this.queueManager.isFinished()}getExpressionIndex(i){return this.definitions.findIndex(s=>s.Name===i)}getExpressionFile(i){return i.File}createExpression(i,s){return yr.create(i)}_setExpression(i){return this.queueManager.startMotion(i,!1,performance.now())}stopAllExpressions(){this.queueManager.stopAllMotions()}updateParameters(i,s){return this.queueManager.doUpdateMotion(i,s)}}class Q0{constructor(i){this.groups=i.Groups,this.hitAreas=i.HitAreas,this.layout=i.Layout,this.moc=i.FileReferences.Moc,this.expressions=i.FileReferences.Expressions,this.motions=i.FileReferences.Motions,this.textures=i.FileReferences.Textures,this.physics=i.FileReferences.Physics,this.pose=i.FileReferences.Pose}getEyeBlinkParameters(){var i,s;return(s=(i=this.groups)==null?void 0:i.find(o=>o.Name==="EyeBlink"))==null?void 0:s.Ids}getLipSyncParameters(){var i,s;return(s=(i=this.groups)==null?void 0:i.find(o=>o.Name==="LipSync"))==null?void 0:s.Ids}}class hi extends gr{static isValidJSON(i){var s;return!!(i==null?void 0:i.FileReferences)&&typeof i.FileReferences.Moc=="string"&&((s=i.FileReferences.Textures)==null?void 0:s.length)>0&&i.FileReferences.Textures.every(o=>typeof o=="string")}constructor(i){super(i);if(!hi.isValidJSON(i))throw new TypeError("Invalid JSON.");Object.assign(this,new Q0(i))}replaceFiles(i){if(super.replaceFiles(i),this.motions)for(const[s,o]of Object.entries(this.motions))for(let p=0;p<o.length;p++)o[p].File=i(o[p].File,`motions.${s}[${p}].File`),o[p].Sound!==void 0&&(o[p].Sound=i(o[p].Sound,`motions.${s}[${p}].Sound`));if(this.expressions)for(let s=0;s<this.expressions.length;s++)this.expressions[s].File=i(this.expressions[s].File,`expressions[${s}].File`)}}R0(hi,[Q0]);var Gt;(function(l){l[l.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",l[l.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",l[l.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity"})(Gt||(Gt={}));var Pt;(function(l){l[l.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",l[l.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",l[l.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",l[l.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped"})(Pt||(Pt={}));class Nt{constructor(i=0,s=0){this.time=i,this.value=s}}class yn{constructor(){this.basePointIndex=0,this.segmentType=0}}class vn{constructor(){this.id="",this.type=0,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}}class wn{constructor(){this.fireTime=0,this.value=""}}class xn{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=[],this.segments=[],this.points=[],this.events=[]}}class es{constructor(i){this._json=i}release(){this._json=void 0}getMotionDuration(){return this._json.Meta.Duration}isMotionLoop(){return this._json.Meta.Loop||!1}getMotionCurveCount(){return this._json.Meta.CurveCount}getMotionFps(){return this._json.Meta.Fps}getMotionTotalSegmentCount(){return this._json.Meta.TotalSegmentCount}getMotionTotalPointCount(){return this._json.Meta.TotalPointCount}getMotionFadeInTime(){return this._json.Meta.FadeInTime}getMotionFadeOutTime(){return this._json.Meta.FadeOutTime}getMotionCurveTarget(i){return this._json.Curves[i].Target}getMotionCurveId(i){return this._json.Curves[i].Id}getMotionCurveFadeInTime(i){return this._json.Curves[i].FadeInTime}getMotionCurveFadeOutTime(i){return this._json.Curves[i].FadeOutTime}getMotionCurveSegmentCount(i){return this._json.Curves[i].Segments.length}getMotionCurveSegment(i,s){return this._json.Curves[i].Segments[s]}getEventCount(){return this._json.Meta.UserDataCount||0}getTotalEventValueSize(){return this._json.Meta.TotalUserDataSize}getEventTime(i){return this._json.UserData[i].Time}getEventValue(i){return this._json.UserData[i].Value}}const Mn="EyeBlink",Cn="LipSync",Pn="Model",Sn="Parameter",In="PartOpacity";function ci(l,i,s){const o=new Nt;return o.time=l.time+(i.time-l.time)*s,o.value=l.value+(i.value-l.value)*s,o}function kn(l,i){let s=(i-l[0].time)/(l[1].time-l[0].time);return s<0&&(s=0),l[0].value+(l[1].value-l[0].value)*s}function bn(l,i){let s=(i-l[0].time)/(l[3].time-l[0].time);s<0&&(s=0);const o=ci(l[0],l[1],s),p=ci(l[1],l[2],s),y=ci(l[2],l[3],s),C=ci(o,p,s),b=ci(p,y,s);return ci(C,b,s).value}function Dn(l,i){return l[0].value}function Tn(l,i){return l[1].value}function vr(l,i,s){const o=l.curves[i];let p=-1;const y=o.baseSegmentIndex+o.segmentCount;let C=0;for(let R=o.baseSegmentIndex;R<y;++R)if(C=l.segments[R].basePointIndex+(l.segments[R].segmentType==Pt.CubismMotionSegmentType_Bezier?3:1),l.points[C].time>s){p=R;break}if(p==-1)return l.points[C].value;const b=l.segments[p];return b.evaluate(l.points.slice(b.basePointIndex),s)}class wr extends q0{constructor(){super();this._eyeBlinkParameterIds=[],this._lipSyncParameterIds=[],this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0}static create(i,s){const o=new wr;return o.parse(i),o._sourceFrameRate=o._motionData.fps,o._loopDurationSeconds=o._motionData.duration,o._onFinishedMotion=s,o}doUpdateParameters(i,s,o,p){this._modelCurveIdEyeBlink==null&&(this._modelCurveIdEyeBlink=Mn),this._modelCurveIdLipSync==null&&(this._modelCurveIdLipSync=Cn);let y=s-p.getStartTime();y<0&&(y=0);let C=Number.MAX_VALUE,b=Number.MAX_VALUE;const R=64;let k=0,D=0;this._eyeBlinkParameterIds.length>R&&J0("too many eye blink targets : {0}",this._eyeBlinkParameterIds.length),this._lipSyncParameterIds.length>R&&J0("too many lip sync targets : {0}",this._lipSyncParameterIds.length);const m=this._fadeInSeconds<=0?1:$e.getEasingSine((s-p.getFadeInStartTime())/this._fadeInSeconds),N=this._fadeOutSeconds<=0||p.getEndTime()<0?1:$e.getEasingSine((p.getEndTime()-s)/this._fadeOutSeconds);let q,J,Q,re=y;if(this._isLoop)for(;re>this._motionData.duration;)re-=this._motionData.duration;const $=this._motionData.curves;for(J=0;J<this._motionData.curveCount&&$[J].type==Gt.CubismMotionCurveTarget_Model;++J)q=vr(this._motionData,J,re),$[J].id==this._modelCurveIdEyeBlink?b=q:$[J].id==this._modelCurveIdLipSync&&(C=q);for(;J<this._motionData.curveCount&&$[J].type==Gt.CubismMotionCurveTarget_Parameter;++J){if(Q=i.getParameterIndex($[J].id),Q==-1)continue;const de=i.getParameterValueByIndex(Q);if(q=vr(this._motionData,J,re),b!=Number.MAX_VALUE){for(let be=0;be<this._eyeBlinkParameterIds.length&&be<R;++be)if(this._eyeBlinkParameterIds[be]==$[J].id){q*=b,D|=1<<be;break}}if(C!=Number.MAX_VALUE){for(let be=0;be<this._lipSyncParameterIds.length&&be<R;++be)if(this._lipSyncParameterIds[be]==$[J].id){q+=C,k|=1<<be;break}}let j;if($[J].fadeInTime<0&&$[J].fadeOutTime<0)j=de+(q-de)*o;else{let be,it;$[J].fadeInTime<0?be=m:be=$[J].fadeInTime==0?1:$e.getEasingSine((s-p.getFadeInStartTime())/$[J].fadeInTime),$[J].fadeOutTime<0?it=N:it=$[J].fadeOutTime==0||p.getEndTime()<0?1:$e.getEasingSine((p.getEndTime()-s)/$[J].fadeOutTime);const je=this._weight*be*it;j=de+(q-de)*je}i.setParameterValueByIndex(Q,j,1)}{if(b!=Number.MAX_VALUE)for(let de=0;de<this._eyeBlinkParameterIds.length&&de<R;++de){const j=i.getParameterValueById(this._eyeBlinkParameterIds[de]);if(D>>de&1)continue;const be=j+(b-j)*o;i.setParameterValueById(this._eyeBlinkParameterIds[de],be)}if(C!=Number.MAX_VALUE)for(let de=0;de<this._lipSyncParameterIds.length&&de<R;++de){const j=i.getParameterValueById(this._lipSyncParameterIds[de]);if(k>>de&1)continue;const be=j+(C-j)*o;i.setParameterValueById(this._lipSyncParameterIds[de],be)}}for(;J<this._motionData.curveCount&&$[J].type==Gt.CubismMotionCurveTarget_PartOpacity;++J)Q=i.getParameterIndex($[J].id),Q!=-1&&(q=vr(this._motionData,J,re),i.setParameterValueByIndex(Q,q));y>=this._motionData.duration&&(this._isLoop?(p.setStartTime(s),this._isLoopFadeIn&&p.setFadeInStartTime(s)):(this._onFinishedMotion&&this._onFinishedMotion(this),p.setIsFinished(!0))),this._lastWeight=o}setIsLoop(i){this._isLoop=i}isLoop(){return this._isLoop}setIsLoopFadeIn(i){this._isLoopFadeIn=i}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(i,s){const o=this._motionData.curves;for(let p=0;p<this._motionData.curveCount;++p)if(i==o[p].id){o[p].fadeInTime=s;return}}setParameterFadeOutTime(i,s){const o=this._motionData.curves;for(let p=0;p<this._motionData.curveCount;++p)if(i==o[p].id){o[p].fadeOutTime=s;return}}getParameterFadeInTime(i){const s=this._motionData.curves;for(let o=0;o<this._motionData.curveCount;++o)if(i==s[o].id)return s[o].fadeInTime;return-1}getParameterFadeOutTime(i){const s=this._motionData.curves;for(let o=0;o<this._motionData.curveCount;++o)if(i==s[o].id)return s[o].fadeOutTime;return-1}setEffectIds(i,s){this._eyeBlinkParameterIds=i,this._lipSyncParameterIds=s}release(){this._motionData=void 0}parse(i){this._motionData=new xn;let s=new es(i);this._motionData.duration=s.getMotionDuration(),this._motionData.loop=s.isMotionLoop(),this._motionData.curveCount=s.getMotionCurveCount(),this._motionData.fps=s.getMotionFps(),this._motionData.eventCount=s.getEventCount();const o=s.getMotionFadeInTime(),p=s.getMotionFadeOutTime();o!==void 0?this._fadeInSeconds=o<0?1:o:this._fadeInSeconds=1,p!==void 0?this._fadeOutSeconds=p<0?1:p:this._fadeOutSeconds=1,this._motionData.curves=Array.from({length:this._motionData.curveCount}).map(()=>new vn),this._motionData.segments=Array.from({length:s.getMotionTotalSegmentCount()}).map(()=>new yn),this._motionData.events=Array.from({length:this._motionData.eventCount}).map(()=>new wn),this._motionData.points=[];let y=0,C=0;for(let b=0;b<this._motionData.curveCount;++b){const R=this._motionData.curves[b];switch(s.getMotionCurveTarget(b)){case Pn:R.type=Gt.CubismMotionCurveTarget_Model;break;case Sn:R.type=Gt.CubismMotionCurveTarget_Parameter;break;case In:R.type=Gt.CubismMotionCurveTarget_PartOpacity;break}R.id=s.getMotionCurveId(b),R.baseSegmentIndex=C;const k=s.getMotionCurveFadeInTime(b),D=s.getMotionCurveFadeOutTime(b);R.fadeInTime=k!==void 0?k:-1,R.fadeOutTime=D!==void 0?D:-1;for(let m=0;m<s.getMotionCurveSegmentCount(b);){switch(m==0?(this._motionData.segments[C].basePointIndex=y,this._motionData.points[y]=new Nt(s.getMotionCurveSegment(b,m),s.getMotionCurveSegment(b,m+1)),y+=1,m+=2):this._motionData.segments[C].basePointIndex=y-1,s.getMotionCurveSegment(b,m)){case Pt.CubismMotionSegmentType_Linear:{this._motionData.segments[C].segmentType=Pt.CubismMotionSegmentType_Linear,this._motionData.segments[C].evaluate=kn,this._motionData.points[y]=new Nt(s.getMotionCurveSegment(b,m+1),s.getMotionCurveSegment(b,m+2)),y+=1,m+=3;break}case Pt.CubismMotionSegmentType_Bezier:{this._motionData.segments[C].segmentType=Pt.CubismMotionSegmentType_Bezier,this._motionData.segments[C].evaluate=bn,this._motionData.points[y]=new Nt(s.getMotionCurveSegment(b,m+1),s.getMotionCurveSegment(b,m+2)),this._motionData.points[y+1]=new Nt(s.getMotionCurveSegment(b,m+3),s.getMotionCurveSegment(b,m+4)),this._motionData.points[y+2]=new Nt(s.getMotionCurveSegment(b,m+5),s.getMotionCurveSegment(b,m+6)),y+=3,m+=7;break}case Pt.CubismMotionSegmentType_Stepped:{this._motionData.segments[C].segmentType=Pt.CubismMotionSegmentType_Stepped,this._motionData.segments[C].evaluate=Dn,this._motionData.points[y]=new Nt(s.getMotionCurveSegment(b,m+1),s.getMotionCurveSegment(b,m+2)),y+=1,m+=3;break}case Pt.CubismMotionSegmentType_InverseStepped:{this._motionData.segments[C].segmentType=Pt.CubismMotionSegmentType_InverseStepped,this._motionData.segments[C].evaluate=Tn,this._motionData.points[y]=new Nt(s.getMotionCurveSegment(b,m+1),s.getMotionCurveSegment(b,m+2)),y+=1,m+=3;break}}++R.segmentCount,++C}this._motionData.curves.push(R)}for(let b=0;b<s.getEventCount();++b)this._motionData.events[b].fireTime=s.getEventTime(b),this._motionData.events[b].value=s.getEventValue(b);s.release()}getFiredEvent(i,s){this._firedEventValues.length=0;for(let o=0;o<this._motionData.eventCount;++o)this._motionData.events[o].fireTime>i&&this._motionData.events[o].fireTime<=s&&this._firedEventValues.push(this._motionData.events[o].value);return this._firedEventValues}}class En extends pr{constructor(i,s){super(i,s);var o;this.groups={idle:"Idle"},this.motionDataType="json",this.queueManager=new K0,this.definitions=(o=i.motions)!=null?o:{},this.eyeBlinkIds=i.getEyeBlinkParameters()||[],this.lipSyncIds=i.getLipSyncParameters()||[],this.init(s)}init(i){super.init(i),this.settings.expressions&&(this.expressionManager=new An(this.settings,i)),this.queueManager.setEventCallback((s,o,p)=>{this.emit("motion:"+o)})}isFinished(){return this.queueManager.isFinished()}_startMotion(i,s){return i.setFinishedMotionHandler(s),this.queueManager.stopAllMotions(),this.queueManager.startMotion(i,!1,performance.now())}_stopAllMotions(){this.queueManager.stopAllMotions()}createMotion(i,s,o){const p=wr.create(i),y=new es(i),C=(s===this.groups.idle?_t.idleMotionFadingDuration:_t.motionFadingDuration)/1e3;return y.getMotionFadeInTime()===void 0&&p.setFadeInTime(o.FadeInTime>0?o.FadeInTime:C),y.getMotionFadeOutTime()===void 0&&p.setFadeOutTime(o.FadeOutTime>0?o.FadeOutTime:C),p.setEffectIds(this.eyeBlinkIds,this.lipSyncIds),p}getMotionFile(i){return i.File}getMotionName(i){return i.File}getSoundFile(i){return i.Sound}updateParameters(i,s){return this.queueManager.doUpdateMotion(i,s)}destroy(){super.destroy(),this.queueManager.release(),this.queueManager=void 0}}const Fn="ParamAngleX",Ln="ParamAngleY",Rn="ParamAngleZ",Bn="ParamEyeBallX",On="ParamEyeBallY",Vn="ParamBodyAngleX",Un="ParamBreath";class xr{constructor(){this._breathParameters=[],this._currentTime=0}static create(){return new xr}setParameters(i){this._breathParameters=i}getParameters(){return this._breathParameters}updateParameters(i,s){this._currentTime+=s;const o=this._currentTime*2*3.14159;for(let p=0;p<this._breathParameters.length;++p){const y=this._breathParameters[p];i.addParameterValueById(y.parameterId,y.offset+y.peak*Math.sin(o/y.cycle),y.weight)}}}class ki{constructor(i,s,o,p,y){this.parameterId=i==null?void 0:i,this.offset=s==null?0:s,this.peak=o==null?0:o,this.cycle=p==null?0:p,this.weight=y==null?0:y}}const Mr=class{static create(l){return new Mr(l)}setBlinkingInterval(l){this._blinkingIntervalSeconds=l}setBlinkingSetting(l,i,s){this._closingSeconds=l,this._closedSeconds=i,this._openingSeconds=s}setParameterIds(l){this._parameterIds=l}getParameterIds(){return this._parameterIds}updateParameters(l,i){this._userTimeSeconds+=i;let s,o=0;switch(this._blinkingState){case yt.EyeState_Closing:o=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,o>=1&&(o=1,this._blinkingState=yt.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),s=1-o;break;case yt.EyeState_Closed:o=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,o>=1&&(this._blinkingState=yt.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),s=0;break;case yt.EyeState_Opening:o=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,o>=1&&(o=1,this._blinkingState=yt.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),s=o;break;case yt.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=yt.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),s=1;break;case yt.EyeState_First:default:this._blinkingState=yt.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),s=1;break}Mr.CloseIfZero||(s=-s);for(let p=0;p<this._parameterIds.length;++p)l.setParameterValueById(this._parameterIds[p],s)}constructor(l){var i,s;this._blinkingState=yt.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=[],l!=null&&(this._parameterIds=(s=(i=l.getEyeBlinkParameters())==null?void 0:i.slice())!=null?s:this._parameterIds)}determinNextBlinkingTiming(){const l=Math.random();return this._userTimeSeconds+l*(2*this._blinkingIntervalSeconds-1)}};let ts=Mr;ts.CloseIfZero=!0;var yt;(function(l){l[l.EyeState_First=0]="EyeState_First",l[l.EyeState_Interval=1]="EyeState_Interval",l[l.EyeState_Closing=2]="EyeState_Closing",l[l.EyeState_Closed=3]="EyeState_Closed",l[l.EyeState_Opening=4]="EyeState_Opening"})(yt||(yt={}));class Cr{constructor(i=0,s=0,o=0,p=0){this.x=i,this.y=s,this.width=o,this.height=p}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(i){this.x=i.x,this.y=i.y,this.width=i.width,this.height=i.height}expand(i,s){this.x-=i,this.y-=s,this.width+=i*2,this.height+=s*2}}var qi;(function(l){l.supportMoreMaskDivisions=!0})(qi||(qi={}));const Pr=4,Gn=10;let ri,bi,Sr;class Ir{getChannelFlagAsColor(i){return this._channelColors[i]}getMaskRenderTexture(){let i=0;if(this._maskTexture&&this._maskTexture.texture!=0&&(this._maskTexture.frameNo=this._currentFrameNo,i=this._maskTexture.texture),i==0){const s=this._clippingMaskBufferSize;this._colorBuffer=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this._colorBuffer),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,s,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),i=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,i),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._colorBuffer,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Sr),this._maskTexture=new Nn(this._currentFrameNo,i)}return i}setGL(i){this.gl=i}calcClippedDrawTotalBounds(i,s){let o=Number.MAX_VALUE,p=Number.MAX_VALUE,y=Number.MIN_VALUE,C=Number.MIN_VALUE;const b=s._clippedDrawableIndexList.length;for(let R=0;R<b;R++){const k=s._clippedDrawableIndexList[R],D=i.getDrawableVertexCount(k),m=i.getDrawableVertices(k);let N=Number.MAX_VALUE,q=Number.MAX_VALUE,J=Number.MIN_VALUE,Q=Number.MIN_VALUE;const re=D*Pi.vertexStep;for(let $=Pi.vertexOffset;$<re;$+=Pi.vertexStep){const de=m[$],j=m[$+1];de<N&&(N=de),de>J&&(J=de),j<q&&(q=j),j>Q&&(Q=j)}if(N!=Number.MAX_VALUE)if(N<o&&(o=N),q<p&&(p=q),J>y&&(y=J),Q>C&&(C=Q),o==Number.MAX_VALUE)s._allClippedDrawRect.x=0,s._allClippedDrawRect.y=0,s._allClippedDrawRect.width=0,s._allClippedDrawRect.height=0,s._isUsing=!1;else{s._isUsing=!0;const $=y-o,de=C-p;s._allClippedDrawRect.x=o,s._allClippedDrawRect.y=p,s._allClippedDrawRect.width=$,s._allClippedDrawRect.height=de}}}constructor(){this._maskRenderTexture=null,this._colorBuffer=null,this._currentFrameNo=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=[],this._clippingContextListForDraw=[],this._channelColors=[],this._tmpBoundsOnModel=new Cr,this._tmpMatrix=new xt,this._tmpMatrixForMask=new xt,this._tmpMatrixForDraw=new xt;let i=new Ci;i.R=1,i.G=0,i.B=0,i.A=0,this._channelColors.push(i),i=new Ci,i.R=0,i.G=1,i.B=0,i.A=0,this._channelColors.push(i),i=new Ci,i.R=0,i.G=0,i.B=1,i.A=0,this._channelColors.push(i),i=new Ci,i.R=0,i.G=0,i.B=0,i.A=1,this._channelColors.push(i)}release(){var s,o,p;const i=this;for(let y=0;y<this._clippingContextListForMask.length;y++)this._clippingContextListForMask[y]&&((s=this._clippingContextListForMask[y])==null||s.release());i._clippingContextListForMask=void 0,i._clippingContextListForDraw=void 0,this._maskTexture&&((o=this.gl)==null||o.deleteFramebuffer(this._maskTexture.texture),i._maskTexture=void 0),i._channelColors=void 0,(p=this.gl)==null||p.deleteTexture(this._colorBuffer),this._colorBuffer=null}initialize(i,s,o,p){for(let y=0;y<s;y++){if(p[y]<=0){this._clippingContextListForDraw.push(null);continue}let C=this.findSameClip(o[y],p[y]);C==null&&(C=new jn(this,o[y],p[y]),this._clippingContextListForMask.push(C)),C.addClippedDrawable(y),this._clippingContextListForDraw.push(C)}}setupClippingContext(i,s){this._currentFrameNo++;let o=0;for(let p=0;p<this._clippingContextListForMask.length;p++){const y=this._clippingContextListForMask[p];this.calcClippedDrawTotalBounds(i,y),y._isUsing&&o++}if(o>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._maskRenderTexture=this.getMaskRenderTexture(),s.getMvpMatrix(),s.preDraw(),this.setupLayoutBounds(o),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);for(let p=0;p<this._clippingContextListForMask.length;p++){const y=this._clippingContextListForMask[p],C=y._allClippedDrawRect,b=y._layoutBounds,R=.05;this._tmpBoundsOnModel.setRect(C),this._tmpBoundsOnModel.expand(C.width*R,C.height*R);const k=b.width/this._tmpBoundsOnModel.width,D=b.height/this._tmpBoundsOnModel.height;this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(b.x,b.y),this._tmpMatrix.scaleRelative(k,D),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(b.x,b.y),this._tmpMatrix.scaleRelative(k,D),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),y._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),y._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const m=y._clippingIdCount;for(let N=0;N<m;N++){const q=y._clippingIdList[N];!i.getDrawableDynamicFlagVertexPositionsDidChange(q)||(s.setIsCulling(i.getDrawableCulling(q)!=!1),s.setClippingContextBufferForMask(y),s.drawMesh(i.getDrawableTextureIndices(q),i.getDrawableVertexIndexCount(q),i.getDrawableVertexCount(q),i.getDrawableVertexIndices(q),i.getDrawableVertices(q),i.getDrawableVertexUvs(q),i.getDrawableOpacity(q),Ft.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Sr),s.setClippingContextBufferForMask(null),this.gl.viewport(bi[0],bi[1],bi[2],bi[3])}}findSameClip(i,s){for(let o=0;o<this._clippingContextListForMask.length;o++){const p=this._clippingContextListForMask[o],y=p._clippingIdCount;if(y!=s)continue;let C=0;for(let b=0;b<y;b++){const R=p._clippingIdList[b];for(let k=0;k<y;k++)if(i[k]==R){C++;break}}if(C==y)return p}return null}setupLayoutBounds(i){let s=i/Pr,o=i%Pr;s=~~s,o=~~o;let p=0;for(let y=0;y<Pr;y++){const C=s+(y<o?1:0);if(C!=0)if(C==1){const b=this._clippingContextListForMask[p++];b._layoutChannelNo=y,b._layoutBounds.x=0,b._layoutBounds.y=0,b._layoutBounds.width=1,b._layoutBounds.height=1}else if(C==2)for(let b=0;b<C;b++){let R=b%2;R=~~R;const k=this._clippingContextListForMask[p++];k._layoutChannelNo=y,k._layoutBounds.x=R*.5,k._layoutBounds.y=0,k._layoutBounds.width=.5,k._layoutBounds.height=1}else if(C<=4)for(let b=0;b<C;b++){let R=b%2,k=b/2;R=~~R,k=~~k;const D=this._clippingContextListForMask[p++];D._layoutChannelNo=y,D._layoutBounds.x=R*.5,D._layoutBounds.y=k*.5,D._layoutBounds.width=.5,D._layoutBounds.height=.5}else if(C<=9)for(let b=0;b<C;b++){let R=b%3,k=b/3;R=~~R,k=~~k;const D=this._clippingContextListForMask[p++];D._layoutChannelNo=y,D._layoutBounds.x=R/3,D._layoutBounds.y=k/3,D._layoutBounds.width=1/3,D._layoutBounds.height=1/3}else if(qi.supportMoreMaskDivisions&&C<=16)for(let b=0;b<C;b++){let R=b%4,k=b/4;R=~~R,k=~~k;const D=this._clippingContextListForMask[p++];D._layoutChannelNo=y,D._layoutBounds.x=R/4,D._layoutBounds.y=k/4,D._layoutBounds.width=1/4,D._layoutBounds.height=1/4}else ui("not supported mask count : {0}",C)}}getColorBuffer(){return this._colorBuffer}getClippingContextListForDraw(){return this._clippingContextListForDraw}setClippingMaskBufferSize(i){this._clippingMaskBufferSize=i}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}}class Nn{constructor(i,s){this.frameNo=i,this.texture=s}}class jn{constructor(i,s,o){this._isUsing=!1,this._owner=i,this._clippingIdList=s,this._clippingIdCount=o,this._allClippedDrawRect=new Cr,this._layoutBounds=new Cr,this._clippedDrawableIndexList=[],this._matrixForMask=new xt,this._matrixForDraw=new xt}release(){const i=this;i._layoutBounds=void 0,i._allClippedDrawRect=void 0,i._clippedDrawableIndexList=void 0}addClippedDrawable(i){this._clippedDrawableIndexList.push(i)}getClippingManager(){return this._owner}setGl(i){this._owner.setGL(i)}}class di{static getInstance(){return ri==null&&(ri=new di),ri}static deleteInstance(){ri&&(ri.release(),ri=void 0)}constructor(){this._shaderSets=[]}release(){this.releaseShaderProgram()}setupShaderProgram(i,s,o,p,y,C,b,R,k,D,m,N,q){m||ui("NoPremultipliedAlpha is not allowed"),this._shaderSets.length==0&&this.generateShaders();let J,Q,re,$;const de=i.getClippingContextBufferForMask();if(de!=null){const j=this._shaderSets[fi.ShaderNames_SetupMask];this.gl.useProgram(j.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(j.samplerTexture0Location,0),b.vertex==null&&(b.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,p,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(j.attributePositionLocation),this.gl.vertexAttribPointer(j.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),b.uv==null&&(b.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,C,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(j.attributeTexCoordLocation),this.gl.vertexAttribPointer(j.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const be=de._layoutChannelNo,it=de.getClippingManager().getChannelFlagAsColor(be);this.gl.uniform4f(j.uniformChannelFlagLocation,it.R,it.G,it.B,it.A),this.gl.uniformMatrix4fv(j.uniformClipMatrixLocation,!1,de._matrixForMask.getArray());const je=de._layoutBounds;this.gl.uniform4f(j.uniformBaseColorLocation,je.x*2-1,je.y*2-1,je.getRight()*2-1,je.getBottom()*2-1),J=this.gl.ZERO,Q=this.gl.ONE_MINUS_SRC_COLOR,re=this.gl.ZERO,$=this.gl.ONE_MINUS_SRC_ALPHA}else{const j=i.getClippingContextBufferForDraw(),it=j!=null?q?2:1:0;let je;switch(k){case Ft.CubismBlendMode_Normal:default:je=this._shaderSets[fi.ShaderNames_NormalPremultipliedAlpha+it],J=this.gl.ONE,Q=this.gl.ONE_MINUS_SRC_ALPHA,re=this.gl.ONE,$=this.gl.ONE_MINUS_SRC_ALPHA;break;case Ft.CubismBlendMode_Additive:je=this._shaderSets[fi.ShaderNames_AddPremultipliedAlpha+it],J=this.gl.ONE,Q=this.gl.ONE,re=this.gl.ZERO,$=this.gl.ONE;break;case Ft.CubismBlendMode_Multiplicative:je=this._shaderSets[fi.ShaderNames_MultPremultipliedAlpha+it],J=this.gl.DST_COLOR,Q=this.gl.ONE_MINUS_SRC_ALPHA,re=this.gl.ZERO,$=this.gl.ONE;break}if(this.gl.useProgram(je.shaderProgram),b.vertex==null&&(b.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,p,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(je.attributePositionLocation),this.gl.vertexAttribPointer(je.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),b.uv==null&&(b.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,C,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(je.attributeTexCoordLocation),this.gl.vertexAttribPointer(je.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),j!=null){this.gl.activeTexture(this.gl.TEXTURE1);const dt=j.getClippingManager().getColorBuffer();this.gl.bindTexture(this.gl.TEXTURE_2D,dt),this.gl.uniform1i(je.samplerTexture1Location,1),this.gl.uniformMatrix4fv(je.uniformClipMatrixLocation,!1,j._matrixForDraw.getArray());const Ti=j._layoutChannelNo,zt=j.getClippingManager().getChannelFlagAsColor(Ti);this.gl.uniform4f(je.uniformChannelFlagLocation,zt.R,zt.G,zt.B,zt.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(je.samplerTexture0Location,0),this.gl.uniformMatrix4fv(je.uniformMatrixLocation,!1,N.getArray()),this.gl.uniform4f(je.uniformBaseColorLocation,D.R,D.G,D.B,D.A)}b.index==null&&(b.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,b.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,y,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(J,Q,re,$)}releaseShaderProgram(){for(let i=0;i<this._shaderSets.length;i++)this.gl.deleteProgram(this._shaderSets[i].shaderProgram),this._shaderSets[i].shaderProgram=0;this._shaderSets=[]}generateShaders(){for(let i=0;i<Gn;i++)this._shaderSets.push({});this._shaderSets[0].shaderProgram=this.loadShaderProgram(zn,Xn),this._shaderSets[1].shaderProgram=this.loadShaderProgram(Wn,Hn),this._shaderSets[2].shaderProgram=this.loadShaderProgram(is,Yn),this._shaderSets[3].shaderProgram=this.loadShaderProgram(is,Zn),this._shaderSets[4].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[5].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[6].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[7].shaderProgram=this._shaderSets[1].shaderProgram,this._shaderSets[8].shaderProgram=this._shaderSets[2].shaderProgram,this._shaderSets[9].shaderProgram=this._shaderSets[3].shaderProgram,this._shaderSets[0].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_position"),this._shaderSets[0].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[0].shaderProgram,"a_texCoord"),this._shaderSets[0].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"s_texture0"),this._shaderSets[0].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_clipMatrix"),this._shaderSets[0].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_channelFlag"),this._shaderSets[0].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[0].shaderProgram,"u_baseColor"),this._shaderSets[1].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_position"),this._shaderSets[1].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[1].shaderProgram,"a_texCoord"),this._shaderSets[1].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"s_texture0"),this._shaderSets[1].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_matrix"),this._shaderSets[1].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[1].shaderProgram,"u_baseColor"),this._shaderSets[2].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_position"),this._shaderSets[2].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[2].shaderProgram,"a_texCoord"),this._shaderSets[2].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture0"),this._shaderSets[2].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"s_texture1"),this._shaderSets[2].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_matrix"),this._shaderSets[2].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_clipMatrix"),this._shaderSets[2].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_channelFlag"),this._shaderSets[2].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[2].shaderProgram,"u_baseColor"),this._shaderSets[3].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_position"),this._shaderSets[3].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[3].shaderProgram,"a_texCoord"),this._shaderSets[3].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture0"),this._shaderSets[3].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"s_texture1"),this._shaderSets[3].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_matrix"),this._shaderSets[3].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_clipMatrix"),this._shaderSets[3].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_channelFlag"),this._shaderSets[3].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[3].shaderProgram,"u_baseColor"),this._shaderSets[4].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_position"),this._shaderSets[4].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[4].shaderProgram,"a_texCoord"),this._shaderSets[4].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"s_texture0"),this._shaderSets[4].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_matrix"),this._shaderSets[4].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[4].shaderProgram,"u_baseColor"),this._shaderSets[5].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_position"),this._shaderSets[5].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[5].shaderProgram,"a_texCoord"),this._shaderSets[5].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture0"),this._shaderSets[5].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"s_texture1"),this._shaderSets[5].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_matrix"),this._shaderSets[5].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_clipMatrix"),this._shaderSets[5].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_channelFlag"),this._shaderSets[5].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[5].shaderProgram,"u_baseColor"),this._shaderSets[6].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_position"),this._shaderSets[6].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[6].shaderProgram,"a_texCoord"),this._shaderSets[6].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture0"),this._shaderSets[6].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"s_texture1"),this._shaderSets[6].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_matrix"),this._shaderSets[6].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_clipMatrix"),this._shaderSets[6].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_channelFlag"),this._shaderSets[6].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[6].shaderProgram,"u_baseColor"),this._shaderSets[7].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_position"),this._shaderSets[7].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[7].shaderProgram,"a_texCoord"),this._shaderSets[7].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"s_texture0"),this._shaderSets[7].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_matrix"),this._shaderSets[7].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[7].shaderProgram,"u_baseColor"),this._shaderSets[8].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_position"),this._shaderSets[8].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[8].shaderProgram,"a_texCoord"),this._shaderSets[8].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture0"),this._shaderSets[8].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"s_texture1"),this._shaderSets[8].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_matrix"),this._shaderSets[8].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_clipMatrix"),this._shaderSets[8].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_channelFlag"),this._shaderSets[8].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[8].shaderProgram,"u_baseColor"),this._shaderSets[9].attributePositionLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_position"),this._shaderSets[9].attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets[9].shaderProgram,"a_texCoord"),this._shaderSets[9].samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture0"),this._shaderSets[9].samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"s_texture1"),this._shaderSets[9].uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_matrix"),this._shaderSets[9].uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_clipMatrix"),this._shaderSets[9].uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_channelFlag"),this._shaderSets[9].uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets[9].shaderProgram,"u_baseColor")}loadShaderProgram(i,s){let o=this.gl.createProgram(),p=this.compileShaderSource(this.gl.VERTEX_SHADER,i);if(!p)return ui("Vertex shader compile error!"),0;let y=this.compileShaderSource(this.gl.FRAGMENT_SHADER,s);return y?(this.gl.attachShader(o,p),this.gl.attachShader(o,y),this.gl.linkProgram(o),this.gl.getProgramParameter(o,this.gl.LINK_STATUS)?(this.gl.deleteShader(p),this.gl.deleteShader(y),o):(ui("Failed to link program: {0}",o),this.gl.deleteShader(p),this.gl.deleteShader(y),o&&this.gl.deleteProgram(o),0)):(ui("Vertex shader compile error!"),0)}compileShaderSource(i,s){const o=s,p=this.gl.createShader(i);if(this.gl.shaderSource(p,o),this.gl.compileShader(p),!p){const C=this.gl.getShaderInfoLog(p);ui("Shader compile log: {0} ",C)}return this.gl.getShaderParameter(p,this.gl.COMPILE_STATUS)?p:(this.gl.deleteShader(p),null)}setGl(i){this.gl=i}}var fi;(function(l){l[l.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",l[l.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",l[l.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",l[l.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",l[l.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",l[l.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",l[l.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",l[l.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",l[l.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",l[l.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted"})(fi||(fi={}));const zn="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Xn="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",Wn="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",is="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Hn="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;void main(){   gl_FragColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;}",Yn="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;void main(){   vec4 col_formask = texture2D(s_texture0 , v_texCoord) * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",Zn="precision mediump float;varying vec2 v_texCoord;varying vec4 v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4 u_channelFlag;uniform vec4 u_baseColor;void main(){vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;col_formask = col_formask * (1.0 - maskVal);gl_FragColor = col_formask;}";class rs extends Ar{initialize(i){i.isUsingMasking()&&(this._clippingManager=new Ir,this._clippingManager.initialize(i,i.getDrawableCount(),i.getDrawableMasks(),i.getDrawableMaskCounts()));for(let s=i.getDrawableCount()-1;s>=0;s--)this._sortedDrawableIndexList[s]=0;super.initialize(i)}bindTexture(i,s){this._textures[i]=s}getBindedTextures(){return this._textures}setClippingMaskBufferSize(i){this._clippingManager.release(),this._clippingManager=new Ir,this._clippingManager.setClippingMaskBufferSize(i),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts())}getClippingMaskBufferSize(){return this._clippingManager.getClippingMaskBufferSize()}constructor(){super();this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._clippingManager=new Ir,this.firstDraw=!0,this._textures={},this._sortedDrawableIndexList=[],this._bufferData={vertex:null,uv:null,index:null}}release(){var s,o,p;const i=this;this._clippingManager.release(),i._clippingManager=void 0,(s=this.gl)==null||s.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,(o=this.gl)==null||o.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,(p=this.gl)==null||p.deleteBuffer(this._bufferData.index),this._bufferData.index=null,i._bufferData=void 0,i._textures=void 0}doDrawModel(){this.preDraw(),this._clippingManager!=null&&this._clippingManager.setupClippingContext(this.getModel(),this);const i=this.getModel().getDrawableCount(),s=this.getModel().getDrawableRenderOrders();for(let o=0;o<i;++o){const p=s[o];this._sortedDrawableIndexList[p]=o}for(let o=0;o<i;++o){const p=this._sortedDrawableIndexList[o];!this.getModel().getDrawableDynamicFlagIsVisible(p)||(this.setClippingContextBufferForDraw(this._clippingManager!=null?this._clippingManager.getClippingContextListForDraw()[p]:null),this.setIsCulling(this.getModel().getDrawableCulling(p)),this.drawMesh(this.getModel().getDrawableTextureIndices(p),this.getModel().getDrawableVertexIndexCount(p),this.getModel().getDrawableVertexCount(p),this.getModel().getDrawableVertexIndices(p),this.getModel().getDrawableVertices(p),this.getModel().getDrawableVertexUvs(p),this.getModel().getDrawableOpacity(p),this.getModel().getDrawableBlendMode(p),this.getModel().getDrawableInvertedMaskBit(p)))}}drawMesh(i,s,o,p,y,C,b,R,k){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const D=this.getModelColor();this.getClippingContextBufferForMask()==null&&(D.A*=b,this.isPremultipliedAlpha()&&(D.R*=D.A,D.G*=D.A,D.B*=D.A));let m=null;this._textures[i]!=null&&(m=this._textures[i]),di.getInstance().setupShaderProgram(this,m,o,y,p,C,this._bufferData,b,R,D,this.isPremultipliedAlpha(),this.getMvpMatrix(),k),this.gl.drawElements(this.gl.TRIANGLES,s,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}static doStaticRelease(){di.deleteInstance()}setRenderState(i,s){Sr=i,bi=s}preDraw(){this.firstDraw&&(this.firstDraw=!1,this._anisortopy=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}setClippingContextBufferForMask(i){this._clippingContextBufferForMask=i}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(i){this._clippingContextBufferForDraw=i}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(i){this.gl=i,this._clippingManager.setGL(i),di.getInstance().setGl(i)}}Ar.staticRelease=()=>{rs.doStaticRelease()};const ss=new xt;class Jn extends hn{constructor(i,s,o){super();this.lipSync=!0,this.breath=xr.create(),this.renderer=new rs,this.idParamAngleX=Fn,this.idParamAngleY=Ln,this.idParamAngleZ=Rn,this.idParamEyeBallX=Bn,this.idParamEyeBallY=On,this.idParamBodyAngleX=Vn,this.idParamBreath=Un,this.pixelsPerUnit=1,this.centeringTransform=new Et.Matrix,this.coreModel=i,this.settings=s,this.motionManager=new En(s,o),this.init()}init(){var i;super.init(),((i=this.settings.getEyeBlinkParameters())==null?void 0:i.length)>0&&(this.eyeBlink=ts.create(this.settings)),this.breath.setParameters([new ki(this.idParamAngleX,0,15,6.5345,.5),new ki(this.idParamAngleY,0,8,3.5345,.5),new ki(this.idParamAngleZ,0,10,5.5345,.5),new ki(this.idParamBodyAngleX,0,4,15.5345,.5),new ki(this.idParamBreath,0,.5,3.2345,.5)]),this.renderer.initialize(this.coreModel),this.renderer.setIsPremultipliedAlpha(!0)}getSize(){return[this.coreModel.getModel().canvasinfo.CanvasWidth,this.coreModel.getModel().canvasinfo.CanvasHeight]}getLayout(){return Js(k0({},this.settings.layout),(i,s)=>s.charAt(0).toLowerCase()+s.slice(1))}setupLayout(){super.setupLayout(),this.pixelsPerUnit=this.coreModel.getModel().canvasinfo.PixelsPerUnit,this.centeringTransform.scale(this.pixelsPerUnit,this.pixelsPerUnit).translate(this.originalWidth/2,this.originalHeight/2)}updateWebGLContext(i,s){this.renderer.firstDraw=!0,this.renderer._bufferData={vertex:null,uv:null,index:null},this.renderer.startUp(i),this.renderer._clippingManager._currentFrameNo=s,this.renderer._clippingManager._maskTexture=void 0,di.getInstance()._shaderSets=[]}bindTexture(i,s){this.renderer.bindTexture(i,s)}getHitAreaDefs(){var i,s;return(s=(i=this.settings.hitAreas)==null?void 0:i.map(o=>({id:o.Id,name:o.Name,index:this.coreModel.getDrawableIndex(o.Id)})))!=null?s:[]}getDrawableIDs(){return this.coreModel.getDrawableIds()}getDrawableIndex(i){return this.coreModel.getDrawableIndex(i)}getDrawableVertices(i){if(typeof i=="string"&&(i=this.coreModel.getDrawableIndex(i),i===-1))throw new TypeError("Unable to find drawable ID: "+i);const s=this.coreModel.getDrawableVertices(i).slice();for(let o=0;o<s.length;o+=2)s[o]=s[o]*this.pixelsPerUnit+this.originalWidth/2,s[o+1]=-s[o+1]*this.pixelsPerUnit+this.originalHeight/2;return s}updateTransform(i){this.centeringTransform.copy(this.drawingMatrix).prepend(this.localTransform).prepend(i)}update(i,s){var y,C,b;super.update(i,s),i/=1e3,s/=1e3;const o=this.coreModel;this.emit("beforeMotionUpdate");const p=this.motionManager.update(this.coreModel,s);this.emit("afterMotionUpdate"),o.saveParameters(),p||(y=this.eyeBlink)==null||y.updateParameters(o,i),this.updateFocus(),this.updateNaturalMovements(i*1e3,s*1e3),(C=this.physics)==null||C.evaluate(o,i),(b=this.pose)==null||b.updateParameters(o,i),this.emit("beforeModelUpdate"),o.update(),o.loadParameters()}updateFocus(){this.coreModel.addParameterValueById(this.idParamEyeBallX,this.focusController.x),this.coreModel.addParameterValueById(this.idParamEyeBallY,this.focusController.y),this.coreModel.addParameterValueById(this.idParamAngleX,this.focusController.x*30),this.coreModel.addParameterValueById(this.idParamAngleY,this.focusController.y*30),this.coreModel.addParameterValueById(this.idParamAngleZ,this.focusController.x*this.focusController.y*-30),this.coreModel.addParameterValueById(this.idParamBodyAngleX,this.focusController.x*10)}updateNaturalMovements(i,s){var o;(o=this.breath)==null||o.updateParameters(this.coreModel,i/1e3)}draw(i){const s=this.drawingMatrix,o=ss.getArray();o[0]=s.a,o[1]=s.b,o[4]=-s.c,o[5]=-s.d,o[12]=s.tx,o[13]=s.ty,this.renderer.setMvpMatrix(ss),this.renderer.setRenderState(i.getParameter(i.FRAMEBUFFER_BINDING),this.viewport),this.renderer.drawModel()}destroy(){super.destroy(),this.renderer.release(),this.coreModel.release(),this.renderer=void 0,this.coreModel=void 0}}let Di,ns=20;function qn(){return Si.isStarted()?Promise.resolve():(Di=Di!=null?Di:new Promise((l,i)=>{function s(){try{$n(),l()}catch(o){if(ns--,ns<0){const p=new Error("Failed to start up Cubism 4 framework.");p.cause=o,i(p);return}Ne.log("Cubism4","Startup failed, retrying 10ms later..."),setTimeout(s,10)}}s()}),Di)}function $n(l){l=Object.assign({logFunction:console.log,loggingLevel:Vt.LogLevel_Verbose},l),Si.startUp(l),Si.initialize()}const Kn=.001,as=.5;class kr{static create(i){const s=new kr;typeof i.FadeInTime=="number"&&(s._fadeTimeSeconds=i.FadeInTime,s._fadeTimeSeconds<=0&&(s._fadeTimeSeconds=as));const o=i.Groups,p=o.length;for(let y=0;y<p;++y){const C=o[y],b=C.length;let R=0;for(let k=0;k<b;++k){const D=C[k],m=new $i;m.partId=D.Id;const N=D.Link;if(N){const q=N.length;for(let J=0;J<q;++J){const Q=new $i;Q.partId=N[J],m.link.push(Q)}}s._partGroups.push(m),++R}s._partGroupCounts.push(R)}return s}updateParameters(i,s){i!=this._lastModel&&this.reset(i),this._lastModel=i,s<0&&(s=0);let o=0;for(let p=0;p<this._partGroupCounts.length;p++){const y=this._partGroupCounts[p];this.doFade(i,s,o,y),o+=y}this.copyPartOpacities(i)}reset(i){let s=0;for(let o=0;o<this._partGroupCounts.length;++o){const p=this._partGroupCounts[o];for(let y=s;y<s+p;++y){this._partGroups[y].initialize(i);const C=this._partGroups[y].partIndex,b=this._partGroups[y].parameterIndex;if(!(C<0)){i.setPartOpacityByIndex(C,y==s?1:0),i.setParameterValueByIndex(b,y==s?1:0);for(let R=0;R<this._partGroups[y].link.length;++R)this._partGroups[y].link[R].initialize(i)}}s+=p}}copyPartOpacities(i){for(let s=0;s<this._partGroups.length;++s){const o=this._partGroups[s];if(o.link.length==0)continue;const p=this._partGroups[s].partIndex,y=i.getPartOpacityByIndex(p);for(let C=0;C<o.link.length;++C){const R=o.link[C].partIndex;R<0||i.setPartOpacityByIndex(R,y)}}}doFade(i,s,o,p){let y=-1,C=1;const b=.5,R=.15;for(let k=o;k<o+p;++k){const D=this._partGroups[k].partIndex,m=this._partGroups[k].parameterIndex;if(i.getParameterValueByIndex(m)>Kn){if(y>=0)break;y=k,C=i.getPartOpacityByIndex(D),C+=s/this._fadeTimeSeconds,C>1&&(C=1)}}y<0&&(y=0,C=1);for(let k=o;k<o+p;++k){const D=this._partGroups[k].partIndex;if(y==k)i.setPartOpacityByIndex(D,C);else{let m=i.getPartOpacityByIndex(D),N;C<b?N=C*(b-1)/b+1:N=(1-C)*b/(1-b),(1-N)*(1-C)>R&&(N=1-R/(1-C)),m>N&&(m=N),i.setPartOpacityByIndex(D,m)}}}constructor(){this._fadeTimeSeconds=as,this._lastModel=void 0,this._partGroups=[],this._partGroupCounts=[]}}class $i{constructor(i){this.parameterIndex=0,this.partIndex=0,this.partId="",this.link=[],i!=null&&this.assignment(i)}assignment(i){return this.partId=i.partId,this.link=i.link.map(s=>s.clone()),this}initialize(i){this.parameterIndex=i.getParameterIndex(this.partId),this.partIndex=i.getPartIndex(this.partId),i.setParameterValueByIndex(this.parameterIndex,1)}clone(){const i=new $i;return i.partId=this.partId,i.parameterIndex=this.parameterIndex,i.partIndex=this.partIndex,i.link=this.link.map(s=>s.clone()),i}}class Qn{update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getCanvasWidth(){return this._model==null?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return this._model==null?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const i=this._model.parameters.count,s=this._savedParameters.length;for(let o=0;o<i;++o)o<s?this._savedParameters[o]=this._parameterValues[o]:this._savedParameters.push(this._parameterValues[o])}getModel(){return this._model}getPartIndex(i){let s;const o=this._model.parts.count;for(s=0;s<o;++s)if(i==this._partIds[s])return s;return i in this._notExistPartId?this._notExistPartId[i]:(s=o+this._notExistPartId.length,this._notExistPartId[i]=s,this._notExistPartOpacities[s]=0,s)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(i,s){if(i in this._notExistPartOpacities){this._notExistPartOpacities[i]=s;return}Yi(0<=i&&i<this.getPartCount()),this._partOpacities[i]=s}setPartOpacityById(i,s){const o=this.getPartIndex(i);o<0||this.setPartOpacityByIndex(o,s)}getPartOpacityByIndex(i){return i in this._notExistPartOpacities?this._notExistPartOpacities[i]:(Yi(0<=i&&i<this.getPartCount()),this._partOpacities[i])}getPartOpacityById(i){const s=this.getPartIndex(i);return s<0?0:this.getPartOpacityByIndex(s)}getParameterIndex(i){let s;const o=this._model.parameters.count;for(s=0;s<o;++s)if(i==this._parameterIds[s])return s;return i in this._notExistParameterId?this._notExistParameterId[i]:(s=this._model.parameters.count+Object.keys(this._notExistParameterId).length,this._notExistParameterId[i]=s,this._notExistParameterValues[s]=0,s)}getParameterCount(){return this._model.parameters.count}getParameterMaximumValue(i){return this._model.parameters.maximumValues[i]}getParameterMinimumValue(i){return this._model.parameters.minimumValues[i]}getParameterDefaultValue(i){return this._model.parameters.defaultValues[i]}getParameterValueByIndex(i){return i in this._notExistParameterValues?this._notExistParameterValues[i]:(Yi(0<=i&&i<this.getParameterCount()),this._parameterValues[i])}getParameterValueById(i){const s=this.getParameterIndex(i);return this.getParameterValueByIndex(s)}setParameterValueByIndex(i,s,o=1){if(i in this._notExistParameterValues){this._notExistParameterValues[i]=o==1?s:this._notExistParameterValues[i]*(1-o)+s*o;return}Yi(0<=i&&i<this.getParameterCount()),this._model.parameters.maximumValues[i]<s&&(s=this._model.parameters.maximumValues[i]),this._model.parameters.minimumValues[i]>s&&(s=this._model.parameters.minimumValues[i]),this._parameterValues[i]=o==1?s:this._parameterValues[i]=this._parameterValues[i]*(1-o)+s*o}setParameterValueById(i,s,o=1){const p=this.getParameterIndex(i);this.setParameterValueByIndex(p,s,o)}addParameterValueByIndex(i,s,o=1){this.setParameterValueByIndex(i,this.getParameterValueByIndex(i)+s*o)}addParameterValueById(i,s,o=1){const p=this.getParameterIndex(i);this.addParameterValueByIndex(p,s,o)}multiplyParameterValueById(i,s,o=1){const p=this.getParameterIndex(i);this.multiplyParameterValueByIndex(p,s,o)}multiplyParameterValueByIndex(i,s,o=1){this.setParameterValueByIndex(i,this.getParameterValueByIndex(i)*(1+(s-1)*o))}getDrawableIds(){return this._drawableIds.slice()}getDrawableIndex(i){const s=this._model.drawables.count;for(let o=0;o<s;++o)if(this._drawableIds[o]==i)return o;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(i){return this._model.drawables.ids[i]}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(i){return this._model.drawables.textureIndices[i]}getDrawableDynamicFlagVertexPositionsDidChange(i){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(s[i])}getDrawableVertexIndexCount(i){return this._model.drawables.indexCounts[i]}getDrawableVertexCount(i){return this._model.drawables.vertexCounts[i]}getDrawableVertices(i){return this.getDrawableVertexPositions(i)}getDrawableVertexIndices(i){return this._model.drawables.indices[i]}getDrawableVertexPositions(i){return this._model.drawables.vertexPositions[i]}getDrawableVertexUvs(i){return this._model.drawables.vertexUvs[i]}getDrawableOpacity(i){return this._model.drawables.opacities[i]}getDrawableCulling(i){const s=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(s[i])}getDrawableBlendMode(i){const s=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(s[i])?Ft.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(s[i])?Ft.CubismBlendMode_Multiplicative:Ft.CubismBlendMode_Normal}getDrawableInvertedMaskBit(i){const s=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(s[i])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let i=0;i<this._model.drawables.count;++i)if(!(this._model.drawables.maskCounts[i]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(i){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(s[i])}getDrawableDynamicFlagVisibilityDidChange(i){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(s[i])}getDrawableDynamicFlagOpacityDidChange(i){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(s[i])}getDrawableDynamicFlagRenderOrderDidChange(i){const s=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(s[i])}loadParameters(){let i=this._model.parameters.count;const s=this._savedParameters.length;i>s&&(i=s);for(let o=0;o<i;++o)this._parameterValues[o]=this._savedParameters[o]}initialize(){this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const i=this._model.parameters.ids,s=this._model.parameters.count;for(let o=0;o<s;++o)this._parameterIds.push(i[o])}{const i=this._model.parts.ids,s=this._model.parts.count;for(let o=0;o<s;++o)this._partIds.push(i[o])}{const i=this._model.drawables.ids,s=this._model.drawables.count;for(let o=0;o<s;++o)this._drawableIds.push(i[o])}}constructor(i){this._model=i,this._savedParameters=[],this._parameterIds=[],this._drawableIds=[],this._partIds=[],this._notExistPartId={},this._notExistParameterId={},this._notExistParameterValues={},this._notExistPartOpacities={},this.initialize()}release(){this._model.release(),this._model=void 0}}class br{static create(i){const s=Live2DCubismCore.Moc.fromArrayBuffer(i);if(s)return new br(s);throw new Error("Unknown error")}createModel(){let i;const s=Live2DCubismCore.Model.fromMoc(this._moc);if(s)return i=new Qn(s),++this._modelCount,i;throw new Error("Unknown error")}deleteModel(i){i!=null&&--this._modelCount}constructor(i){this._moc=i,this._modelCount=0}release(){this._moc._release(),this._moc=void 0}}var Ki;(function(l){l[l.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter"})(Ki||(Ki={}));var jt;(function(l){l[l.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",l[l.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",l[l.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle"})(jt||(jt={}));class ea{constructor(){this.initialPosition=new Ae(0,0),this.position=new Ae(0,0),this.lastPosition=new Ae(0,0),this.lastGravity=new Ae(0,0),this.force=new Ae(0,0),this.velocity=new Ae(0,0)}}class ta{constructor(){this.normalizationPosition={},this.normalizationAngle={}}}class ia{constructor(){this.source={}}}class ra{constructor(){this.destination={},this.translationScale=new Ae(0,0)}}class sa{constructor(){this.settings=[],this.inputs=[],this.outputs=[],this.particles=[],this.gravity=new Ae(0,0),this.wind=new Ae(0,0)}}class na{constructor(i){this._json=i}release(){this._json=void 0}getGravity(){const i=new Ae(0,0);return i.x=this._json.Meta.EffectiveForces.Gravity.X,i.y=this._json.Meta.EffectiveForces.Gravity.Y,i}getWind(){const i=new Ae(0,0);return i.x=this._json.Meta.EffectiveForces.Wind.X,i.y=this._json.Meta.EffectiveForces.Wind.Y,i}getSubRigCount(){return this._json.Meta.PhysicsSettingCount}getTotalInputCount(){return this._json.Meta.TotalInputCount}getTotalOutputCount(){return this._json.Meta.TotalOutputCount}getVertexCount(){return this._json.Meta.VertexCount}getNormalizationPositionMinimumValue(i){return this._json.PhysicsSettings[i].Normalization.Position.Minimum}getNormalizationPositionMaximumValue(i){return this._json.PhysicsSettings[i].Normalization.Position.Maximum}getNormalizationPositionDefaultValue(i){return this._json.PhysicsSettings[i].Normalization.Position.Default}getNormalizationAngleMinimumValue(i){return this._json.PhysicsSettings[i].Normalization.Angle.Minimum}getNormalizationAngleMaximumValue(i){return this._json.PhysicsSettings[i].Normalization.Angle.Maximum}getNormalizationAngleDefaultValue(i){return this._json.PhysicsSettings[i].Normalization.Angle.Default}getInputCount(i){return this._json.PhysicsSettings[i].Input.length}getInputWeight(i,s){return this._json.PhysicsSettings[i].Input[s].Weight}getInputReflect(i,s){return this._json.PhysicsSettings[i].Input[s].Reflect}getInputType(i,s){return this._json.PhysicsSettings[i].Input[s].Type}getInputSourceId(i,s){return this._json.PhysicsSettings[i].Input[s].Source.Id}getOutputCount(i){return this._json.PhysicsSettings[i].Output.length}getOutputVertexIndex(i,s){return this._json.PhysicsSettings[i].Output[s].VertexIndex}getOutputAngleScale(i,s){return this._json.PhysicsSettings[i].Output[s].Scale}getOutputWeight(i,s){return this._json.PhysicsSettings[i].Output[s].Weight}getOutputDestinationId(i,s){return this._json.PhysicsSettings[i].Output[s].Destination.Id}getOutputType(i,s){return this._json.PhysicsSettings[i].Output[s].Type}getOutputReflect(i,s){return this._json.PhysicsSettings[i].Output[s].Reflect}getParticleCount(i){return this._json.PhysicsSettings[i].Vertices.length}getParticleMobility(i,s){return this._json.PhysicsSettings[i].Vertices[s].Mobility}getParticleDelay(i,s){return this._json.PhysicsSettings[i].Vertices[s].Delay}getParticleAcceleration(i,s){return this._json.PhysicsSettings[i].Vertices[s].Acceleration}getParticleRadius(i,s){return this._json.PhysicsSettings[i].Vertices[s].Radius}getParticlePosition(i,s){const o=new Ae(0,0);return o.x=this._json.PhysicsSettings[i].Vertices[s].Position.X,o.y=this._json.PhysicsSettings[i].Vertices[s].Position.Y,o}}const os="X",ls="Y",us="Angle",aa=5,hs=100,oa=.001;class Dr{static create(i){const s=new Dr;return s.parse(i),s._physicsRig.gravity.y=0,s}evaluate(i,s){let o,p,y,C;const b=new Ae;let R,k,D,m,N,q,J,Q;N=i.getModel().parameters.values,q=i.getModel().parameters.maximumValues,J=i.getModel().parameters.minimumValues,Q=i.getModel().parameters.defaultValues;for(let re=0;re<this._physicsRig.subRigCount;++re){o={angle:0},b.x=0,b.y=0,R=this._physicsRig.settings[re],k=this._physicsRig.inputs.slice(R.baseInputIndex),D=this._physicsRig.outputs.slice(R.baseOutputIndex),m=this._physicsRig.particles.slice(R.baseParticleIndex);for(let $=0;$<R.inputCount;++$)p=k[$].weight/hs,k[$].sourceParameterIndex==-1&&(k[$].sourceParameterIndex=i.getParameterIndex(k[$].source.id)),k[$].getNormalizedParameterValue(b,o,N[k[$].sourceParameterIndex],J[k[$].sourceParameterIndex],q[k[$].sourceParameterIndex],Q[k[$].sourceParameterIndex],R.normalizationPosition,R.normalizationAngle,k[$].reflect,p);y=$e.degreesToRadian(-o.angle),b.x=b.x*$e.cos(y)-b.y*$e.sin(y),b.y=b.x*$e.sin(y)+b.y*$e.cos(y),va(m,R.particleCount,b,o.angle,this._options.wind,oa*R.normalizationPosition.maximum,s,aa);for(let $=0;$<R.outputCount;++$){const de=D[$].vertexIndex;if(de<1||de>=R.particleCount)break;D[$].destinationParameterIndex==-1&&(D[$].destinationParameterIndex=i.getParameterIndex(D[$].destination.id));const j=new Ae;j.x=m[de].position.x-m[de-1].position.x,j.y=m[de].position.y-m[de-1].position.y,C=D[$].getValue(j,m,de,D[$].reflect,this._options.gravity);const be=D[$].destinationParameterIndex,it=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(N.subarray(be))):N.slice(be);wa(it,J[be],q[be],C,D[$]);for(let je=be,dt=0;je<N.length;je++,dt++)N[je]=it[dt]}}}setOptions(i){this._options=i}getOption(){return this._options}constructor(){this._options=new la,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0}release(){this._physicsRig=void 0}parse(i){this._physicsRig=new sa;let s=new na(i);this._physicsRig.gravity=s.getGravity(),this._physicsRig.wind=s.getWind(),this._physicsRig.subRigCount=s.getSubRigCount();let o=0,p=0,y=0;for(let C=0;C<this._physicsRig.subRigCount;++C){const b=new ta;b.normalizationPosition.minimum=s.getNormalizationPositionMinimumValue(C),b.normalizationPosition.maximum=s.getNormalizationPositionMaximumValue(C),b.normalizationPosition.defalut=s.getNormalizationPositionDefaultValue(C),b.normalizationAngle.minimum=s.getNormalizationAngleMinimumValue(C),b.normalizationAngle.maximum=s.getNormalizationAngleMaximumValue(C),b.normalizationAngle.defalut=s.getNormalizationAngleDefaultValue(C),b.inputCount=s.getInputCount(C),b.baseInputIndex=o,o+=b.inputCount;for(let R=0;R<b.inputCount;++R){const k=new ia;switch(k.sourceParameterIndex=-1,k.weight=s.getInputWeight(C,R),k.reflect=s.getInputReflect(C,R),s.getInputType(C,R)){case os:k.type=jt.CubismPhysicsSource_X,k.getNormalizedParameterValue=ua;break;case ls:k.type=jt.CubismPhysicsSource_Y,k.getNormalizedParameterValue=ha;break;case us:k.type=jt.CubismPhysicsSource_Angle,k.getNormalizedParameterValue=ca;break}k.source.targetType=Ki.CubismPhysicsTargetType_Parameter,k.source.id=s.getInputSourceId(C,R),this._physicsRig.inputs.push(k)}b.outputCount=s.getOutputCount(C),b.baseOutputIndex=p,p+=b.outputCount;for(let R=0;R<b.outputCount;++R){const k=new ra;switch(k.destinationParameterIndex=-1,k.vertexIndex=s.getOutputVertexIndex(C,R),k.angleScale=s.getOutputAngleScale(C,R),k.weight=s.getOutputWeight(C,R),k.destination.targetType=Ki.CubismPhysicsTargetType_Parameter,k.destination.id=s.getOutputDestinationId(C,R),s.getOutputType(C,R)){case os:k.type=jt.CubismPhysicsSource_X,k.getValue=da,k.getScale=_a;break;case ls:k.type=jt.CubismPhysicsSource_Y,k.getValue=fa,k.getScale=Aa;break;case us:k.type=jt.CubismPhysicsSource_Angle,k.getValue=ma,k.getScale=ya;break}k.reflect=s.getOutputReflect(C,R),this._physicsRig.outputs.push(k)}b.particleCount=s.getParticleCount(C),b.baseParticleIndex=y,y+=b.particleCount;for(let R=0;R<b.particleCount;++R){const k=new ea;k.mobility=s.getParticleMobility(C,R),k.delay=s.getParticleDelay(C,R),k.acceleration=s.getParticleAcceleration(C,R),k.radius=s.getParticleRadius(C,R),k.position=s.getParticlePosition(C,R),this._physicsRig.particles.push(k)}this._physicsRig.settings.push(b)}this.initialize(),s.release()}initialize(){let i,s,o;for(let p=0;p<this._physicsRig.subRigCount;++p){s=this._physicsRig.settings[p],i=this._physicsRig.particles.slice(s.baseParticleIndex),i[0].initialPosition=new Ae(0,0),i[0].lastPosition=new Ae(i[0].initialPosition.x,i[0].initialPosition.y),i[0].lastGravity=new Ae(0,-1),i[0].lastGravity.y*=-1,i[0].velocity=new Ae(0,0),i[0].force=new Ae(0,0);for(let y=1;y<s.particleCount;++y)o=new Ae(0,0),o.y=i[y].radius,i[y].initialPosition=new Ae(i[y-1].initialPosition.x+o.x,i[y-1].initialPosition.y+o.y),i[y].position=new Ae(i[y].initialPosition.x,i[y].initialPosition.y),i[y].lastPosition=new Ae(i[y].initialPosition.x,i[y].initialPosition.y),i[y].lastGravity=new Ae(0,-1),i[y].lastGravity.y*=-1,i[y].velocity=new Ae(0,0),i[y].force=new Ae(0,0)}}}class la{constructor(){this.gravity=new Ae(0,0),this.wind=new Ae(0,0)}}function ua(l,i,s,o,p,y,C,b,R,k){l.x+=Tr(s,o,p,y,C.minimum,C.maximum,C.defalut,R)*k}function ha(l,i,s,o,p,y,C,b,R,k){l.y+=Tr(s,o,p,y,C.minimum,C.maximum,C.defalut,R)*k}function ca(l,i,s,o,p,y,C,b,R,k){i.angle+=Tr(s,o,p,y,b.minimum,b.maximum,b.defalut,R)*k}function da(l,i,s,o,p){let y=l.x;return o&&(y*=-1),y}function fa(l,i,s,o,p){let y=l.y;return o&&(y*=-1),y}function ma(l,i,s,o,p){let y;return s>=2?p=i[s-1].position.substract(i[s-2].position):p=p.multiplyByScaler(-1),y=$e.directionToRadian(p,l),o&&(y*=-1),y}function ga(l,i){return Math.abs(Math.max(l,i)-Math.min(l,i))}function pa(l,i){return Math.min(l,i)+ga(l,i)/2}function _a(l,i){return l.x}function Aa(l,i){return l.y}function ya(l,i){return i}function va(l,i,s,o,p,y,C,b){let R,k,D,m,N=new Ae(0,0),q=new Ae(0,0),J=new Ae(0,0),Q=new Ae(0,0);l[0].position=new Ae(s.x,s.y),R=$e.degreesToRadian(o),m=$e.radianToDirection(R),m.normalize();for(let re=1;re<i;++re)l[re].force=m.multiplyByScaler(l[re].acceleration).add(p),l[re].lastPosition=new Ae(l[re].position.x,l[re].position.y),k=l[re].delay*C*30,N=l[re].position.substract(l[re-1].position),D=$e.directionToRadian(l[re].lastGravity,m)/b,N.x=$e.cos(D)*N.x-N.y*$e.sin(D),N.y=$e.sin(D)*N.x+N.y*$e.cos(D),l[re].position=l[re-1].position.add(N),q=l[re].velocity.multiplyByScaler(k),J=l[re].force.multiplyByScaler(k).multiplyByScaler(k),l[re].position=l[re].position.add(q).add(J),Q=l[re].position.substract(l[re-1].position),Q.normalize(),l[re].position=l[re-1].position.add(Q.multiplyByScaler(l[re].radius)),$e.abs(l[re].position.x)<y&&(l[re].position.x=0),k!=0&&(l[re].velocity=l[re].position.substract(l[re].lastPosition),l[re].velocity=l[re].velocity.divisionByScalar(k),l[re].velocity=l[re].velocity.multiplyByScaler(l[re].mobility)),l[re].force=new Ae(0,0),l[re].lastGravity=new Ae(m.x,m.y)}function wa(l,i,s,o,p){let y,C,b;y=p.getScale(p.translationScale,p.angleScale),C=o*y,C<i?(C<p.valueBelowMinimum&&(p.valueBelowMinimum=C),C=i):C>s&&(C>p.valueExceededMaximum&&(p.valueExceededMaximum=C),C=s),b=p.weight/hs,b>=1||(C=l[0]*(1-b)+C*b),l[0]=C}function Tr(l,i,s,o,p,y,C,b){let R=0;const k=$e.max(s,i);k<l&&(l=k);const D=$e.min(s,i);D>l&&(l=D);const m=$e.min(p,y),N=$e.max(p,y),q=C,J=pa(D,k),Q=l-J;switch(Math.sign(Q)){case 1:{const re=N-q,$=k-J;$!=0&&(R=Q*(re/$),R+=q);break}case-1:{const re=m-q,$=D-J;$!=0&&(R=Q*(re/$),R+=q);break}case 0:{R=q;break}}return b?R:R*-1}_t.cubism4=qi;Qe.registerRuntime({version:4,ready:qn,test(l){return l instanceof hi||hi.isValidJSON(l)},isValidMoc(l){if(l.byteLength<4)return!1;const i=new Int8Array(l,0,4);return String.fromCharCode(...i)==="MOC3"},createModelSettings(l){return new hi(l)},createCoreModel(l){const i=br.create(l);try{const s=i.createModel();return s.__moc=i,s}catch(s){try{i.release()}catch{}throw s}},createInternalModel(l,i,s){const o=new Jn(l,i,s),p=l;return p.__moc&&(o.__moc=p.__moc,delete p.__moc,o.once("destroy",xa)),o},createPhysics(l,i){return Dr.create(i)},createPose(l,i){return kr.create(i)}});function xa(){var l;(l=this.__moc)==null||l.release()}var Ma=Object.defineProperty,Ca=Object.getOwnPropertyDescriptor,Pa=(l,i,s,o)=>{for(var p=o>1?void 0:o?Ca(i,s):i,y=l.length-1,C;y>=0;y--)(C=l[y])&&(p=(o?C(i,s,p):C(p))||p);return o&&p&&Ma(i,s,p),p};console.log(Wi,123);fr.LIVE2D="LIVE2D";mr.registerInstance(fr.LIVE2D,async({data:l})=>await Wi.from(l.url));let Er=class extends $s{constructor(){super(...arguments);this.name="Live2D"}init(){this.renderSystem=this.game.getSystem(b0),this.renderSystem.rendererManager.register(this),Wi.registerTicker(this.game.ticker)}componentChanged(l){l.type===D0.ADD?this.add(l):l.type===D0.REMOVE?this.remove(l):this.change(l)}async add(l){const i=l.component,{instance:s}=await mr.getResource(i.resource);i.model=s,this.renderSystem.containerManager.getContainer(l.gameObject.id).addChildAt(s,0)}remove(l){const i=l.component,s=i.model;this.renderSystem.containerManager.getContainer(l.gameObject.id).removeChild(s),s.destroy({children:!0}),i.model=null}change(l){this.remove(l),this.add(l)}};Er=Pa([qs.componentObserver({Live2D:[]})],Er);mr.addResource([{name:"live2dName",type:fr.LIVE2D,src:{url:{type:"data",data:"https://cdn.jsdelivr.net/gh/Eikanya/Live2d-model/galgame%20live2d/Fox%20Hime%20Zero/mori_suit/mori_suit.model3.json"}}}]);const Sa=new Ks({systems:[new b0({canvas:document.querySelector("#canvas"),width:750,height:1e3}),new Er]}),cs=new Qs("aaa",{size:{width:0,height:0},position:{x:0,y:0},scale:{x:.3,y:.3}});cs.addComponent(new T0({resource:"live2dName"}));Sa.scene.addChild(cs)});export default Ia();
